(this["webpackJsonpexcel-parser"]=this["webpackJsonpexcel-parser"]||[]).push([[0],{106:function(e,t){},133:function(e,t,a){e.exports=a(151)},138:function(e,t,a){},149:function(e,t){},150:function(e,t){},151:function(e,t,a){"use strict";a.r(t);var n,o=a(0),r=a.n(o),i=a(17),l=a.n(i),c=(a(138),a(217)),s=a(218),u=a(186),d=a(110),h=Object(d.a)({palette:{primary:{main:"#45aaf2",dark:"#2d98da",contrastText:"white"},secondary:{main:"#fc5c65",dark:"#eb3b5a",contrastText:"white"},text:{primary:"#778ca3",secondary:"#B4BEC8"},background:{default:"#F5F7F9"}}}),f=a(9),m=a(8),g=a(12),p=a(15),b=a(11),v=a(14),E=function(){function e(t){Object(b.a)(this,e),this.hour=void 0,this.kwdelSet=void 0,this.hour=t,this.kwdelSet=[]}return Object(v.a)(e,[{key:"addKwdel",value:function(e,t,a){this.kwdelSet.push({fileName:a,kwdel:e,kwhdel:t})}},{key:"removeKwdel",value:function(e){this.kwdelSet=this.kwdelSet.filter((function(t){return t.fileName!==e}))}},{key:"getTotalKwhdel",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwhdel}}catch(n){a.e(n)}finally{a.f()}return t/this.kwdelSet.length}},{key:"getRawTotalKwhdel",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwhdel}}catch(n){a.e(n)}finally{a.f()}return t}},{key:"getTotalKwdel",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwdel}}catch(n){a.e(n)}finally{a.f()}return t/this.kwdelSet.length}},{key:"getRawTotal",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwdel}}catch(n){a.e(n)}finally{a.f()}return t}}]),e}(),O=function(){function e(t){Object(b.a)(this,e),this.date=void 0,this.hourlyLoadProfiles=void 0,this.max=void 0,this.sum=void 0,this.date=t,this.hourlyLoadProfiles=this.buildHourlyLoadProfiles(),this.max={kwdel:0,hour:0},this.sum={kwdel:0,kwhdel:0}}return Object(v.a)(e,[{key:"buildHourlyLoadProfiles",value:function(){return Object(p.a)(Array(24).keys()).map((function(e){return new E(e)}))}},{key:"addLoadProfileData",value:function(e){this.hourlyLoadProfiles[e.hour].addKwdel(e.kwdel,e.kwhdel,e.fileName)}},{key:"removeLoadProfileData",value:function(e){this.hourlyLoadProfiles.forEach((function(t){t.removeKwdel(e)}))}},{key:"genMaxAndSum",value:function(){var e,t=0,a=1,n=0,o=0,r=Object(f.a)(this.hourlyLoadProfiles);try{for(r.s();!(e=r.n()).done;){var i=e.value,l=i.getTotalKwdel();n+=l,o+=i.getRawTotalKwhdel(),l>t&&(a=i.hour,t=l)}}catch(c){r.e(c)}finally{r.f()}return this.max={kwdel:t,hour:a},this.sum={kwdel:n,kwhdel:o},{max:this.max,sum:this.sum}}}]),e}(),y=a(65),w=a.n(y);!function(e){e[e.JANUARY=0]="JANUARY",e[e.FEBRUARY=1]="FEBRUARY",e[e.MARCH=2]="MARCH",e[e.APRIL=3]="APRIL",e[e.MAY=4]="MAY",e[e.JUNE=5]="JUNE",e[e.JULY=6]="JULY",e[e.AUGUST=7]="AUGUST",e[e.SEPTEMBER=8]="SEPTEMBER",e[e.OCTOBER=9]="OCTOBER",e[e.NOVEMBER=10]="NOVEMBER",e[e.DECEMBER=11]="DECEMBER"}(n||(n={}));var P,S=n,x=function(){function e(t,a){Object(b.a)(this,e),this.month=void 0,this.year=void 0,this.startDate=void 0,this.enddDate=void 0,this.month=t,this.year=a,this.startDate=this.getStartDate(),this.enddDate=this.getEndDate()}return Object(v.a)(e,[{key:"getTotalDays",value:function(){return Math.round((this.enddDate.getTime()-this.startDate.getTime())/864e5)}},{key:"getStartDate",value:function(){var e=1===this.month?12:this.month-1,t=1===this.month?this.year-1:this.year;return w()("".concat(e,"/26/").concat(t),"MM/DD/YYYY").toDate()}},{key:"getEndDate",value:function(){return w()("".concat(this.month,"/25/").concat(this.year),"MM/DD/YYYY").toDate()}},{key:"equalsTo",value:function(e){return null!==this.month&&null!=e&&null!==e.month&&(this.month===e.month&&this.year===e.year)}},{key:"toString",value:function(){return"".concat(S[this.month-1]," ").concat(this.year)}}],[{key:"getBillingMonth",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e;return t>=26&&(0===n&&0===a&&26===t||0===(o=++o%12)&&(o=12)),o}}]),e}(),A=function e(t,a,n,o,r,i,l,c,s){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";if(Object(b.a)(this,e),this.kwdel=void 0,this.kwhdel=void 0,this.hour=void 0,this.day=void 0,this.month=void 0,this.year=void 0,this.minute=void 0,this.meteringPoint=void 0,this.row=void 0,this.billingPeriod=void 0,this.fileName=void 0,this.kwdel=t,this.kwhdel=a,this.day=n,this.hour=i,this.month=o,this.year=r,this.minute=l,this.meteringPoint=c,this.row=s,this.fileName=u,0===this.hour&&0===this.minute)if(this.hour=23,this.minute=59,this.day-1<=0){var d=new Date("".concat(this.year,"/").concat(this.month,"/").concat(this.day));d.setDate(d.getDate()-1),this.day=d.getDate(),this.month=d.getMonth()+1,this.year=d.getFullYear()}else this.day--;var h=x.getBillingMonth(this.month,this.day,this.hour,this.minute);this.billingPeriod=new x(h,this.year),0===this.minute&&(this.hour--,this.hour<0&&(this.hour=23))},C=function(){function e(t){Object(b.a)(this,e),this.meteringPoint=void 0,this.dailyLoadProfiles=void 0,this.max=void 0,this.sum=void 0,this.meteringPoint=t,this.dailyLoadProfiles=new Map,this.max={kwdel:0,hour:1,meteringPoint:"",date:new Date},this.sum={kwdel:0,kwhdel:0,meteringPoint:this.meteringPoint}}return Object(v.a)(e,[{key:"addLoadProfileData",value:function(e,t){var a;this.dailyLoadProfiles.has(t)||this.dailyLoadProfiles.set(t,new O(new Date(t))),null===(a=this.dailyLoadProfiles.get(t))||void 0===a||a.addLoadProfileData(e)}},{key:"removeLoadPRofileData",value:function(e){this.dailyLoadProfiles.forEach((function(t){t.removeLoadProfileData(e)}))}},{key:"getDailyLoadProfile",value:function(e){return this.dailyLoadProfiles.has(e)?this.dailyLoadProfiles.get(e):new O(new Date(e))}},{key:"genMaxAndSum",value:function(){var e,t=0,a=0,n=0,o=1,r=new Date,i=Object(f.a)(this.dailyLoadProfiles.values());try{for(i.s();!(e=i.n()).done;){var l=e.value,c=l.max,s=l.sum.kwdel,u=l.sum.kwhdel;console.log("Sum for day ".concat(l.date.toLocaleDateString()," is: ").concat(u)),a+=u,n+=s,c.kwdel>t&&(t=c.kwdel,o=c.hour,r=l.date)}}catch(d){i.e(d)}finally{i.f()}return console.log("Sum for ".concat(this.meteringPoint," is: ").concat(a)),this.max={kwdel:t,hour:o,date:r,meteringPoint:this.meteringPoint},this.sum={kwdel:n,kwhdel:a,meteringPoint:this.meteringPoint},{max:this.max,sum:this.sum}}}]),e}(),k=function e(){Object(b.a)(this,e),this.meteringPoint=void 0,this.kwdel=void 0,this.hour=void 0,this.date=void 0,this.meteringPoint="",this.kwdel=0,this.hour=0,this.date=new Date},M=function(){function e(t){Object(b.a)(this,e),this.loadProfiles=void 0,this.billingPeriod=void 0,this.dateStrings=void 0,this.coincidentPeak=void 0,this.nonCoincidentPeak=void 0,this.diversityFactor=void 0,this.loadProfilesMax=void 0,this.loadProfilesSum=void 0,this.totalLoadpRofile=void 0,this.chartData=void 0,this.billingPeriod=t,this.loadProfiles=new Map,this.dateStrings=new Set,this.totalLoadpRofile=new C("Total"),this.coincidentPeak=new k,this.nonCoincidentPeak=0,this.diversityFactor=0,this.loadProfilesMax=[],this.loadProfilesSum=[],this.chartData=new Map}return Object(v.a)(e,[{key:"addData",value:function(e){var t,a=e.meteringPoint,n="".concat(e.month,"/").concat(e.day,"/").concat(e.year);this.dateStrings.has(n)||this.dateStrings.add(n),this.loadProfiles.has(a)||this.loadProfiles.set(a,new C(a)),null===(t=this.loadProfiles.get(a))||void 0===t||t.addLoadProfileData(e,n)}},{key:"removeData",value:function(e,t){var a=this;t.forEach((function(t){if(a.loadProfiles.has(t)){var n=a.loadProfiles.get(t);null===n||void 0===n||n.removeLoadPRofileData(e)}}))}},{key:"resetData",value:function(){this.nonCoincidentPeak=0,this.loadProfilesMax=[],this.loadProfilesSum=[],this.totalLoadpRofile=new C("Total"),this.chartData=new Map}},{key:"extractDataThenAddToTotal",value:function(e,t){var a=new A(e.getTotalKwdel(),e.getTotalKwhdel(),t.date.getDate(),t.date.getMonth()+1,t.date.getFullYear(),e.hour,3,"Total",0),n="".concat(a.month,"/").concat(a.day,"/").concat(a.year);this.totalLoadpRofile.addLoadProfileData(a,n)}},{key:"extractDailyLoadProfileTotalKwdelThenAddToData",value:function(e,t){var a="".concat(e.date.getMonth()+1,"/").concat(e.date.getDate());if(this.chartData.has(a)){this.chartData.get(a)["".concat(t.meteringPoint)]=e.sum.kwdel}else{var n={date:a};n["".concat(t.meteringPoint)]=e.sum.kwdel,this.chartData.set(a,n)}}},{key:"initOtherDetails",value:function(){this.resetData();var e,t=Object(f.a)(this.loadProfiles.values());try{for(t.s();!(e=t.n()).done;){for(var a=e.value,n=0,o=Object(p.a)(a.dailyLoadProfiles.values());n<o.length;n++){var r=o[n];r.genMaxAndSum();var i,l=Object(f.a)(r.hourlyLoadProfiles);try{for(l.s();!(i=l.n()).done;){var c=i.value;this.extractDataThenAddToTotal(c,r)}}catch(O){l.e(O)}finally{l.f()}this.extractDailyLoadProfileTotalKwdelThenAddToData(r,a)}var s=a.genMaxAndSum(),u=s.max,d=s.sum;0===d.kwdel?this.loadProfiles.delete(a.meteringPoint):(this.loadProfilesMax.push(u),this.loadProfilesSum.push(d),this.nonCoincidentPeak+=u.kwdel)}}catch(O){t.e(O)}finally{t.f()}var h,m=Object(f.a)(this.totalLoadpRofile.dailyLoadProfiles.values());try{for(m.s();!(h=m.n()).done;){var g,b=h.value,v=Object(f.a)(b.hourlyLoadProfiles);try{for(v.s();!(g=v.n()).done;){var E=g.value;E.getRawTotal()>this.coincidentPeak.kwdel&&(this.coincidentPeak.kwdel=E.getRawTotal(),this.coincidentPeak.date=b.date,this.coincidentPeak.hour=E.hour,this.coincidentPeak.meteringPoint="Total")}}catch(O){v.e(O)}finally{v.f()}}}catch(O){m.e(O)}finally{m.f()}this.diversityFactor=this.nonCoincidentPeak/this.coincidentPeak.kwdel,console.log({info:"max and sum",max:this.loadProfilesMax,sum:this.loadProfilesSum,coincidental:this.coincidentPeak,nonCoincidental:this.nonCoincidentPeak,diversityFactor:this.diversityFactor,totalLoadProfile:this.totalLoadpRofile,chartData:this.chartData,hourlyLoadpRofiles:[]})}}]),e}(),j=function(){function e(t){Object(b.a)(this,e),this.data=void 0,this.top=void 0,this.data=[],this.top=0,t&&(this.data=t.data,this.top=t.top)}return Object(v.a)(e,[{key:"push",value:function(e){this.data[this.top]=e,this.top=this.top+1}},{key:"length",value:function(){return this.top}},{key:"peek",value:function(){return this.data[this.top-1]}},{key:"isEmpty",value:function(){return 0===this.top}},{key:"pop",value:function(){if(!1===this.isEmpty())return this.top=this.top-1,this.data.pop()}}]),e}(),I=Object(o.createContext)({updateLoadProfiles:function(e){},monthlyLoadProfiles:new Map,working:!1,deleteLoadProfiles:function(e){}}),N=function(e){var t=e.children,a=(Object(g.a)(e,["children"]),Object(o.useState)(new Map)),n=Object(m.a)(a,2),i=n[0],l=n[1],c=Object(o.useState)(new j),s=Object(m.a)(c,2),u=s[0],d=s[1],h=Object(o.useState)(!1),p=Object(m.a)(h,2),b=p[0],v=p[1];return Object(o.useEffect)((function(){console.log("MonthlyLoadProfiles State Updated"),console.log(i)}),[i]),Object(o.useEffect)((function(){if(!b)if(u.isEmpty())v(!1);else{var e,t,a,n=new j(u),o=n.pop();o&&(v(!0),o instanceof Array?(console.log("Data instance of ARRRRAAAAY...."),(a=o,new Promise((function(e,t){console.log("Processing rawDatas");var n,o=new Map(i),r=Object(f.a)(a);try{for(r.s();!(n=r.n()).done;){var l,c=n.value,s="".concat(c.billingPeriod.month,"-").concat(c.year);o.has(s)||o.set(s,new M(c.billingPeriod)),null===(l=o.get(s))||void 0===l||l.addData(c)}}catch(u){r.e(u)}finally{r.f()}o.forEach((function(e){return e.initOtherDetails()})),e(o)}))).then((function(e){l(e),v(!1),d(n)}))):(console.log("Data instance of ARRRRAAAAY...."),(e=o.fileName,t=o.meteringPoints,new Promise((function(a,n){console.log("DELETING LAODP ROFILESS");var o,r=new Map(i),l=Object(f.a)(r.keys());try{for(l.s();!(o=l.n()).done;){var c=o.value,s=r.get(c);null===s||void 0===s||s.removeData(e,t)}}catch(u){l.e(u)}finally{l.f()}r.forEach((function(e){if(e.initOtherDetails(),0===e.nonCoincidentPeak){var t="".concat(e.billingPeriod.month,"-").concat(e.billingPeriod.year);r.delete(t)}})),a(r)}))).then((function(e){l(e),v(!1),d(n)}))))}}),[u]),r.a.createElement(I.Provider,{value:{updateLoadProfiles:function(e){console.log("Updating load profile datas in context...."),d((function(t){var a=new j(t);return a.push(e),a}))},monthlyLoadProfiles:i,deleteLoadProfiles:function(e){d((function(t){var a=new j(t);return a.push(e),a}))},working:b}},t)},D=a(53),T=a(187),R=a(219),F=a(188),L=a(189),_=a(230),H=a(183),U=Object(u.a)((function(e){return{root:{border:"none",borderRadius:0,"&.Mui-selected":{backgroundColor:e.palette.background.default,color:e.palette.primary.main},"&:hover, &.Mui-selected:hover":{color:e.palette.primary.main,backgroundColor:e.palette.background.default},selected:{}}}})),V=function(e){var t=e.value,a=e.children,n=Object(g.a)(e,["value","children"]),o=U();return r.a.createElement(H.a,Object.assign({classes:{root:o.root},value:t},n),a)},Y=Object(u.a)((function(e){return{root:{width:50,height:"100%",zIndex:e.zIndex.drawer+10},container:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",height:"100%",width:"100%"},toggleButtonsContainer:{},otherButtonsContainer:{display:"flex",flexDirection:"column"}}}));!function(e){e.FILES="files",e.SETTINGS="settings",e.NONE=""}(P||(P={}));var W,B=function(e){var t=e.onFilesToggled,a=e.onSettingsToggled,n=e.onSettingsUntoggled,i=e.onFilesUntoggled,l=(Object(g.a)(e,["onFilesToggled","onSettingsToggled","onSettingsUntoggled","onFilesUntoggled"]),Object(o.useState)(P.FILES)),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(P.NONE),h=Object(m.a)(d,2),f=h[0],p=h[1];var b=Y();return r.a.createElement(T.a,{elevation:4,className:b.root,position:"static",color:"inherit"},r.a.createElement(R.a,{className:b.container},r.a.createElement(R.a,{className:b.toggleButtonsContainer},r.a.createElement(_.a,{onChange:function(e,a){console.log({method:"handleToggleChange()",params:{newToggle:a}});var n=s;u(a),a===P.FILES?t():n===P.FILES&&i()},value:s,exclusive:!0},r.a.createElement(V,{value:P.FILES},r.a.createElement(F.a,null)))),r.a.createElement(R.a,{className:b.otherButtonsContainer},r.a.createElement(_.a,{onChange:function(e,t){console.log({method:"handleOtherToggleChange()",params:{newToggle:t}});var o=f;p(t),t===P.SETTINGS?a():o===P.SETTINGS&&n()},value:f,exclusive:!0},r.a.createElement(V,{value:P.SETTINGS},r.a.createElement(L.a,null))))))},G=a(227),K=a(97),Z=a(222),z=Object(u.a)((function(e){return Object(Z.a)({drawer:{width:300,flexShrink:0},drawerPaper:{width:300,position:"static",borderLeft:"1px solid ".concat(e.palette.divider),borderRight:"1px solid ".concat(e.palette.divider)},drawerHeader:Object(K.a)(Object(K.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-300},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}})})),J=a(18),$=a.n(J),X=a(25),q=a(223),Q=a(224),ee=a(99),te=a(191),ae=a(190),ne=Object(u.a)((function(e){return Object(Z.a)({accordion:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"},expanded:{}},accordionSummary:{borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:30,"&$expanded":{minHeight:30,backgroundColor:"black"},expanded:{}},content:{margin:2},accordionTitle:{fontSize:"0.8rem",asdf:{}},expanded:{},accordionDetails:{backgroundColor:e.palette.background.default,padding:"5px",position:"relative"}})})),oe=function(e){e.expandedPanel;var t=e.onPanelChange,a=e.panelName,n=e.title,o=(e.render,e.children),i=(Object(g.a)(e,["expandedPanel","onPanelChange","panelName","title","render","children"]),ne());return r.a.createElement(q.a,{className:i.accordion,square:!0,onChange:function(e,n){t(n?a:"")}},r.a.createElement(Q.a,{className:i.accordionSummary,classes:{content:i.content},expandIcon:r.a.createElement(ae.a,null)},r.a.createElement(ee.a,{className:i.accordionTitle},n)),r.a.createElement(te.a,{className:i.accordionDetails},o))},re=a(192),ie=a(193),le=a(195),ce=a(197),se=a(198),ue=a(199),de=a(194),he=Object(u.a)((function(e){return{root:{zIndex:e.zIndex.mobileStepper,maxWidth:"100%",fontSize:"0.8rem",boxSizing:"border-box",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),padding:10,overflowWrap:"break-word",wordWrap:"break-word"},filename:{fontSize:"1em",color:e.palette.text.primary},progress_text:{fontSize:"0.7em",color:e.palette.text.secondary,alignSelf:"flex-end"},content:{display:"flex",flexDirection:"column",gap:"5px",justifyContent:"center"},progress_content:{display:"flex",flexDirection:"column",gap:"3px"},action:{},button:{textTransform:"none"},error_container:{maxWidth:"100%",width:"550px"},error_text:{fontSize:"0.9rem",padding:"10px 5px",whiteSpace:"pre-wrap"}}})),fe=function(e){var t=e.file,a=e.progress,n=e.progressInfo,i=e.errors,l=void 0===i?[]:i,c=e.onRemoveFile,s=(Object(g.a)(e,["file","progress","progressInfo","errors","onRemoveFile"]),he()),u=Object(o.useState)(!1),d=Object(m.a)(u,2),h=d[0],f=d[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:s.root},r.a.createElement("div",{className:s.content},r.a.createElement(ee.a,{className:s.filename},t.name),r.a.createElement("div",{className:s.progress_content},r.a.createElement(re.a,{value:a,variant:0===a||100===a?"determinate":"indeterminate"}),r.a.createElement(ee.a,{className:s.progress_text},n))),r.a.createElement("div",{className:s.action},0!==l.length&&r.a.createElement(ie.a,{className:s.button,size:"small",color:"secondary",startIcon:r.a.createElement(de.a,{color:"error"}),onClick:function(){f(!0)}},"see errors"),r.a.createElement(ie.a,{className:s.button,onClick:c,size:"small",color:"primary"},"Remove"))),r.a.createElement(le.a,{open:h,onClose:function(){f(!1)}},r.a.createElement(ce.a,null,r.a.createElement(ee.a,{variant:"h6",color:"error"},"Errors"),r.a.createElement(ee.a,{variant:"subtitle1",color:"textSecondary"},t.name),r.a.createElement(se.a,null)),r.a.createElement(ue.a,null,r.a.createElement(R.a,{overflow:"auto",padding:"5px 25px"},l.map((function(e,t){return r.a.createElement("div",{key:t,className:s.error_container},r.a.createElement(ee.a,{component:"p",className:s.error_text,key:"".concat(t,"~error")},e),r.a.createElement(se.a,null))}))))))};!function(e){e.KWDEL="lp_kwdelCol",e.KWHDEL="lp_kwhdelCol",e.DATE="lp_dateCol",e.TIME="lp_timeCol",e.DATE_FORMAT="lp_dateFormat",e.TIME_FORMAT="lp_timeFormat"}(W||(W={}));var me={loadSettings:function(){return{kwdelCol:Number(localStorage.getItem(W.KWDEL)||"1"),dateCol:Number(localStorage.getItem(W.DATE)||"2"),timeCol:Number(localStorage.getItem(W.TIME)||"3"),dateFormat:localStorage.getItem(W.DATE_FORMAT)||"MM/DD/YYYY",timeFormat:localStorage.getItem(W.TIME_FORMAT)||"HH:mm",kwhdelCol:Number(localStorage.getItem(W.KWHDEL)||"4")}},saveSettings:function(e){localStorage.setItem(W.KWDEL,String(e.kwdelCol)),localStorage.setItem(W.TIME,String(e.timeCol)),localStorage.setItem(W.DATE,String(e.dateCol)),localStorage.setItem(W.DATE_FORMAT,String(e.dateFormat)),localStorage.setItem(W.TIME_FORMAT,String(e.timeFormat)),localStorage.setItem(W.KWHDEL,e.kwhdelCol.toString())}},ge=a(23),pe=a.n(ge),be=a(107),ve=a(112),Ee=a(113),Oe=function(e){Object(be.a)(a,e);var t=Object(ve.a)(a);function a(e){return Object(b.a)(this,a),t.call(this,e)}return a}(Object(Ee.a)(Error));function ye(){return(ye=Object(X.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){console.log("FileUTils: Timeout wait for 10 secs....");var n=t.name.split(".")[1];console.log({method:"extractWorkbookFromFile()",parameteres:{file:t},fileTypeSplit:t.name.split("."),fileExtension:n}),"xlsx"!==n&&a(new Oe("Invalid file: expected: .xlsx received: ".concat(n)));var o=new FileReader;o.onload=function(t){try{var n,o=new Uint8Array(null===(n=t.target)||void 0===n?void 0:n.result),r=pe.a.read(o,{type:"array",cellDates:!0});e(r)}catch(i){a(new Error(i))}},o.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we,Pe={extractWorkbookFromFile:function(e){return ye.apply(this,arguments)}};!function(e){e.TETUAN="Tetuan",e.MERCEDES="Mercedes",e.NORTHSIDE="Northside",e.ZAMPEN="Zampen",e.GUIWAN="Guiwan",e.TUMAGA="Tumaga",e.ARENA_BLANCO="Arena Blanco",e.PRESA="Presa",e.SAN_JOSE="San Jose",e.CALARIAN="Calarian",e.BALIWASAN="Baliwasan",e.DEDICATED_LINE="Dedicated Line",e.INTERCO="Interco (1-3MVA)",e.CULIANAN="Culianan",e.CURUAN="Curuan",e.FISHING_PORT="Fishing Port",e.TALISAYAN="Talisayan",e.LABUAN="Labuan",e.RECODO="Recodo",e.SINUNUC="Sinunuc",e.PERMEX="PERMEX (2-2MVA)",e.BIG_FISH="Big Fish (1-2MVA)",e.TIN_CAN_ORIENTAL="Tin Can Oriental (1-2MVA)",e.MEGA_FISHIN_CORP="Mega Fishing Corp. (1-4MVA)",e.MEGA_FISHIN_CORP2="Mega Fishing Corp. (1-3MVA)",e.PASONANCA="Pasonanca",e.SAN_ROQUE="San Roque",e.ACLEM="Aclem",e.GOVERNOR_ALVAREZ="Governor Alvarez",e.VETERANS_AVENUE="Veterans Avenue",e.NUNEZ="Nu\u0148ez",e.STA_CATALINA="Sta Catalina",e.RIO_HONDO="Rio Hondo",e.GUARDIA_NACIONAL="Guardia Nacional",e.CAMPANER="Campaner",e.KCC_MALL="KCC Mall (1-10MVA)"}(we||(we={}));var Se=we,xe=function(){function e(t,a,n,o){Object(b.a)(this,e),this.key=void 0,this.text=void 0,this.serialNumber=void 0,this.power=void 0,this.key=t,this.text=a,this.serialNumber=n,this.power=o}return Object(v.a)(e,[{key:"toString",value:function(){return this.key}}]),e}();xe.HYOSUNG_20MVA=new xe("HYOSUNG_20MVA","HYOSUNG PTX - 20MVA","TP99-8513",20),xe.SHIHLIN_20MVA=new xe("SHIHLIN_20MVA","SHIHLIN PTX - 20MVA","810014",20),xe.SHIHLIN_10MVVA=new xe("SHIHLIN_10MVVA ","SHIHLIN PTX - 10MVA","T990113",10),xe.SHIHLIN_5MVA=new xe("SHIHLIN_5MVA","SHIHLIN PTX - 5MVA","",5),xe.NANJING_20MVA=new xe("NANJING_20MVA","NANJING PTX - 20MVA","610205",20),xe.PRIME_MEIDEN_10MVA=new xe("PRIME_MEIDEN_10MVA","PRIME MEIDEN PTX - 10MVA","",10),xe.NEW_KOREA_10MVA=new xe("NEW_KOREA_10MVA","NEW KOREA PTX - 10MVA","W910009",10),xe.NEW_KOREA_5MVA=new xe("NEW_KOREA_5MVA","NEW KOREA PTX - 5MVA","920194",5),xe.CHANGZHOU_10MVA=new xe("CHANGZHOU_10MVA","CHANGZHOU PTX - 10MVA","91-61-146",10),xe.SHENDA_25MVA=new xe("SHENDA_25MVA","SHENDA PTX - 25MVA","",25);var Ae=xe,Ce=function e(t,a){Object(b.a)(this,e),this.transformer=void 0,this.feeders=void 0,this.transformer=t,this.feeders=a},ke=function(){function e(t,a,n){Object(b.a)(this,e),this.key=void 0,this.text=void 0,this.substationItems=void 0,this.key=t,this.text=a,this.substationItems=n}return Object(v.a)(e,[{key:"toStrting",value:function(){return this.key}}]),e}();ke.PUTIK=new ke("PUTIK","PUTIK S/S",[new Ce(Ae.SHIHLIN_10MVVA,[Se.GUIWAN,Se.TUMAGA,Se.ARENA_BLANCO,Se.PRESA]),new Ce(Ae.HYOSUNG_20MVA,[Se.TETUAN,Se.MERCEDES,Se.NORTHSIDE,Se.ZAMPEN])]),ke.SANJOSE_GUSU=new ke("SAN JOSE GUSU","SAN JOSE GUSU S/S",[new Ce(Ae.NANJING_20MVA,[Se.SAN_JOSE,Se.CALARIAN,Se.BALIWASAN,Se.DEDICATED_LINE]),new Ce(Ae.NEW_KOREA_10MVA,[])]),ke.SANGALI=new ke("SANGALI","SANGALI S/S",[new Ce(Ae.PRIME_MEIDEN_10MVA,[Se.CULIANAN,Se.CURUAN,Se.FISHING_PORT])]),ke.AYALA=new ke("AYALA","AYALA S/S",[new Ce(Ae.SHIHLIN_10MVVA,[Se.TALISAYAN,Se.LABUAN])]),ke.RECODO=new ke("RECODO","RECODO S/S",[new Ce(Ae.NEW_KOREA_10MVA,[Se.RECODO]),new Ce(Ae.NEW_KOREA_5MVA,[Se.SINUNUC]),new Ce(Ae.SHIHLIN_5MVA,[])]),ke.CABATANGAN=new ke("CABATANGAN","CABATANGAN S/S",[new Ce(Ae.CHANGZHOU_10MVA,[Se.PASONANCA]),new Ce(Ae.PRIME_MEIDEN_10MVA,[Se.SAN_ROQUE])]),ke.CAMANCHILI=new ke("CAMANCHILI","CAMANCHILI S/S",[new Ce(Ae.SHIHLIN_20MVA,[Se.ACLEM,Se.GOVERNOR_ALVAREZ,Se.VETERANS_AVENUE,Se.NUNEZ]),new Ce(Ae.SHENDA_25MVA,[Se.STA_CATALINA,Se.RIO_HONDO,Se.GUARDIA_NACIONAL,Se.CAMPANER])]);var Me=ke,je=function(){function e(t,a){Object(b.a)(this,e),this.key=void 0,this.substations=void 0,this.key=t,this.substations=a}return Object(v.a)(e,[{key:"toString",value:function(){return this.key}},{key:"getFeeders",value:function(){var e,t=[],a=Object(f.a)(this.substations);try{for(a.s();!(e=a.n()).done;){var n,o=e.value,r=Object(f.a)(o.substationItems);try{for(r.s();!(n=r.n()).done;){var i=n.value;t=[].concat(Object(p.a)(t),Object(p.a)(i.feeders))}}catch(l){r.e(l)}finally{r.f()}}}catch(l){a.e(l)}finally{a.f()}return t}}],[{key:"getMeteringPoint",value:function(e){switch(e.toUpperCase()){case this.MF3MPITZAMC01.key:return this.MF3MPITZAMC01;case this.MF3MPITZAMC02.key:return this.MF3MPITZAMC02;case this.MF3MPITZAMC03.key:return this.MF3MPITZAMC03;case this.MF3MPITZAMC04.key:return this.MF3MPITZAMC04;case this.MF3MPITZAMC05.key:return this.MF3MPITZAMC05;case this.MF3MPITZAMC06.key:return this.MF3MPITZAMC06;case this.MF3MPITZAMC07.key:return this.MF3MPITZAMC07;default:return null}}},{key:"exists",value:function(e){switch(e){case this.MF3MPITZAMC01.key:case this.MF3MPITZAMC02.key:case this.MF3MPITZAMC03.key:case this.MF3MPITZAMC04.key:case this.MF3MPITZAMC05.key:case this.MF3MPITZAMC06.key:case this.MF3MPITZAMC07.key:return!0;default:return!1}}}]),e}();je.MF3MPITZAMC01=new je("MF3MPITZAMC01",[Me.PUTIK]),je.MF3MPITZAMC02=new je("MF3MPITZAMC02",[Me.SANJOSE_GUSU]),je.MF3MPITZAMC03=new je("MF3MPITZAMC03",[Me.SANGALI]),je.MF3MPITZAMC04=new je("MF3MPITZAMC04",[Me.RECODO,Me.AYALA]),je.MF3MPITZAMC05=new je("MF3MPITZAMC05",[Me.CABATANGAN]),je.MF3MPITZAMC06=new je("MF3MPITZAMC06",[]),je.MF3MPITZAMC07=new je("MF3MPITZAMC07",[Me.CAMANCHILI]);var Ie=je,Ne=function(){function e(){Object(b.a)(this,e)}return Object(v.a)(e,null,[{key:"extractDate",value:function(e,t){var a=null,n=null,o=null;return e?"d"!==e.t?"s"===e.t?(o=w()(e.v||e.w||e.r,t)).isValid()?a=o.toDate():n=" ".concat(e.v," does not match the date format in setstings ").concat(t):n="Invalid Cell Value: Expected Date, received: ".concat(e.v):a=e.v:n="Cell is empty",{date:a,error:n}}},{key:"extractNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=null,n=null;return e?"n"===e.t||Number(e.v||e.w)?a=Number(e.r||e.v):n="Invalid Cell Value: Expected number, received: ".concat(e.v):t?n="Cell is empty":a=0,{number:a,error:n}}},{key:"extractText",value:function(e){var t=null,a=null;return e?"s"!==e.t?t="Invalid Cell Value: Expected Text, received: ".concat(e.v):a=e.v:t="Cell is empty",{text:a,error:t}}},{key:"calculatePercent",value:function(e,t){return new Promise((function(a,n){setTimeout((function(){a(e/t*100)}),0)}))}}]),e}();function De(e,t){return new Promise((function(a,n){setTimeout((function(){a(e/t*100)}),0)}))}function Te(e,t,a,n){var o={c:n.kwdelCol,r:t},r={c:n.dateCol,r:t},i={c:n.timeCol,r:t},l={c:n.kwhdelCol,r:t},c=pe.a.utils.encode_cell(o),s=pe.a.utils.encode_cell(r),u=pe.a.utils.encode_cell(i),d=pe.a.utils.encode_cell(l);return{kwdelCell:e[c],timeCell:e[u],dateCell:e[s],kwhdelCell:e[d],sheetName:a,row:t}}function Re(e,t,a){var n=null,o=Ne.extractNumber(e.kwdelCell),r=Ne.extractNumber(e.kwhdelCell),i=Ne.extractDate(e.dateCell,t.dateFormat),l=Ne.extractDate(e.timeCell,t.timeFormat);if(Boolean(o.error||i.error||l.error||r.error))throw n="Errors in row ".concat(e.row+1,":\n"),o.error&&(n=n.concat("\tKwdel Cell: ".concat(o.error,"\n"))),i.error&&(n=n.concat("\tDate Cell: ".concat(i.error,"\n"))),l.error&&(n=n.concat("\tTime Cell: ".concat(l.error,"\n"))),r.error&&(n=n.concat("\tKwhdel Cell: ".concat(l.error,"\n"))),new Error(n);var c,s,u,d,h,f=r.number,m=o.number,g=null===(c=i.date)||void 0===c?void 0:c.getDate(),p=null===(s=i.date)||void 0===s?void 0:s.getMonth(),b=null===(u=l.date)||void 0===u?void 0:u.getHours(),v=null===(d=l.date)||void 0===d?void 0:d.getMinutes(),E=null===(h=i.date)||void 0===h?void 0:h.getFullYear();return new A(m,f,g,p+1,E,b,v,e.sheetName,e.row,a)}var Fe,Le=function(e,t,a){return new Promise(function(){var n=Object(X.a)($.a.mark((function n(o,r){var i,l,c,s,u,d,h,m,g,p,b,v,E,O;return $.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t){n.next=4;break}return r(new Error("Invalid file")),a("tsk, wrong file",100),n.abrupt("return");case 4:console.log("Parsing workbook..."),i=[],l=[],c=[],s=Object(f.a)(t.SheetNames),n.prev=9,s.s();case 11:if((u=s.n()).done){n.next=38;break}if(d=u.value,Ie.exists(d)){n.next=16;break}return l.push("Invalid sheetname: ".concat(d,", expected: MF3MPITZAMC01~7")),n.abrupt("continue",36);case 16:if(c.push(d),a("Parsing ".concat(d),0),console.log("Parsing worksheet: "+d),(h=t.Sheets[d])["!ref"]){n.next=22;break}return n.abrupt("continue",36);case 22:return m=pe.a.utils.decode_range(h["!ref"]),n.next=25,Promise.resolve(m.e.r-m.s.r);case 25:g=n.sent,p=0;case 27:if(!(p<=m.e.r)){n.next=36;break}return n.next=30,De(p,g);case 30:b=n.sent,a("Processing rows ".concat(p,"/").concat(g," ").concat(b.toFixed(0),"%"),b);try{v=me.loadSettings(),E=Te(h,p,d,v),O=Re(E,v,e),i.push(O)}catch(y){l.push(y.message)}case 33:p++,n.next=27;break;case 36:n.next=11;break;case 38:n.next=43;break;case 40:n.prev=40,n.t0=n.catch(9),s.e(n.t0);case 43:return n.prev=43,s.f(),n.finish(43);case 46:console.log("finished"),o({value:i,errors:l,meteringPoints:c});case 48:case"end":return n.stop()}}),n,null,[[9,40,43,46]])})));return function(e,t){return n.apply(this,arguments)}}())},_e=function(e){var t=e.file,a=e.render,n=e.onFileParsed,i=e.onRemoveFile,l=(Object(g.a)(e,["file","render","onFileParsed","onRemoveFile"]),Object(o.useState)(0)),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(""),h=Object(m.a)(d,2),f=h[0],b=h[1],v=Object(o.useState)([]),E=Object(m.a)(v,2),O=E[0],y=E[1],w=Object(o.useState)([]),P=Object(m.a)(w,2),S=P[0],x=P[1];function A(e,t){u(t),b(e)}return Object(o.useEffect)((function(){Pe.extractWorkbookFromFile(t).then((function(e){return Le(t.name,e,A)})).then((function(e){var t;y(e.errors),t=e.value,n(t),x((function(t){return[].concat(Object(p.a)(t),Object(p.a)(e.meteringPoints))}))})).catch((function(e){console.error(e),O.push(e.message)}))}),[]),r.a.createElement(r.a.Fragment,null,a({progress:s,progressInfo:f,file:t,errors:O,onRemoveFile:function(){i(t,S)}}))},He=a(4),Ue=a(111),Ve=Object(u.a)((function(e){return{dropZone:{height:"100%",width:"100%",cursor:"pointer",minHeight:50},dropZone_focused:{border:"2px dashed ".concat(e.palette.text.secondary)},dropZone_content:{display:"flex",flexDirection:"column",maxWidth:"100%",gap:"10px",flexWrap:"wrap",margin:5},dropZoneText:{fontSize:"0.8rem",fontWeight:"bold",padding:"5px"}}})),Ye=function(e){var t=e.helperText,a=void 0===t?"":t,n=e.onFileDrop,i=e.onDragEnter,l=e.onDragLeave,c=(e.onDragOver,e.children),s=(Object(g.a)(e,["helperText","onFileDrop","onDragEnter","onDragLeave","onDragOver","children"]),Object(o.useState)(!1)),u=Object(m.a)(s,2),d=u[0],h=u[1],f=Ve();function p(){h(!0),i()}function b(){h(!1),l()}return r.a.createElement(R.a,{display:"flex",flexDirection:"column",width:"100%"},r.a.createElement(Ue.a,{onDrop:n,onDragEnter:p,onDragLeave:b},(function(e){var t=e.getRootProps,n=e.getInputProps;return r.a.createElement("section",{onMouseEnter:p,onMouseLeave:b,className:Object(He.a)(f.dropZone,Object(D.a)({},f.dropZone_focused,d))},r.a.createElement("div",t({className:"".concat(f.dropZone_content)}),r.a.createElement("input",n()),r.a.createElement(ee.a,{variant:"subtitle1",color:"textSecondary",className:f.dropZoneText},a)))})),r.a.createElement(R.a,{display:"flex",flexDirection:"column",maxWidth:"100%",gridGap:5,marginTop:1},c))},We=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=(Object(g.a)(e,["expandedPanel","onPanelChange"]),Object(o.useState)(new Map)),i=Object(m.a)(n,2),l=i[0],c=i[1],s=Object(o.useContext)(I);function u(){return(u=Object(X.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){c((function(t){if(t.has(e.name))return t;var a=new Map(t);return a.set(e.name,e),a}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){s.updateLoadProfiles(e)}function h(e,t){c((function(t){var a=new Map(t);return a.delete(e.name),a})),s.deleteLoadProfiles({fileName:e.name,meteringPoints:t})}return r.a.createElement(oe,{onPanelChange:a,title:"Load Profile Files",panelName:"laodprofile_filespanel",expandedPanel:t},r.a.createElement(Ye,{onDragEnter:function(){},onDragLeave:function(){},onFileDrop:function(e){return u.apply(this,arguments)},helperText:"Drop files here"},Object(p.a)(l.values()).map((function(e){return r.a.createElement(_e,{onFileParsed:d,key:e.name,file:e,onRemoveFile:h,render:function(e){return r.a.createElement(fe,{progress:e.progress,progressInfo:e.progressInfo,file:e.file,errors:e.errors,onRemoveFile:e.onRemoveFile})}})}))))};function Be(e){e=e.toUpperCase().trim();for(var t=0,a=Object.values(Se);t<a.length;t++){var n=a[t];if(n.toUpperCase().trim()===e)return n}return null}function Ge(){for(var e=[],t=1,a=0,n=Object.values(S);a<n.length;a++){var o=n[a];isNaN(Number(o))&&(e.push({month:String(o),monthNum:t}),t++)}return e}function Ke(){for(var e=[],t=(new Date).getFullYear(),a=2012;a<=t;a++)e.push(a);return e}!function(e){e.DATE="mis_date",e.DURATION="mis_duration",e.DATE_FORMAT="mis_dateformat",e.FEEDER="mis_feeder"}(Fe||(Fe={}));var Ze=Object.freeze({createRawDataObject:function(e,t,a){var n=x.getBillingMonth(a.getMonth()+1,a.getDay()),o=new x(n,a.getFullYear());return{duration:e,feeder:t.toUpperCase().trim(),date:a,billingPeriod:o}},saveSettings:function(e){localStorage.setItem(Fe.DATE,e.dateCol.toString()),localStorage.setItem(Fe.DURATION,e.durationCol.toString()),localStorage.setItem(Fe.DATE_FORMAT,e.dateFormat),localStorage.setItem(Fe.FEEDER,e.feederCol.toString())},loadSettings:function(){return{dateCol:Number(localStorage.getItem(Fe.DATE))||0,durationCol:Number(localStorage.getItem(Fe.DURATION))||1,dateFormat:localStorage.getItem(Fe.DATE_FORMAT)||"MM/DD/YYYY",feederCol:Number(localStorage.getItem(Fe.FEEDER))||2}}});function ze(e,t){var a=null,n=Ne.extractDate(e.date,t.dateFormat),o=Ne.extractText(e.feeder),r=Ne.extractNumber(e.duration);o.text&&(Be(o.text)||(o.error="Feeder value ".concat(o.text," does not match any of the registered feeders")));if(Boolean(n.error||r.error||o.error))throw a="Errors in row ".concat(e.row+1,":\n"),r.error&&(a=a.concat("\tDuration Cell: ".concat(r.error,"\n"))),n.error&&(a=a.concat("\tDate Cell: ".concat(n.error,"\n"))),o.error&&(a=a.concat("\tFeeder Cell: ".concat(o.error,"\n"))),new Error(a);var i=r.number,l=n.date,c=o.text;return Ze.createRawDataObject(i,c,l)}function Je(e,t,a){var n={c:a.dateCol,r:t},o={c:a.feederCol,r:t},r={c:a.durationCol,r:t},i=pe.a.utils.encode_cell(n),l=pe.a.utils.encode_cell(o),c=pe.a.utils.encode_cell(r);return{feeder:e[l],date:e[i],duration:e[c],row:t}}var $e,Xe=Object.freeze({extractRawDatasFromWorkbook:function(e,t,a){return new Promise(function(){var e=Object(X.a)($.a.mark((function e(n,o){var r,i,l,c,s,u,d,h,m,g,p,b,v;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=[],console.log("MonthllyInterruption Workbook: "),console.log(t),l=Object(f.a)(t.SheetNames),e.prev=5,l.s();case 7:if((c=l.n()).done){e.next=30;break}if(s=c.value,u=t.Sheets[s],a("Parsing ".concat(s),0),console.log("Parsing worksheet: "+s),u["!ref"]){e.next=14;break}return e.abrupt("continue",28);case 14:return d=pe.a.utils.decode_range(u["!ref"]),e.next=17,Promise.resolve(d.e.r-d.s.r);case 17:h=e.sent,m=0;case 19:if(!(m<=d.e.r)){e.next=28;break}return e.next=22,Ne.calculatePercent(m,h);case 22:g=e.sent,a("Processing rows ".concat(m,"/").concat(h," ").concat(g.toFixed(0),"%"),g);try{p=Ze.loadSettings(),b=Je(u,m,p),v=ze(b,p),i.push(v)}catch(o){r.push(o.message)}case 25:m++,e.next=19;break;case 28:e.next=7;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(5),l.e(e.t0);case 35:return e.prev=35,l.f(),e.finish(35);case 38:n({value:i,errors:r});case 39:case"end":return e.stop()}}),e,null,[[5,32,35,38]])})));return function(t,a){return e.apply(this,arguments)}}())}}),qe=function(e){var t=e.file,a=e.render,n=e.onFileParsed,i=e.onRemoveFile,l=(Object(g.a)(e,["file","render","onFileParsed","onRemoveFile"]),Object(o.useState)(0)),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(""),h=Object(m.a)(d,2),f=h[0],p=h[1],b=Object(o.useState)([]),v=Object(m.a)(b,2),E=v[0],O=v[1];function y(e,t){u(t),p(e)}return Object(o.useEffect)((function(){Pe.extractWorkbookFromFile(t).then((function(e){return Xe.extractRawDatasFromWorkbook(t.name,e,y)})).then((function(e){var t;O(e.errors),t=e.value,n(t)})).catch((function(e){console.error(e),E.push(e.message)}))}),[]),r.a.createElement(r.a.Fragment,null,a({progress:s,progressInfo:f,file:t,errors:E,onRemoveFile:function(){i(t)}}))},Qe=a(90),et=function(){function e(t,a){Object(b.a)(this,e),this.feeder=void 0,this.duration=void 0,this.feeder=t,this.duration=a}return Object(v.a)(e,[{key:"addDuration",value:function(e){this.duration+=e}}]),e}(),tt=function(){function e(t){Object(b.a)(this,e),this.billingPeriod=void 0,this.items=void 0,this.billingPeriod=t,this.items=new Map}return Object(v.a)(e,[{key:"addRawData",value:function(e){var t,a=e.feeder;this.items.has(a)?null===(t=this.items.get(a))||void 0===t||t.addDuration(e.duration):this.items.set(a,new et(e.feeder,e.duration))}}]),e}(),at=function(){function e(t){Object(b.a)(this,e),this.monthlyInterruptions=void 0,this.monthlyInterruptions=t?new Map(t.monthlyInterruptions):new Map,console.trace("MonthlyMonthly Interruption creaated...")}return Object(v.a)(e,[{key:"addRawData",value:function(e){var t,a=e.billingPeriod.toString();this.monthlyInterruptions.has(a)||this.monthlyInterruptions.set(a,new tt(e.billingPeriod)),null===(t=this.monthlyInterruptions.get(a))||void 0===t||t.addRawData(e)}}]),e}(),nt=Object(o.createContext)({addNewRawData:function(e){Object(Qe.a)(e)},monthlyInterruptions:new at,addUpdateCallback:function(){}}),ot=function(e){var t=Object(o.useState)(),a=Object(m.a)(t,2),n=a[0],i=a[1],l=Object(o.useState)([]),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(new j),h=Object(m.a)(d,2),g=h[0],b=h[1];function v(e){return new Promise((function(t,a){console.log("Updating Monthly Interruptions....");var o,r=new at(n),i=Object(f.a)(e);try{for(i.s();!(o=i.n()).done;){var l=o.value;r.addRawData(l)}}catch(c){i.e(c)}finally{i.f()}t(r)}))}return Object(o.useEffect)((function(){i(new at)}),[]),Object(o.useEffect)((function(){s.forEach((function(e){e(n)}))}),[n]),Object(o.useEffect)((function(){function e(){return(e=Object(X.a)($.a.mark((function e(){var t,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Checking if buffer is not empty..."),g.isEmpty()){e.next=17;break}return e.prev=2,console.log("Buffer isn ot empty..."),console.log(g),t=g.pop(),e.next=8,v(t);case 8:a=e.sent,console.log(a),i(a),b(new j(g)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[2,14]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[g]),n?r.a.createElement(nt.Provider,{value:{addNewRawData:function(e){b((function(t){return console.log("Pushing to buffer...."),t.push(e),new j(t)}))},monthlyInterruptions:n,addUpdateCallback:function(e){u((function(t){return[].concat(Object(p.a)(t),[e])}))}}},e.children):r.a.createElement(r.a.Fragment,null)},rt=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=(Object(g.a)(e,["expandedPanel","onPanelChange"]),Object(o.useState)(new Map)),i=Object(m.a)(n,2),l=i[0],c=i[1],s=Object(o.useContext)(nt);function u(){return(u=Object(X.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){c((function(t){if(t.has(e.name))return t;var a=new Map(t);return a.set(e.name,e),a}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){s.addNewRawData(e)}function h(e){c((function(t){var a=new Map(t);return a.delete(e.name),a}))}return r.a.createElement(oe,{onPanelChange:a,title:"Monthly Interruption Files",panelName:"mi_panel",expandedPanel:t},r.a.createElement(Ye,{onDragEnter:function(){},onDragLeave:function(){},onFileDrop:function(e){return u.apply(this,arguments)},helperText:"Drop files here"},Object(p.a)(l.values()).map((function(e){return r.a.createElement(qe,{onFileParsed:d,onRemoveFile:h,key:e.name,file:e,render:function(e){return r.a.createElement(fe,{progress:e.progress,progressInfo:e.progressInfo,file:e.file,errors:e.errors,onRemoveFile:e.onRemoveFile})}})}))))},it=a(205),lt=a(206);!function(e){e.FEEDER="ps_feeder",e.DEMAND="ps_demand",e.KWHRENERGY="ps_kwhrenergy",e.KVARHRENERGY="ps_kvarhrenergy"}($e||($e={}));var ct=Object.freeze({saveSettings:function(e){localStorage.setItem($e.DEMAND,e.demandKwhrCol.toString()),localStorage.setItem($e.FEEDER,e.feederCol.toString()),localStorage.setItem($e.KWHRENERGY,e.kwhrEnergyCol.toString()),localStorage.setItem($e.KVARHRENERGY,e.kvarhrEnergyCol.toString())},loadSettings:function(){return{kvarhrEnergyCol:Number(localStorage.getItem($e.KVARHRENERGY))||0,kwhrEnergyCol:Number(localStorage.getItem($e.KWHRENERGY))||1,demandKwhrCol:Number(localStorage.getItem($e.DEMAND))||2,feederCol:Number(localStorage.getItem($e.FEEDER))||3}},createRawData:function(e,t,a,n,o){return{kwhrEnergy:t,kvarhrEnergy:a,demandKwhr:n,billingPeriod:o,feeder:e.toUpperCase().trim()}}});function st(e,t){var a=null,n=Ne.extractText(e.feeder),o=Ne.extractNumber(e.kwhrEnergy,!1),r=Ne.extractNumber(e.demandKwhr,!1),i=Ne.extractNumber(e.kvarhrEnergy,!1);n.text&&(Be(n.text)||(n.error="Feeder value ".concat(n.text," does not match any of the registered feeders")));if(Boolean(o.error||r.error||i.error||n.error))throw a="Errors in row ".concat(e.row+1,":\n"),o.error&&(a=a.concat("\tKwhrEnergy Cell: ".concat(o.error,"\n"))),r.error&&(a=a.concat("\tDemand KwhrEnergy Cell: ".concat(r.error,"\n"))),i.error&&(a=a.concat("\tKvarhrEnergy Cell: ".concat(i.error,"\n"))),n.error&&(a=a.concat("\tFeeder Cell: ".concat(n.error,"\n"))),new Error(a);var l=o.number,c=i.number,s=r.number,u=n.text;return ct.createRawData(u,l,c,s,t)}function ut(e,t,a){var n={c:a.kwhrEnergyCol,r:t},o={c:a.demandKwhrCol,r:t},r={c:a.kvarhrEnergyCol,r:t},i={c:a.feederCol,r:t},l=pe.a.utils.encode_cell(i),c=pe.a.utils.encode_cell(n),s=pe.a.utils.encode_cell(r),u=pe.a.utils.encode_cell(o);return{feeder:e[l],kwhrEnergy:e[c],demandKwhr:e[u],kvarhrEnergy:e[s],row:t}}var dt,ht=Object.freeze({extractRawDatasFromWorkbook:function(e,t,a,n){return new Promise(function(){var e=Object(X.a)($.a.mark((function e(o,r){var i,l,c,s,u,d,h,m,g,p,b,v,E;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],l=[],console.log("MonthllyInterruption Workbook: "),console.log(t),c=Object(f.a)(t.SheetNames),e.prev=5,c.s();case 7:if((s=c.n()).done){e.next=30;break}if(u=s.value,d=t.Sheets[u],n("Parsing ".concat(u),0),console.log("Parsing worksheet: "+u),d["!ref"]){e.next=14;break}return e.abrupt("continue",28);case 14:return h=pe.a.utils.decode_range(d["!ref"]),e.next=17,Promise.resolve(h.e.r-h.s.r);case 17:m=e.sent,g=0;case 19:if(!(g<=h.e.r)){e.next=28;break}return e.next=22,Ne.calculatePercent(g,m);case 22:p=e.sent,n("Processing rows ".concat(g,"/").concat(m," ").concat(p.toFixed(0),"%"),p);try{b=ct.loadSettings(),v=ut(d,g,b),E=st(v,a),l.push(E)}catch(r){i.push(r.message)}case 25:g++,e.next=19;break;case 28:e.next=7;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(5),c.e(e.t0);case 35:return e.prev=35,c.f(),e.finish(35);case 38:o({value:l,errors:i});case 39:case"end":return e.stop()}}),e,null,[[5,32,35,38]])})));return function(t,a){return e.apply(this,arguments)}}())}}),ft=a(7),mt=a(117),gt=a(200),pt=a(225),bt=a(220),vt=a(204),Et=Object(ft.a)((function(e){return Object(Z.a)({root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:e.shape.borderRadius,position:"relative",backgroundColor:e.palette.background.paper,border:e.palette.divider,fontSize:"1rem",padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color"]),fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:focus, &:hover":{borderColor:e.palette.primary.main}}})}))(mt.a),Ot=function(e){var t=e.value,a=e.onChange,n=e.items,o=e.label,i=e.className,l=Object(g.a)(e,["value","onChange","items","label","className"]);return r.a.createElement(gt.a,Object.assign({className:i},l),r.a.createElement(pt.a,{id:e.label},e.label),r.a.createElement(bt.a,{labelId:o,value:t,onChange:a,input:r.a.createElement(Et,null)},n.map((function(e){return r.a.createElement(vt.a,{value:e.value},e.text)}))))},yt=Object(u.a)((function(e){return Object(Z.a)({form:{display:"flex",padding:e.spacing(3),maxWidth:"300px"},billingYear:{flex:1}})})),wt=function(e){var t=e.file,a=e.render,n=e.onFileParsed,i=e.onRemoveFile,l=(Object(g.a)(e,["file","render","onFileParsed","onRemoveFile"]),Object(o.useState)(0)),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(""),h=Object(m.a)(d,2),f=h[0],p=h[1],b=Object(o.useState)([]),v=Object(m.a)(b,2),E=v[0],O=v[1],y=Object(o.useState)(!0),w=Object(m.a)(y,2),P=w[0],S=w[1],A=Object(o.useState)((new Date).getFullYear()),C=Object(m.a)(A,2),k=C[0],M=C[1],j=Object(o.useState)((new Date).getMonth()+1),I=Object(m.a)(j,2),N=I[0],D=I[1],T=Object(o.useState)(null),R=Object(m.a)(T,2),F=R[0],L=R[1];function _(e,t){u(t),p(e)}Object(o.useEffect)((function(){F&&Pe.extractWorkbookFromFile(t).then((function(e){var a=F;return ht.extractRawDatasFromWorkbook(t.name,e,a,_)})).then((function(e){var t;O(e.errors),t=e.value,n(t)})).catch((function(e){console.error(e),E.push(e.message)}))}),[F]);var H=yt();return r.a.createElement(r.a.Fragment,null,a({progress:s,progressInfo:f,file:t,errors:E,onRemoveFile:function(){i(t)}}),r.a.createElement(le.a,{open:P},r.a.createElement(ce.a,null,"Input Billing Period for ".concat(t.name)),r.a.createElement(ue.a,null,r.a.createElement(it.a,null,"Enter the billing month (in numbers) and the billing year (number) e.g. 5 2020 = ( April 26 ~ May 25 2020)"),r.a.createElement("form",{id:"billing-period-form",className:H.form,onSubmit:function(e){e.preventDefault(),L(new x(N,k)),S(!1)}},r.a.createElement(Ot,{className:H.billingYear,value:k.toString(),label:"Year",onChange:function(e){M(Number(e.target.value))},items:Ke().map((function(e){return{value:e.toString(),text:e.toString()}}))}),r.a.createElement(Ot,{value:N.toString(),label:"Month",onChange:function(e){D(Number(e.target.value))},items:Ge().map((function(e){return{value:e.monthNum.toString(),text:e.month.toString()}}))})),r.a.createElement(lt.a,null,r.a.createElement(ie.a,{form:"billing-period-form",type:"submit"},"OK")))))},Pt=function e(t){Object(b.a)(this,e),this.demandKwhr=void 0,this.kvarhrEnergy=void 0,this.kwhrEnergy=void 0,this.feeder=void 0,this.demandKwhr=t.demandKwhr,this.kvarhrEnergy=t.kvarhrEnergy,this.kwhrEnergy=t.kwhrEnergy,this.feeder=t.feeder},St=function(){function e(t){Object(b.a)(this,e),this.items=void 0,this.billingPeriod=void 0,this.billingPeriod=t,this.items=new Map}return Object(v.a)(e,[{key:"addRawData",value:function(e){this.items.set(e.feeder,new Pt(e))}}]),e}(),xt=function(){function e(t){Object(b.a)(this,e),this.powerSubstations=void 0,this.powerSubstations=t?new Map(t.powerSubstations):new Map,console.trace("Monthly Power Substation Created...")}return Object(v.a)(e,[{key:"addRawData",value:function(e){var t,a=e.billingPeriod.toString();this.powerSubstations.has(a)||this.powerSubstations.set(a,new St(e.billingPeriod)),null===(t=this.powerSubstations.get(a))||void 0===t||t.addRawData(e)}}]),e}(),At=Object(o.createContext)({addNewRawDatas:function(e){Object(Qe.a)(e)},monthlyPowerSubstation:new xt,addUpdateCallback:function(){}}),Ct=function(e){var t=Object(o.useState)(),a=Object(m.a)(t,2),n=a[0],i=a[1],l=Object(o.useState)(new j),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)([]),h=Object(m.a)(d,2),g=h[0],b=h[1];function v(e){return new Promise((function(t,a){var o,r=new xt(n),i=Object(f.a)(e);try{for(i.s();!(o=i.n()).done;){var l=o.value;r.addRawData(l)}}catch(c){i.e(c)}finally{i.f()}t(r)}))}return Object(o.useEffect)((function(){function e(){return(e=Object(X.a)($.a.mark((function e(){var t,a;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("checking if buffer is empty..."),s.isEmpty()){e.next=11;break}return t=s.pop(),e.next=5,v(t);case 5:a=e.sent,console.log(a),i(a),u(new j(s)),e.next=12;break;case 11:console.log("buffer is empty");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[s]),Object(o.useEffect)((function(){i(new xt)}),[]),Object(o.useEffect)((function(){g.forEach((function(e){n&&e(n)}))}),[n]),n?r.a.createElement(At.Provider,{value:{addNewRawDatas:function(e){u((function(t){return t.push(e),new j(t)}))},monthlyPowerSubstation:n,addUpdateCallback:function(e){b((function(t){return[].concat(Object(p.a)(t),[e])}))}}},e.children):r.a.createElement(r.a.Fragment,null)},kt=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=(Object(g.a)(e,["expandedPanel","onPanelChange"]),Object(o.useState)(new Map)),i=Object(m.a)(n,2),l=i[0],c=i[1],s=Object(o.useContext)(At);function u(){return(u=Object(X.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){c((function(t){if(t.has(e.name))return t;var a=new Map(t);return a.set(e.name,e),a}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){s.addNewRawDatas(e)}function h(e){c((function(t){var a=new Map(t);return a.delete(e.name),a}))}return r.a.createElement(oe,{onPanelChange:a,title:"Power Substation Files",panelName:"ps_panel",expandedPanel:t},r.a.createElement(Ye,{onDragEnter:function(){},onDragLeave:function(){},onFileDrop:function(e){return u.apply(this,arguments)},helperText:"Drop files here"},Object(p.a)(l.values()).map((function(e){return r.a.createElement(wt,{onFileParsed:d,onRemoveFile:h,key:e.name,file:e,render:function(e){return r.a.createElement(fe,{progress:e.progress,progressInfo:e.progressInfo,file:e.file,errors:e.errors,onRemoveFile:e.onRemoveFile})}})}))))},Mt=function(e){var t=e.open,a=(Object(g.a)(e,["open"]),z()),n=Object(o.useState)("laodprofile_filespanel"),i=Object(m.a)(n,2),l=i[0],c=i[1];function s(e){c(e)}return r.a.createElement(G.a,{variant:"persistent",open:t,anchor:"left",className:a.drawer,classes:{paper:a.drawerPaper}},r.a.createElement(We,{onPanelChange:s,expandedPanel:l}),r.a.createElement(rt,{onPanelChange:s,expandedPanel:l}),r.a.createElement(kt,{onPanelChange:s,expandedPanel:l}))},jt=a(221),It=Object(u.a)((function(e){return{root:{background:e.palette.background.paper,padding:e.spacing(3),fontSize:"1rem",display:"flex",flexDirection:"column",zIndex:e.zIndex.mobileStepper,position:"absolute",top:0,left:0,height:"100%",width:"100%",minHeight:0},title_div:{borderBottom:"1px solid ".concat(e.palette.divider)},title:{marginTop:e.spacing(5),fontSize:"1.3em"},tabs:{display:"inline-block"},content:{marginTop:e.spacing(5),display:"flex",flexGrow:1,overflow:"auto"},tab_panel:{flexGrow:1}}})),Nt=Object(u.a)((function(e){return Object(Z.a)({root:{height:"100%",display:"flex",flexDirection:"column"},textFieldContainer:{display:"flex",flexDirection:"column",gap:"10px",width:"300px",fontSize:"0.9rem"},actionContainer:{marginTop:10}})})),Dt=function(e){var t=e.onSubmit,a=e.children,n=(Object(g.a)(e,["onSubmit","children"]),Nt());return r.a.createElement("div",{className:n.root},r.a.createElement("form",{id:"settings-form",className:n.textFieldContainer,onSubmit:function(e){e.preventDefault(),t(e)}},a),r.a.createElement("div",{className:n.actionContainer},r.a.createElement(ie.a,{form:"settings-form",type:"submit",color:"primary"},"Save")))},Tt=a(228),Rt=Object(u.a)((function(e){return{root:{fontSize:"1em",border:"1px solid ".concat(e.palette.divider),borderRadius:e.shape.borderRadius,backgroundColor:e.palette.background.paper,"&.Mui-focused":{backgroundColor:e.palette.background.default,border:"1px solid ".concat(e.palette.primary.main)},"&:hover":{backgroundColor:e.palette.background.default},focused:{}}}})),Ft=function(e){var t=e.label,a=e.value,n=void 0===a?"":a,o=e.name,i=void 0===o?"":o,l=e.placeholder,c=void 0===l?"":l,s=e.helpertext,u=void 0===s?"":s,d=e.error,h=void 0!==d&&d,f=e.type,m=void 0===f?"text":f,g=e.onChange,p=void 0===g?function(e){}:g,b=(e.limitZero,Rt());return r.a.createElement(Tt.a,{variant:"filled",label:t,value:n,name:i,placeholder:c,error:h,helperText:u,type:m,InputProps:{disableUnderline:!0,classes:{root:b.root}},margin:"dense",onChange:function(e){"number"===m&&Number(e.target.value)<0||p(e)}})},Lt=function(e){Object.assign({},e);var t=Object(o.useState)(0),a=Object(m.a)(t,2),n=a[0],i=a[1],l=Object(o.useState)(0),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(0),h=Object(m.a)(d,2),f=h[0],g=h[1],p=Object(o.useState)(0),b=Object(m.a)(p,2),v=b[0],E=b[1],O=Object(o.useState)(""),y=Object(m.a)(O,2),w=y[0],P=y[1],S=Object(o.useState)(""),x=Object(m.a)(S,2),A=x[0],C=x[1];return Object(o.useEffect)((function(){var e=me.loadSettings();i(e.kwdelCol),u(e.kwhdelCol),P(e.dateFormat),g(e.dateCol),E(e.timeCol),C(e.timeFormat)}),[]),r.a.createElement(Dt,{onSubmit:function(e){me.saveSettings({kwdelCol:n,timeCol:v,dateCol:f,dateFormat:w,timeFormat:A,kwhdelCol:s}),alert("Load profile settings saved")}},r.a.createElement(Ft,{label:"Kwdel Column#",placeholder:"Kwdel Column#",value:n,type:"number",onChange:function(e){i(Number(e.target.value))},helpertext:"the column# of the kwdel value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Kwhdel Column#",placeholder:"Kwhdel Column#",value:s,type:"number",onChange:function(e){u(Number(e.target.value))},helpertext:"the column# of the kwhdel value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Date Column#",placeholder:"Date Column#",value:f,type:"number",onChange:function(e){g(Number(e.target.value))},helpertext:"the column# of the date value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Time Column#",placeholder:"Time Column#",value:v,type:"number",onChange:function(e){E(Number(e.target.value))},helpertext:"the column# of the time value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Date Format",placeholder:"Date Format",value:w,onChange:function(e){P(e.target.value)},helpertext:"(MM/DD/YYYY) = '09/22/2020', (MMMM/DD/YYYY) = 'September/22/2020'  "}),r.a.createElement(Ft,{label:"Time Format",placeholder:"Time Format",value:A,onChange:function(e){C(e.target.value)},helpertext:"(HH:mm) = '22:15', (hh:mm a) = '10:15 pm', (HH:mm:ss) = '22:15:13' "}))},_t=function(e){Object.assign({},e);var t=Object(o.useState)(0),a=Object(m.a)(t,2),n=a[0],i=a[1],l=Object(o.useState)(0),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(0),h=Object(m.a)(d,2),f=h[0],g=h[1],p=Object(o.useState)(""),b=Object(m.a)(p,2),v=b[0],E=b[1];return Object(o.useEffect)((function(){var e=Ze.loadSettings();i(e.durationCol),u(e.dateCol),g(e.feederCol),E(e.dateFormat)}),[]),r.a.createElement(Dt,{onSubmit:function(e){Ze.saveSettings({dateCol:s,durationCol:n,feederCol:f,dateFormat:v}),alert("Monthly Interruption Settings Saved")}},r.a.createElement(Ft,{label:"Feeder Column#",placeholder:"Feeder Column#",value:f,type:"number",onChange:function(e){g(Number(e.target.value))},helpertext:"the column# of the feeder value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Duration Column#",placeholder:"Duration Column#",value:n,type:"number",onChange:function(e){i(Number(e.target.value))},helpertext:"the column# of the duration value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Date Column#",placeholder:"Date Column#",value:s,type:"number",onChange:function(e){u(Number(e.target.value))},helpertext:"the column# of the date value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Date Format",placeholder:"Date Format",value:v,onChange:function(e){E(e.target.value)},helpertext:"(MM/DD/YYYY) = '09/22/2020', (MMMM/DD/YYYY) = 'September/22/2020'  "}))},Ht=a(207),Ut=Object(u.a)((function(e){return{tab:{textAlign:"start",textTransform:"none",fontWeight:"normal",fontSize:"0.9em",borderRight:"1px solid ".concat(e.palette.divider)},tab_selected:{backgroundColor:e.palette.background.default,color:e.palette.primary.main,fontWeight:"bold"},tab_wrapper:{justifyContent:"flex-start",alignItems:"flex-start"}}})),Vt=function(e){var t=e.label,a=e.value,n=Object(g.a)(e,["label","value"]),o=Ut();return r.a.createElement(Ht.a,Object.assign({classes:{root:o.tab,wrapper:o.tab_wrapper,selected:o.tab_selected},value:a,label:t},n))},Yt=Object(u.a)((function(e){return{tab:{textAlign:"start",textTransform:"none",fontWeight:"normal",fontSize:"0.9em",borderBottom:"1px solid ".concat(e.palette.divider),padding:0,minWidth:"100px",lineHeight:0},tab_selected:{backgroundColor:e.palette.background.default,color:e.palette.primary.main,fontWeight:"bold"},tab_wrapper:{}}})),Wt=function(e){var t=e.label,a=e.value,n=Object(g.a)(e,["label","value"]),o=Yt();return r.a.createElement(Ht.a,Object.assign({classes:{root:o.tab,wrapper:o.tab_wrapper,selected:o.tab_selected},value:a,label:t},n))},Bt=function(e){Object.assign({},e);var t=Object(o.useState)(0),a=Object(m.a)(t,2),n=a[0],i=a[1],l=Object(o.useState)(0),c=Object(m.a)(l,2),s=c[0],u=c[1],d=Object(o.useState)(0),h=Object(m.a)(d,2),f=h[0],g=h[1],p=Object(o.useState)(0),b=Object(m.a)(p,2),v=b[0],E=b[1];return Object(o.useEffect)((function(){var e=ct.loadSettings();i(e.demandKwhrCol),u(e.kwhrEnergyCol),g(e.feederCol),E(e.kvarhrEnergyCol)}),[]),r.a.createElement(Dt,{onSubmit:function(e){ct.saveSettings({kwhrEnergyCol:s,demandKwhrCol:n,feederCol:f,kvarhrEnergyCol:v}),alert("Power Substation Settings Saved")}},r.a.createElement(Ft,{label:"Kwhr Energy Column#",placeholder:"Kwhr Energy Column#",value:s,type:"number",onChange:function(e){u(Number(e.target.value))},helpertext:"the column# of the kwhr energy value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Demand Column#",placeholder:"Demand Column#",value:n,type:"number",onChange:function(e){i(Number(e.target.value))},helpertext:"the column# of the demand value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Kvarhr Energy Column#",placeholder:"Kvarhr Energy Column#",value:v,type:"number",onChange:function(e){E(Number(e.target.value))},helpertext:"the column# of the kvarhr value, note: column starts at 0"}),r.a.createElement(Ft,{label:"Feeder Column#",placeholder:"Feeder Column#",value:f,onChange:function(e){g(Number(e.target.value))},type:"number",helpertext:"the column# of the feeder value, note: column starts at 0 "}))};function Gt(e){var t=e.children,a=e.value,n=e.index,o=Object(g.a)(e,["children","value","index"]),i=It();return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"scrollable-prevent-tabpanel-".concat(n),"aria-labelledby":"scrollable-prevent-tab-".concat(n),className:i.tab_panel},o),a===n&&r.a.createElement(R.a,{p:3},t))}!function(e){e.LOADPROFILE_TAB="lp_tab",e.MONTHLYINTERRUPTION_TAB="mi_tab",e.POWERSUBSTATION_TAB="ps_tab"}(dt||(dt={}));var Kt=function(e){Object.assign({},e);var t=Object(o.useState)(dt.LOADPROFILE_TAB),a=Object(m.a)(t,2),n=a[0],i=a[1],l=It();return r.a.createElement("div",{className:l.root},r.a.createElement("div",{className:l.title_div},r.a.createElement(ee.a,{className:l.title},"Settings")),r.a.createElement("div",{className:l.content},r.a.createElement(jt.a,{className:l.tabs,orientation:"vertical",value:n,centered:!1,indicatorColor:"primary",onChange:function(e,t){i(t)}},r.a.createElement(Vt,{label:"Load Profile Settings",value:dt.LOADPROFILE_TAB}),r.a.createElement(Vt,{value:dt.MONTHLYINTERRUPTION_TAB,label:"Monthly Interruption Settings"}),r.a.createElement(Vt,{value:dt.POWERSUBSTATION_TAB,label:"Power Substation Settings"})),r.a.createElement(Gt,{value:n,index:dt.LOADPROFILE_TAB},r.a.createElement(Lt,null)),r.a.createElement(Gt,{value:n,index:dt.MONTHLYINTERRUPTION_TAB},r.a.createElement(_t,null)),r.a.createElement(Gt,{value:n,index:dt.POWERSUBSTATION_TAB},r.a.createElement(Bt,null))))},Zt=a(216),zt=a(210),Jt=a(211),$t=a(212),Xt=a(213),qt=a(209),Qt=a(208),ea=Object(u.a)((function(e){return Object(Z.a)({root:{paddingLeft:e.spacing(3),color:e.palette.text.primary,"&:hover > $content":{backgroundColor:e.palette.action.hover},"&:focus > $content, &$selected > $content":{color:e.palette.primary.main},"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label":{backgroundColor:"transparent"}},content:{color:e.palette.text.primary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:0,"& $content":{paddingLeft:e.spacing(2)}},expanded:{},selected:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",gap:"".concat(e.spacing(2),"px"),padding:e.spacing(.5,1)},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"normal",flexGrow:0}})}));var ta=function(e){var t=ea(),a=e.labelText,n=e.labelIcon,o=e.labelInfo,i=e.color,l=e.bgColor,c=Object(g.a)(e,["labelText","labelIcon","labelInfo","color","bgColor"]);return r.a.createElement(Qt.a,Object.assign({label:r.a.createElement("div",{className:t.labelRoot},r.a.createElement(n,{color:"inherit",className:t.labelIcon}),r.a.createElement(ee.a,{variant:"body2",className:t.labelText},a),r.a.createElement(ee.a,{variant:"caption",color:"inherit"},o)),style:{"--tree-view-color":i,"--tree-view-bg-color":l},classes:{root:t.root,content:t.content,expanded:t.expanded,selected:t.selected,group:t.group,label:t.label}},c))},aa=Object(u.a)((function(e){return Object(Z.a)({root:{flexShrink:0,fontSize:"1rem",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}})})),na=function(e){var t=e.monthlyLoadProfile,a=(Object(g.a)(e,["monthlyLoadProfile"]),aa());return r.a.createElement(qt.a,{className:a.root,defaultExpanded:["1"],defaultCollapseIcon:r.a.createElement(zt.a,null),defaultExpandIcon:r.a.createElement(Jt.a,null),defaultEndIcon:r.a.createElement("div",{style:{width:24}})},r.a.createElement(ta,{nodeId:"2",labelText:"Coincident Peak",labelIcon:$t.a,labelInfo:t.coincidentPeak?"".concat(t.coincidentPeak.meteringPoint,": ").concat(t.coincidentPeak.date.getMonth()+1,"/").concat(t.coincidentPeak.date.getDate(),"/").concat(t.coincidentPeak.date.getFullYear()," ").concat(t.coincidentPeak.hour,":00 kwdel: ").concat(t.coincidentPeak.kwdel.toFixed(2)):""}),r.a.createElement(ta,{nodeId:"3",labelText:"None Coincident Peak",labelIcon:Xt.a,labelInfo:t.nonCoincidentPeak?" ".concat(t.nonCoincidentPeak.toFixed(2)):""}),r.a.createElement(ta,{nodeId:"4",labelText:"Diversity Factor:",labelIcon:Xt.a,labelInfo:t.diversityFactor?" ".concat(t.diversityFactor.toFixed(2)):""}),r.a.createElement(ta,{nodeId:"5",labelText:"Max per metering point:",labelIcon:$t.a,labelInfo:""},t.loadProfilesMax.map((function(e){return r.a.createElement(ta,{key:"LM:S".concat(e.meteringPoint),nodeId:"LM:S".concat(e.meteringPoint),labelIcon:$t.a,labelText:"".concat(e.meteringPoint),labelInfo:" ".concat(e.date.getMonth()+1,"/").concat(e.date.getDate(),"/").concat(e.date.getFullYear()," ").concat(e.hour,":00 kwdel: ").concat(e.kwdel.toFixed(2))})}))),r.a.createElement(ta,{nodeId:"7",labelText:"Sum per metering point:",labelIcon:Xt.a,labelInfo:""},t.loadProfilesSum.map((function(e){return r.a.createElement(ta,{key:"LS:S".concat(e.meteringPoint),nodeId:"LS:S".concat(e.meteringPoint),labelIcon:Xt.a,labelText:"".concat(e.meteringPoint),labelInfo:" ".concat(e.kwhdel.toFixed(2))})}))))},oa=a(215),ra=a(214),ia=Object(u.a)((function(e){return Object(Z.a)({labelContent:{width:"120px",fontWeight:"normal",flexGrow:1}})}));var la=function(e){var t=ea(),a=ia(),n=e.color,i=e.bgColor,l=e.loadProfiles,c=e.dateString,s=void 0===c?"":c,u=e.hour,d=void 0===u?1:u,h=e.header,f=void 0!==h&&h,m=e.totalLoadProfile,p=Object(g.a)(e,["color","bgColor","loadProfiles","dateString","hour","header","totalLoadProfile"]);return Object(o.useEffect)((function(){console.log("HourTreeItemRendered: Hour: "+d)}),[]),r.a.createElement(Qt.a,Object.assign({label:r.a.createElement("div",{className:t.labelRoot},r.a.createElement(R.a,{minWidth:"35px"},f?r.a.createElement(ee.a,{variant:"body2",className:t.labelText},"Hour"):r.a.createElement(ee.a,{variant:"body2",className:t.labelText},d)),f?l.map((function(e){return r.a.createElement(ee.a,{key:"HTI: T: M:".concat(e.meteringPoint),variant:"body2",className:a.labelContent},e.meteringPoint)})):l.map((function(e){return r.a.createElement(ee.a,{key:"HTI: T: K:".concat(e.meteringPoint),variant:"body2",className:a.labelContent},e.getDailyLoadProfile(s).hourlyLoadProfiles[d-1].getTotalKwdel().toFixed(2))})),f?r.a.createElement(ee.a,{className:a.labelContent,variant:"caption",color:"inherit"},"Total "):r.a.createElement(ee.a,{className:a.labelContent,variant:"caption",color:"inherit"},m.getDailyLoadProfile(s).hourlyLoadProfiles[d-1].getRawTotal().toFixed(2))),style:{"--tree-view-color":n,"--tree-view-bg-color":i},classes:{root:t.root,content:t.content,expanded:t.expanded,selected:t.selected,group:t.group,label:t.label}},p))},ca=function(e){var t=e.loadProfiles,a=e.dateString,n=e.nodeId,i=e.totalLoadProfile,l=Object(o.useState)(new Date),c=Object(m.a)(l,2),s=c[0],u=c[1];return Object(o.useEffect)((function(){u(new Date(a))}),[a]),r.a.createElement(ta,{nodeId:n,labelText:"".concat(S[s.getMonth()]," ").concat(s.getDate()),labelIcon:ra.a},r.a.createElement(la,{nodeId:"DTI:D:".concat(a,"H"),dateString:a,header:!0,loadProfiles:t,totalLoadProfile:i}),Object(p.a)(Array(24).keys()).map((function(e){return r.a.createElement(la,{nodeId:"HTI: H:".concat(e),key:"HTI: H:".concat(e),hour:e+1,dateString:a,loadProfiles:t,totalLoadProfile:i})})))},sa=Object(u.a)((function(e){return Object(Z.a)({root:{flexShrink:0,fontSize:"1rem",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},title:{fontSize:"1.5em"},dayTree:{flexGrow:1,maxWidth:400}})})),ua=function(e){var t=e.monthlyLoadProfile,a=sa();return r.a.createElement(qt.a,{className:a.root,defaultExpanded:["1"],defaultCollapseIcon:r.a.createElement(zt.a,null),defaultExpandIcon:r.a.createElement(Jt.a,null),defaultEndIcon:r.a.createElement("div",{style:{width:24}})},r.a.createElement(ta,{nodeId:"1",labelText:"".concat(S[t.billingPeriod.month-1]," ").concat(t.billingPeriod.year),labelIcon:oa.a},Object(p.a)(t.dateStrings.values()).map((function(e){var a=Object(p.a)(Array.from(t.loadProfiles.values())),n="DTI:D:".concat(e);return r.a.createElement(ca,{totalLoadProfile:t.totalLoadpRofile,key:n,nodeId:n,loadProfiles:a,dateString:e})}))))};var da,ha=function(e){var t=pe.a.utils.book_new(),a="".concat(e.billingPeriod.toString()),n=function(e){var t=[],a=e.billingPeriod.startDate,n=e.billingPeriod.enddDate;console.log("start date: ".concat(a.toLocaleDateString()," endDate: ").concat(n.toLocaleDateString()));var o,r=["Date","Hour"],i=Object(f.a)(e.loadProfiles.values());try{for(i.s();!(o=i.n()).done;){var l=o.value;r.push(l.meteringPoint)}}catch(p){i.e(p)}finally{i.f()}r.push("Total"),t.push(r);for(;a<=n;){for(var c="".concat(a.getMonth()+1,"/").concat(a.getDate(),"/").concat(a.getFullYear()),s=0;s<24;s++){var u=[];u.push(c),u.push(s.toString());var d,h=Object(f.a)(e.loadProfiles.values());try{for(h.s();!(d=h.n()).done;){var m=d.value.dailyLoadProfiles.get(c)||new O(new Date(c));u.push(m.hourlyLoadProfiles[s].getTotalKwdel().toFixed(2))}}catch(p){h.e(p)}finally{h.f()}var g=e.totalLoadpRofile.dailyLoadProfiles.get(c)||new O(new Date(c));u.push(g.hourlyLoadProfiles[s].getRawTotal().toFixed(2)),console.log(u),t.push(u)}a.setDate(a.getDate()+1)}return console.log(t),t}(e),o=pe.a.utils.aoa_to_sheet(n);pe.a.utils.book_append_sheet(t,o,a),pe.a.writeFile(t,"Monthly LoadProfile Report of ".concat(e.billingPeriod.toString(),".xlsx"))},fa=Object(u.a)((function(e){return Object(Z.a)({monthlyCard_root:{display:"inline-flex",boxSizing:"border-box",flexWrap:"nowrap"},monthlyCard_paper:{flexGrow:0,flexShrink:0,display:"flex",flexDirection:"column",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),boxSizing:"border-box",padding:e.spacing(2)},monthlyCard_paperAction:{display:"flex",alignItems:"center",justifyContent:"flex-end"},monthlyCard_paperContent:{display:"flex",flexShrink:0},downloadBtn:{fontSize:"14px",textTransform:"none",fontWeight:"lighter"}})})),ma=function(e){var t=e.monthlyLoadProfile,a=fa();return r.a.createElement("div",{className:a.monthlyCard_root},r.a.createElement("div",{className:a.monthlyCard_paper},r.a.createElement("div",{className:a.monthlyCard_paperAction},r.a.createElement(ie.a,{onClick:function(){ha(t)},className:a.downloadBtn,size:"small",startIcon:r.a.createElement(Zt.a,null)},"download")),r.a.createElement("div",{className:a.monthlyCard_paperContent},r.a.createElement(ua,{monthlyLoadProfile:t}),r.a.createElement(na,{monthlyLoadProfile:t}))))},ga=a(19),pa=a(2),ba=a(49),va=a(115),Ea=Object(u.a)((function(e){return Object(Z.a)({graphContent:{padding:e.spacing(3)}})})),Oa=function(e){var t=e.monthlyLoadProfile,a=(Object(g.a)(e,["monthlyLoadProfile"]),Ea());return r.a.createElement(va.a,{className:a.graphContent},r.a.createElement(ba.b,{data:Object(p.a)(t.chartData.values())},r.a.createElement(ga.b,{factory:pa.zb}),r.a.createElement(ba.a,{showGrid:!0}),r.a.createElement(ba.f,{showGrid:!0}),Object(p.a)(t.loadProfiles.values()).map((function(e){return r.a.createElement(ba.d,{valueField:e.meteringPoint,argumentField:"date",name:e.meteringPoint})})),r.a.createElement(ga.i,null),r.a.createElement(ba.c,null),r.a.createElement(ba.e,{text:"Billing Period: ".concat(t.billingPeriod.toString())})))};function ya(e){e.monthlyLoadpRofile;var t=e.value,a=e.index,n=e.children,o=Pa();return t===a?r.a.createElement("div",{className:o.loadProfileContent_tabPanel},n):r.a.createElement(r.a.Fragment,null)}!function(e){e.DATA="data",e.GRAPH="graph",e.NONE=""}(da||(da={}));var wa,Pa=Object(u.a)((function(e){return Object(Z.a)({loadProfileContent_root:{height:"100%",display:"flex",flexDirection:"column"},loadProfileContent_tabPanel:{flex:1,padding:e.spacing(3)}})})),Sa=function(e){var t=e.monthlyLoadProfile,a=e.index,n=e.value,i=Object(o.useState)(da.DATA),l=Object(m.a)(i,2),c=l[0],s=l[1],u=Pa();return a===n?r.a.createElement("div",{className:u.loadProfileContent_root},r.a.createElement("div",null,r.a.createElement(jt.a,{onChange:function(e,t){s(t)},indicatorColor:"primary",value:c},r.a.createElement(Wt,{label:"Data",value:da.DATA}),r.a.createElement(Wt,{label:"Graph",value:da.GRAPH}))),r.a.createElement(ya,{index:da.DATA,value:c,monthlyLoadpRofile:t},r.a.createElement(ma,{monthlyLoadProfile:t})),r.a.createElement(ya,{index:da.GRAPH,value:c,monthlyLoadpRofile:t},r.a.createElement(Oa,{monthlyLoadProfile:t}))):r.a.createElement(r.a.Fragment,null)},xa=Object(u.a)((function(e){return{loadProfileContent_root:{height:"100%",display:"flex",flexDirection:"column",minHeight:"0px",minWidth:"0px"},loadProfileContent_Header:{display:"flex",alignItems:"flex-end"},loadProfileContent_Title:{marginRight:e.spacing(1),paddingRight:e.spacing(3),textAlign:"center"},loadProfileContent_contentWrapper:{flex:1,overflow:"auto",display:"flex",flexWrap:"nowrap"},loadProfileContent_content:{flex:1}}})),Aa=function(e){Object.assign({},e);var t=xa(),a=Object(o.useState)(""),n=Object(m.a)(a,2),i=n[0],l=n[1],c=Object(o.useContext)(I);return r.a.createElement("div",{className:t.loadProfileContent_root},r.a.createElement("div",{className:t.loadProfileContent_Header},r.a.createElement(ee.a,{className:t.loadProfileContent_Title,variant:"h5"},"Load Profile"),r.a.createElement(jt.a,{onChange:function(e,t){l(t)},indicatorColor:"primary",value:i},Object(p.a)(c.monthlyLoadProfiles.values()).map((function(e){return r.a.createElement(Wt,{label:e.billingPeriod.toString(),value:e.billingPeriod.toString(),key:"T: ".concat(e.billingPeriod.toString())})})))),r.a.createElement("div",{className:t.loadProfileContent_contentWrapper},r.a.createElement("div",{className:t.loadProfileContent_content},Object(p.a)(c.monthlyLoadProfiles.values()).map((function(e){return r.a.createElement(Sa,{key:"C: ".concat(e.billingPeriod.toString()),monthlyLoadProfile:e,value:i,index:e.billingPeriod.toString()})})))))};!function(e){e.LOAD_PROFILE="lp",e.SUBSTATION_LOSS="ssl",e.FEEDERDEMAND_OUTAGED="fdo",e.POWER_BILL="pbl",e.POWER_SUBSTATION="psb"}(wa||(wa={}));var Ca=Object(u.a)((function(e){return{maincontent_root:{height:"100%",display:"flex"},tabs_container:{marginTop:e.spacing(12),maxWidth:"300px",flexGrow:0},tabs:{display:"inline-block"},mainContent_content:{flex:1,width:0}}})),ka=function(e){Object.assign({},e);var t=Ca(),a=Object(o.useState)(wa.LOAD_PROFILE),n=Object(m.a)(a,2),i=n[0],l=n[1];return r.a.createElement("div",{className:t.maincontent_root},r.a.createElement("div",{className:t.tabs_container},r.a.createElement(jt.a,{className:t.tabs,orientation:"vertical",value:i,centered:!1,indicatorColor:"primary",onChange:function(e,t){l(t)}},r.a.createElement(Vt,{label:"Load Profile",value:wa.LOAD_PROFILE}),r.a.createElement(Vt,{label:"Power Bill",value:wa.POWER_BILL}),r.a.createElement(Vt,{label:"Feeder Demand and Outages",value:wa.FEEDERDEMAND_OUTAGED}),r.a.createElement(Vt,{label:"Substation Loss",value:wa.SUBSTATION_LOSS}),r.a.createElement(Vt,{label:"Power Substation",value:wa.POWER_SUBSTATION}))),r.a.createElement("div",{className:t.mainContent_content},i===wa.LOAD_PROFILE&&r.a.createElement(Aa,null)))},Ma=Object(u.a)((function(e){return{dashboard_root:{display:"flex",height:"100%"},dashboard_content:{flex:1,position:"relative",minHeight:"0px",width:0}}})),ja=function(e){var t=Ma(),a=z(),n=Object(o.useState)(!0),i=Object(m.a)(n,2),l=i[0],c=i[1],s=Object(o.useState)(!1),u=Object(m.a)(s,2),d=u[0],h=u[1];return r.a.createElement("div",{className:t.dashboard_root},r.a.createElement(B,{onSettingsToggled:function(){h(!0)},onSettingsUntoggled:function(){h(!1)},onFilesToggled:function(){c(!0)},onFilesUntoggled:function(){c(!1)}}),r.a.createElement(Mt,{open:l}),r.a.createElement("div",{className:Object(He.a)(t.dashboard_content,a.content,Object(D.a)({},a.contentShift,l))},d&&r.a.createElement(Kt,null),r.a.createElement(ka,null)))},Ia=function(){function e(t,a){Object(b.a)(this,e),this.feeder=void 0,this.feederInput=void 0,this.demand=void 0,this.minutes=void 0,this.hours=void 0,this.operatingHours=void 0,this.powerFactor=void 0,this.loadFactor=void 0,this.kvarhrEnergy=void 0,this.totalOperatingHours=void 0,this.feeder=t,this.feederInput=0,this.demand=0,this.minutes=0,this.hours=0,this.operatingHours=0,this.powerFactor=0,this.loadFactor=0,this.kvarhrEnergy=0,this.totalOperatingHours=a}return Object(v.a)(e,[{key:"setMonthlyInterruptionData",value:function(e){this.minutes=e.duration,this.hours=this.minutes/60,console.log("setMonthlyInterruptionData(), feeder: ".concat(this.feeder," minutes: ").concat(this.minutes," hours: ").concat(this.hours))}},{key:"setPowerSubstationData",value:function(e){this.demand=e.demandKwhr,this.feederInput=e.kwhrEnergy,this.kvarhrEnergy=e.kvarhrEnergy,console.log("setMonthlyInterruptionData() feeder: ".concat(this.feeder,",setting new demand: ").concat(this.demand," feederInput: ").concat(this.feederInput," kvarhrEnergy: ").concat(this.kvarhrEnergy))}},{key:"recalculateData",value:function(){this.operatingHours=this.totalOperatingHours-this.hours,this.powerFactor=100*Math.cos(Math.atan(this.kvarhrEnergy/this.feederInput)),this.loadFactor=this.feederInput/this.operatingHours/this.demand}}]),e}(),Na=function(){function e(t){Object(b.a)(this,e),this.billingPeriod=void 0,this.items=void 0,this.totalOperatingHours=void 0,this.billingPeriod=t,this.items=new Map,this.totalOperatingHours=24*t.getTotalDays(),console.log("FeederAndDemand Created")}return Object(v.a)(e,[{key:"addMonthlyInterruptionData",value:function(e){var t,a=e.feeder;this.items.has(a)||(console.log("addMonthlyInterruptionData(), adding new item, feeder:"+a),this.items.set(a,new Ia(e.feeder,this.totalOperatingHours))),null===(t=this.items.get(a))||void 0===t||t.setMonthlyInterruptionData(e)}},{key:"addPowerSubstationData",value:function(e){var t,a=e.feeder;this.items.has(a)||(console.log("addPowerSubstationData(), adding new item, feeder:"+a),this.items.set(a,new Ia(e.feeder,this.totalOperatingHours))),null===(t=this.items.get(a))||void 0===t||t.setPowerSubstationData(e)}}]),e}(),Da=function(){function e(t){Object(b.a)(this,e),this.feederAndDemands=void 0,this.feederAndDemands=t?new Map(t.feederAndDemands):new Map,console.trace("Monthly feeder and demand created")}return Object(v.a)(e,[{key:"addMonthlyInterruptionData",value:function(e,t){var a,n=t.toString();this.feederAndDemands.has(n)||(console.log("addMonthlyInterruptionData(), adding new feeder and demand, billing period: "+t.toString()),this.feederAndDemands.set(n,new Na(t))),null===(a=this.feederAndDemands.get(n))||void 0===a||a.addMonthlyInterruptionData(e)}},{key:"addPowerSubstationData",value:function(e,t){var a,n=t.toString();this.feederAndDemands.has(n)||(console.log("addPowerSubstationData(), adding new feeder and demand, billing period: "+t.toString()),this.feederAndDemands.set(n,new Na(t))),null===(a=this.feederAndDemands.get(n))||void 0===a||a.addPowerSubstationData(e)}},{key:"initValues",value:function(){var e,t=Object(f.a)(this.feederAndDemands.values());try{for(t.s();!(e=t.n()).done;){var a,n=e.value,o=Object(f.a)(n.items.values());try{for(o.s();!(a=o.n()).done;){a.value.recalculateData()}}catch(r){o.e(r)}finally{o.f()}}}catch(r){t.e(r)}finally{t.f()}}}]),e}(),Ta=Object(o.createContext)({}),Ra=function(e){var t=Object(o.useContext)(At),a=Object(o.useContext)(nt),n=Object(o.useState)([]),i=Object(m.a)(n,2),l=i[0],c=i[1],s=Object(o.useState)(),u=Object(m.a)(s,2),d=u[0],h=u[1];function g(e,t){return new Promise((function(a,n){console.log({message:"Monthly Feeder And Demand to be updated: ",mfd:t});var o,r=Object(f.a)(e.powerSubstations.values());try{for(r.s();!(o=r.n()).done;){var i,l=o.value,c=l.billingPeriod,s=Object(f.a)(l.items.values());try{for(s.s();!(i=s.n()).done;){var u=i.value;t.addPowerSubstationData(u,c)}}catch(d){s.e(d)}finally{s.f()}}}catch(d){r.e(d)}finally{r.f()}a(t)}))}function b(e,t){return new Promise((function(a,n){console.log({message:"Monthly Feeder And Demand to be updated: ",mfd:t});var o,r=Object(f.a)(e.monthlyInterruptions.values());try{for(r.s();!(o=r.n()).done;){var i,l=o.value,c=l.billingPeriod,s=Object(f.a)(l.items.values());try{for(s.s();!(i=s.n()).done;){var u=i.value;t.addMonthlyInterruptionData(u,c)}}catch(d){s.e(d)}finally{s.f()}}}catch(d){r.e(d)}finally{r.f()}a(t)}))}function v(e){console.log("MonthlyPowerSubstationData Updated..."),c((function(t){return[].concat(Object(p.a)(t),[e])}))}function E(e){console.log("MonthlyPower Interruption data Updated..."),c((function(t){return[].concat(Object(p.a)(t),[e])}))}return Object(o.useEffect)((function(){t.addUpdateCallback(v),a.addUpdateCallback(E),h(new Da)}),[]),Object(o.useEffect)((function(){console.log(d)}),[d]),Object(o.useEffect)((function(){function e(){return(e=Object(X.a)($.a.mark((function e(){var t,a,n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Updating monthly feeder and demand"),t=Object(p.a)(l),a=t.pop(),console.log({data:a}),!a){e.next=19;break}if(n=new Da(d),!a.powerSubstations){e.next=13;break}return console.log("Adding Monthly Power Substation Data..."),e.next=10,g(a,n);case 10:n=e.sent,e.next=17;break;case 13:return console.log("Adding Monthly MOnthly interruption Data..."),e.next=16,b(a,n);case 16:n=e.sent;case 17:h(n),c(Object(p.a)(t));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(console.log("Checking if buffer is not empty..."),l.length<=0){var t=new Da(d);t.initValues(),h(t)}else!function(){e.apply(this,arguments)}()}),[l]),r.a.createElement(Ta.Provider,{value:{}},e.children)},Fa=Object(u.a)((function(e){return{root:{height:"100vh",backgroundColor:e.palette.background.default}}})),La=function(e){var t=Fa();return r.a.createElement(c.a,{theme:h},r.a.createElement(s.a,null,r.a.createElement(N,null,r.a.createElement(ot,null,r.a.createElement(Ct,null,r.a.createElement(Ra,null,r.a.createElement("div",{className:Object(He.a)(t.root)},r.a.createElement(ja,null))))))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(La,null))),document.getElementById("root"))}},[[133,1,2]]]);
//# sourceMappingURL=main.a0ecb370.chunk.js.map