(this["webpackJsonpexcel-parser"]=this["webpackJsonpexcel-parser"]||[]).push([[0],{107:function(e,t,a){e.exports=a(125)},112:function(e,t,a){},123:function(e,t){},124:function(e,t){},125:function(e,t,a){"use strict";a.r(t);var n,o=a(0),r=a.n(o),i=a(13),l=a.n(i),c=(a(112),a(179)),s=a(180),d=a(157),u=a(87),m=Object(u.a)({palette:{primary:{main:"#45aaf2",dark:"#2d98da",contrastText:"white"},secondary:{main:"#fc5c65",dark:"#eb3b5a",contrastText:"white"},text:{primary:"#778ca3",secondary:"#B4BEC8"},background:{default:"#F5F7F9"}}}),f=a(18),h=a(7),p=a(10),g=a(20),b=a(15),v=a(16),E=function(){function e(t){Object(b.a)(this,e),this.hour=void 0,this.kwdelSet=void 0,this.hour=t,this.kwdelSet=[]}return Object(v.a)(e,[{key:"addKwdel",value:function(e,t){this.kwdelSet.push({fileName:t,kwdel:e})}},{key:"removeKwdel",value:function(e){this.kwdelSet=this.kwdelSet.filter((function(t){return t.fileName!==e}))}},{key:"getTotalKwdel",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwdel}}catch(n){a.e(n)}finally{a.f()}return t/this.kwdelSet.length}},{key:"getRawTotal",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwdel}}catch(n){a.e(n)}finally{a.f()}return t}}]),e}(),A=function(){function e(t){Object(b.a)(this,e),this.date=void 0,this.hourlyLoadProfiles=void 0,this.date=t,this.hourlyLoadProfiles=this.buildHourlyLoadProfiles()}return Object(v.a)(e,[{key:"buildHourlyLoadProfiles",value:function(){return Object(g.a)(Array(24).keys()).map((function(e){return new E(e)}))}},{key:"addLoadProfileData",value:function(e){this.hourlyLoadProfiles[e.hour].addKwdel(e.kwdel,e.fileName)}},{key:"removeLoadProfileData",value:function(e){this.hourlyLoadProfiles.forEach((function(t){t.removeKwdel(e)}))}},{key:"getMaxAndSum",value:function(){var e,t=0,a=1,n=0,o=Object(f.a)(this.hourlyLoadProfiles);try{for(o.s();!(e=o.n()).done;){var r=e.value,i=r.getTotalKwdel();n+=i,i>t&&(a=r.hour,t=i)}}catch(l){o.e(l)}finally{o.f()}return{max:{kwdel:t,hour:a,meteringPoint:"",date:new Date},sum:{kwdel:n,meteringPoint:""}}}}]),e}(),P=a(45),O=a.n(P),N=function(){function e(t,a){Object(b.a)(this,e),this.month=void 0,this.year=void 0,this.startDate=void 0,this.enddDate=void 0,this.month=t,this.year=a,this.startDate=this.getStartDate(),this.enddDate=this.getEndDate()}return Object(v.a)(e,[{key:"getStartDate",value:function(){var e=1===this.month?12:this.month-1,t=1===this.month?this.year-1:this.year;return O()("".concat(e,"/26/").concat(t),"MM/DD/YYYY").toDate()}},{key:"getEndDate",value:function(){return O()("".concat(this.month,"/25/").concat(this.year),"MM/DD/YYYY").toDate()}},{key:"equalsTo",value:function(e){return null!==this.month&&null!=e&&null!==e.month&&(this.month===e.month&&this.year===e.year)}}]),e}(),I=function(){function e(t,a,n,o,r,i,l,c){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"";if(Object(b.a)(this,e),this.kwdel=void 0,this.hour=void 0,this.day=void 0,this.month=void 0,this.year=void 0,this.minute=void 0,this.meteringPoint=void 0,this.row=void 0,this.billingPeriod=void 0,this.fileName=void 0,this.kwdel=t,this.day=a,this.hour=r,this.month=n,this.year=o,this.minute=i,this.meteringPoint=l,this.row=c,this.fileName=s,0===this.hour&&0===this.minute)if(this.hour=23,this.minute=59,this.day-1<=0){var d=new Date("".concat(this.year,"/").concat(this.month,"/").concat(this.day));d.setDate(d.getDate()-1),this.day=d.getDate(),this.month=d.getMonth()+1,this.year=d.getFullYear()}else this.day--;var u=this.getBillingMonth({month:this.month,day:this.day,hour:this.hour,minute:this.minute});this.billingPeriod=new N(u,this.year),0===this.minute&&(this.hour--,this.hour<0&&(this.hour=23))}return Object(v.a)(e,[{key:"getBillingMonth",value:function(e){var t=e.month,a=e.day,n=e.minute,o=e.hour,r=t;return a>=26&&(0===o&&0===n&&26===a||0===(r=++r%12)&&(r=12)),r}}]),e}(),y=function(){function e(t){Object(b.a)(this,e),this.meteringPoint=void 0,this.dailyLoadProfiles=void 0,this.max=void 0,this.sum=void 0,this.meteringPoint=t,this.dailyLoadProfiles=new Map,this.max={kwdel:0,hour:1,meteringPoint:"",date:new Date},this.sum={kwdel:0,meteringPoint:""}}return Object(v.a)(e,[{key:"addLoadProfileData",value:function(e,t){var a;this.dailyLoadProfiles.has(t)||this.dailyLoadProfiles.set(t,new A(new Date(t))),null===(a=this.dailyLoadProfiles.get(t))||void 0===a||a.addLoadProfileData(e)}},{key:"removeLoadPRofileData",value:function(e){this.dailyLoadProfiles.forEach((function(t){t.removeLoadProfileData(e)}))}},{key:"getDailyLoadProfile",value:function(e){return this.dailyLoadProfiles.has(e)?this.dailyLoadProfiles.get(e):new A(new Date(e))}},{key:"getMaxAndSum",value:function(){var e,t=0,a=0,n=1,o=new Date,r=Object(f.a)(this.dailyLoadProfiles.values());try{for(r.s();!(e=r.n()).done;){var i=e.value,l=i.getMaxAndSum(),c=l.max,s=l.sum;c.kwdel>t&&(t=c.kwdel,n=c.hour,o=i.date,a+=s.kwdel)}}catch(d){r.e(d)}finally{r.f()}return this.max={kwdel:t,hour:n,date:o,meteringPoint:this.meteringPoint},this.sum={kwdel:a,meteringPoint:this.meteringPoint},{max:this.max,sum:this.sum}}}]),e}();!function(e){e[e.TETUAN=0]="TETUAN",e[e.MERCEDES=1]="MERCEDES",e[e.NORTHSIDE=2]="NORTHSIDE",e[e.ZAMPEN=3]="ZAMPEN",e[e.GUIWAN=4]="GUIWAN",e[e.TUMAGA=5]="TUMAGA",e[e.ARENA_BLANCO=6]="ARENA_BLANCO",e[e.PRESA=7]="PRESA",e[e.SAN_JOSE=8]="SAN_JOSE",e[e.CALARIAN=9]="CALARIAN",e[e.BALIWASAN=10]="BALIWASAN",e[e.DEDICATED_LINE=11]="DEDICATED_LINE",e[e.INTERCO=12]="INTERCO",e[e.CULIANAN=13]="CULIANAN",e[e.CURUAN=14]="CURUAN",e[e.FISHING_PORT=15]="FISHING_PORT",e[e.TALISAYAN=16]="TALISAYAN",e[e.LABUAN=17]="LABUAN",e[e.RECODO=18]="RECODO",e[e.SINUNUC=19]="SINUNUC",e[e.BIG_FISH=20]="BIG_FISH",e[e.TIN_CAN_ORIENTAL=21]="TIN_CAN_ORIENTAL",e[e.MEGA_FISHIN_CORP=22]="MEGA_FISHIN_CORP",e[e.MEGA_FISHIN_CORP2=23]="MEGA_FISHIN_CORP2",e[e.PASONANCA=24]="PASONANCA",e[e.SAN_ROQUE=25]="SAN_ROQUE",e[e.ACLEM=26]="ACLEM",e[e.GOVERNOR_ALVAREZ=27]="GOVERNOR_ALVAREZ",e[e.VETERANS_AVENUE=28]="VETERANS_AVENUE",e[e.NUNEZ=29]="NUNEZ",e[e.STA_CATALINA=30]="STA_CATALINA",e[e.RIO_HONDO=31]="RIO_HONDO",e[e.GUARDIA_NACIONAL=32]="GUARDIA_NACIONAL",e[e.CAMPANER=33]="CAMPANER",e[e.KCC_MALL=34]="KCC_MALL"}(n||(n={}));var M=n,S=function(){function e(t,a,n,o){Object(b.a)(this,e),this.key=void 0,this.text=void 0,this.serialNumber=void 0,this.power=void 0,this.key=t,this.text=a,this.serialNumber=n,this.power=o}return Object(v.a)(e,[{key:"toString",value:function(){return this.key}}]),e}();S.HYOSUNG_20MVA=new S("HYOSUNG_20MVA","HYOSUNG PTX - 20MVA","TP99-8513",20),S.SHIHLIN_20MVA=new S("SHIHLIN_20MVA","SHIHLIN PTX - 20MVA","810014",20),S.SHIHLIN_10MVVA=new S("SHIHLIN_10MVVA ","SHIHLIN PTX - 10MVA","T990113",10),S.SHIHLIN_5MVA=new S("SHIHLIN_5MVA","SHIHLIN PTX - 5MVA","",5),S.NANJING_20MVA=new S("NANJING_20MVA","NANJING PTX - 20MVA","610205",20),S.PRIME_MEIDEN_10MVA=new S("PRIME_MEIDEN_10MVA","PRIME MEIDEN PTX - 10MVA","",10),S.NEW_KOREA_10MVA=new S("NEW_KOREA_10MVA","NEW KOREA PTX - 10MVA","W910009",10),S.NEW_KOREA_5MVA=new S("NEW_KOREA_5MVA","NEW KOREA PTX - 5MVA","920194",5),S.CHANGZHOU_10MVA=new S("CHANGZHOU_10MVA","CHANGZHOU PTX - 10MVA","91-61-146",10),S.SHENDA_25MVA=new S("SHENDA_25MVA","SHENDA PTX - 25MVA","",25);var x=S,C=function e(t,a){Object(b.a)(this,e),this.transformer=void 0,this.feeders=void 0,this.transformer=t,this.feeders=a},w=function(){function e(t,a,n){Object(b.a)(this,e),this.key=void 0,this.text=void 0,this.substationItems=void 0,this.key=t,this.text=a,this.substationItems=n}return Object(v.a)(e,[{key:"toStrting",value:function(){return this.key}}]),e}();w.PUTIK=new w("PUTIK","PUTIK S/S",[new C(x.SHIHLIN_10MVVA,[M.GUIWAN,M.TUMAGA,M.ARENA_BLANCO,M.PRESA]),new C(x.HYOSUNG_20MVA,[M.TETUAN,M.MERCEDES,M.NORTHSIDE,M.ZAMPEN])]),w.SANJOSE_GUSU=new w("SAN JOSE GUSU","SAN JOSE GUSU S/S",[new C(x.NANJING_20MVA,[M.SAN_JOSE,M.CALARIAN,M.BALIWASAN,M.DEDICATED_LINE]),new C(x.NEW_KOREA_10MVA,[])]),w.SANGALI=new w("SANGALI","SANGALI S/S",[new C(x.PRIME_MEIDEN_10MVA,[M.CULIANAN,M.CURUAN,M.FISHING_PORT])]),w.AYALA=new w("AYALA","AYALA S/S",[new C(x.SHIHLIN_10MVVA,[M.TALISAYAN,M.LABUAN])]),w.RECODO=new w("RECODO","RECODO S/S",[new C(x.NEW_KOREA_10MVA,[M.RECODO]),new C(x.NEW_KOREA_5MVA,[M.SINUNUC]),new C(x.SHIHLIN_5MVA,[])]),w.CABATANGAN=new w("CABATANGAN","CABATANGAN S/S",[new C(x.CHANGZHOU_10MVA,[M.PASONANCA]),new C(x.PRIME_MEIDEN_10MVA,[M.SAN_ROQUE])]),w.CAMANCHILI=new w("CAMANCHILI","CAMANCHILI S/S",[new C(x.SHIHLIN_20MVA,[M.ACLEM,M.GOVERNOR_ALVAREZ,M.VETERANS_AVENUE,M.NUNEZ]),new C(x.SHENDA_25MVA,[M.STA_CATALINA,M.RIO_HONDO,M.GUARDIA_NACIONAL,M.CAMPANER])]);var T=w,k=function(){function e(t,a){Object(b.a)(this,e),this.key=void 0,this.substations=void 0,this.key=t,this.substations=a}return Object(v.a)(e,[{key:"toString",value:function(){return this.key}},{key:"getFeeders",value:function(){var e,t=[],a=Object(f.a)(this.substations);try{for(a.s();!(e=a.n()).done;){var n,o=e.value,r=Object(f.a)(o.substationItems);try{for(r.s();!(n=r.n()).done;){var i=n.value;t=[].concat(Object(g.a)(t),Object(g.a)(i.feeders))}}catch(l){r.e(l)}finally{r.f()}}}catch(l){a.e(l)}finally{a.f()}return t}}],[{key:"getMeteringPoint",value:function(e){switch(e.toUpperCase()){case this.MF3MPITZAMC01.key:return this.MF3MPITZAMC01;case this.MF3MPITZAMC02.key:return this.MF3MPITZAMC02;case this.MF3MPITZAMC03.key:return this.MF3MPITZAMC03;case this.MF3MPITZAMC04.key:return this.MF3MPITZAMC04;case this.MF3MPITZAMC05.key:return this.MF3MPITZAMC05;case this.MF3MPITZAMC06.key:return this.MF3MPITZAMC06;case this.MF3MPITZAMC07.key:return this.MF3MPITZAMC07;default:return null}}},{key:"exists",value:function(e){switch(e){case this.MF3MPITZAMC01.key:case this.MF3MPITZAMC02.key:case this.MF3MPITZAMC03.key:case this.MF3MPITZAMC04.key:case this.MF3MPITZAMC05.key:case this.MF3MPITZAMC06.key:case this.MF3MPITZAMC07.key:return!0;default:return!1}}}]),e}();k.MF3MPITZAMC01=new k("MF3MPITZAMC01",[T.PUTIK]),k.MF3MPITZAMC02=new k("MF3MPITZAMC02",[T.SANJOSE_GUSU]),k.MF3MPITZAMC03=new k("MF3MPITZAMC03",[T.SANGALI]),k.MF3MPITZAMC04=new k("MF3MPITZAMC04",[T.RECODO,T.AYALA]),k.MF3MPITZAMC05=new k("MF3MPITZAMC05",[T.CABATANGAN]),k.MF3MPITZAMC06=new k("MF3MPITZAMC06",[]),k.MF3MPITZAMC07=new k("MF3MPITZAMC07",[T.CAMANCHILI]);var j,L=k,R=function(){function e(t){Object(b.a)(this,e),this.loadProfiles=void 0,this.billingPeriod=void 0,this.dateStrings=void 0,this.coincidentPeak=void 0,this.nonCoincidentPeak=void 0,this.diversityFactor=void 0,this.loadProfilesMax=void 0,this.loadProfilesSum=void 0,this.totalLoadpRofile=void 0,this.billingPeriod=t,this.loadProfiles=new Map,this.dateStrings=new Set,this.totalLoadpRofile=new y("Total"),this.coincidentPeak=null,this.nonCoincidentPeak=null,this.diversityFactor=null,this.loadProfilesMax=[],this.loadProfilesSum=[]}return Object(v.a)(e,[{key:"addData",value:function(e){var t,a=e.meteringPoint,n="".concat(e.month,"/").concat(e.day,"/").concat(e.year);this.dateStrings.has(n)||this.dateStrings.add(n),this.loadProfiles.has(a)||this.loadProfiles.set(a,new y(a)),null===(t=this.loadProfiles.get(a))||void 0===t||t.addLoadProfileData(e,n)}},{key:"removeData",value:function(e,t){var a=this;t.forEach((function(t){if(a.loadProfiles.has(t)){var n=a.loadProfiles.get(t);null===n||void 0===n||n.removeLoadPRofileData(e)}}))}},{key:"initOtherDetails",value:function(){var e=0,t=L.MF3MPITZAMC01.toString(),a=new Date,n=0,o=0;this.loadProfilesMax=[],this.loadProfilesSum=[],this.totalLoadpRofile=new y("Total");var r,i=Object(f.a)(this.loadProfiles.values());try{for(i.s();!(r=i.n()).done;){for(var l=r.value,c=0,s=Object(g.a)(l.dailyLoadProfiles.values());c<s.length;c++){var d,u=s[c],m=Object(f.a)(u.hourlyLoadProfiles);try{for(m.s();!(d=m.n()).done;){var h=d.value,p=new I(h.getTotalKwdel(),u.date.getDate(),u.date.getMonth()+1,u.date.getFullYear(),h.hour,3,"Total",0),b="".concat(p.month,"/").concat(p.day,"/").concat(p.year);this.totalLoadpRofile.addLoadProfileData(p,b)}}catch(w){m.e(w)}finally{m.f()}}var v=l.getMaxAndSum(),E=v.max,A=v.sum;0===A.kwdel?this.loadProfiles.delete(l.meteringPoint):(this.loadProfilesMax.push(E),this.loadProfilesSum.push(A),o+=E.kwdel)}}catch(w){i.e(w)}finally{i.f()}var P,O=Object(f.a)(this.totalLoadpRofile.dailyLoadProfiles.values());try{for(O.s();!(P=O.n()).done;){var N,M=P.value,S=Object(f.a)(M.hourlyLoadProfiles);try{for(S.s();!(N=S.n()).done;){var x=N.value;x.getRawTotal()>e&&(e=x.getRawTotal(),a=M.date,n=x.hour,t="total")}}catch(w){S.e(w)}finally{S.f()}}}catch(w){O.e(w)}finally{O.f()}var C=o/e;this.coincidentPeak={kwdel:e,date:a,hour:n,meteringPoint:t},this.nonCoincidentPeak={kwdel:o},this.diversityFactor={factor:C},console.log({info:"max and sum",max:this.loadProfilesMax,sum:this.loadProfilesSum,coincidental:this.coincidentPeak,nonCoincidental:this.nonCoincidentPeak,diversityFactor:this.diversityFactor,totalLoadProfile:this.totalLoadpRofile})}}]),e}(),_=function(){function e(t){Object(b.a)(this,e),this.data=void 0,this.top=void 0,this.data=[],this.top=0,t&&(this.data=t.data,this.top=t.top)}return Object(v.a)(e,[{key:"push",value:function(e){this.data[this.top]=e,this.top=this.top+1}},{key:"length",value:function(){return this.top}},{key:"peek",value:function(){return this.data[this.top-1]}},{key:"isEmpty",value:function(){return 0===this.top}},{key:"pop",value:function(){if(!1===this.isEmpty())return this.top=this.top-1,this.data.pop()}}]),e}(),D=Object(o.createContext)({updateLoadProfiles:function(e){},monthlyLoadProfiles:new Map,working:!1,deleteLoadProfiles:function(e){}}),F=function(e){var t=e.children,a=(Object(p.a)(e,["children"]),Object(o.useState)(new Map)),n=Object(h.a)(a,2),i=n[0],l=n[1],c=Object(o.useState)(new _),s=Object(h.a)(c,2),d=s[0],u=s[1],m=Object(o.useState)(!1),g=Object(h.a)(m,2),b=g[0],v=g[1];return Object(o.useEffect)((function(){console.log("MonthlyLoadProfiles State Updated"),console.log(i)}),[i]),Object(o.useEffect)((function(){if(!b)if(d.isEmpty())v(!1);else{var e,t,a,n=new _(d),o=n.pop();o&&(v(!0),o instanceof Array?(console.log("Data instance of ARRRRAAAAY...."),(a=o,new Promise((function(e,t){console.log("Processing rawDatas");var n,o=new Map(i),r=Object(f.a)(a);try{for(r.s();!(n=r.n()).done;){var l,c=n.value,s="".concat(c.billingPeriod.month,"-").concat(c.year);o.has(s)||o.set(s,new R(c.billingPeriod)),null===(l=o.get(s))||void 0===l||l.addData(c)}}catch(d){r.e(d)}finally{r.f()}o.forEach((function(e){return e.initOtherDetails()})),e(o)}))).then((function(e){l(e),v(!1),u(n)}))):(console.log("Data instance of ARRRRAAAAY...."),(e=o.fileName,t=o.meteringPoints,new Promise((function(a,n){console.log("DELETING LAODP ROFILESS");var o,r=new Map(i),l=Object(f.a)(r.keys());try{for(l.s();!(o=l.n()).done;){var c=o.value,s=r.get(c);null===s||void 0===s||s.removeData(e,t)}}catch(d){l.e(d)}finally{l.f()}r.forEach((function(e){var t;if(e.initOtherDetails(),0===(null===(t=e.nonCoincidentPeak)||void 0===t?void 0:t.kwdel)){var a="".concat(e.billingPeriod.month,"-").concat(e.billingPeriod.year);r.delete(a)}})),a(r)}))).then((function(e){l(e),v(!1),u(n)}))))}}),[d]),r.a.createElement(D.Provider,{value:{updateLoadProfiles:function(e){console.log("Updating load profile datas in context...."),u((function(t){var a=new _(t);return a.push(e),a}))},monthlyLoadProfiles:i,deleteLoadProfiles:function(e){u((function(t){var a=new _(t);return a.push(e),a}))},working:b}},t)},H=a(40),U=a(158),G=a(182),V=a(159),Z=a(160),W=a(189),B=a(154),Y=Object(d.a)((function(e){return{root:{border:"none",borderRadius:0,"&.Mui-selected":{backgroundColor:e.palette.background.default,color:e.palette.primary.main},"&:hover, &.Mui-selected:hover":{color:e.palette.primary.main,backgroundColor:e.palette.background.default},selected:{}}}})),K=function(e){var t=e.value,a=e.children,n=Object(p.a)(e,["value","children"]),o=Y();return r.a.createElement(B.a,Object.assign({classes:{root:o.root},value:t},n),a)},z=Object(d.a)((function(e){return{root:{width:50,height:"100%",zIndex:e.zIndex.drawer+10},container:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",height:"100%",width:"100%"},toggleButtonsContainer:{},otherButtonsContainer:{display:"flex",flexDirection:"column"}}}));!function(e){e.FILES="files",e.SETTINGS="settings",e.NONE=""}(j||(j={}));var J,$=function(e){var t=e.onFilesToggled,a=e.onSettingsToggled,n=e.onSettingsUntoggled,i=e.onFilesUntoggled,l=(Object(p.a)(e,["onFilesToggled","onSettingsToggled","onSettingsUntoggled","onFilesUntoggled"]),Object(o.useState)(j.FILES)),c=Object(h.a)(l,2),s=c[0],d=c[1],u=Object(o.useState)(j.NONE),m=Object(h.a)(u,2),f=m[0],g=m[1];var b=z();return r.a.createElement(U.a,{elevation:4,className:b.root,position:"static",color:"inherit"},r.a.createElement(G.a,{className:b.container},r.a.createElement(G.a,{className:b.toggleButtonsContainer},r.a.createElement(W.a,{onChange:function(e,a){console.log({method:"handleToggleChange()",params:{newToggle:a}});var n=s;d(a),a===j.FILES?t():n===j.FILES&&i()},value:s,exclusive:!0},r.a.createElement(K,{value:j.FILES},r.a.createElement(V.a,null)))),r.a.createElement(G.a,{className:b.otherButtonsContainer},r.a.createElement(W.a,{onChange:function(e,t){console.log({method:"handleOtherToggleChange()",params:{newToggle:t}});var o=f;g(t),t===j.SETTINGS?a():o===j.SETTINGS&&n()},value:f,exclusive:!0},r.a.createElement(K,{value:j.SETTINGS},r.a.createElement(Z.a,null))))))},X=a(187),Q=a(76),q=a(184),ee=Object(d.a)((function(e){return Object(q.a)({drawer:{width:300,flexShrink:0},drawerPaper:{width:300,position:"static",borderLeft:"1px solid ".concat(e.palette.divider),borderRight:"1px solid ".concat(e.palette.divider)},drawerHeader:Object(Q.a)(Object(Q.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-300},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}})})),te=a(28),ae=a.n(te),ne=a(41),oe=a(185),re=a(186),ie=a(94),le=a(162),ce=a(161),se=Object(d.a)((function(e){return{accordion:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"},expanded:{}},accordionSummary:{borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:30,"&$expanded":{minHeight:30,backgroundColor:"black"},expanded:{}},content:{"&$expanded":{margin:"12px 0"}},accordionTitle:{fontSize:"1rem",asdf:{}},expanded:{},accordionDetails:{backgroundColor:e.palette.background.default,padding:"5px",position:"relative"}}})),de=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=e.panelName,o=e.title,i=(e.render,e.children),l=(Object(p.a)(e,["expandedPanel","onPanelChange","panelName","title","render","children"]),se());return r.a.createElement(oe.a,{className:l.accordion,square:!0,expanded:t===n,onChange:function(e,t){a(t?n:"")}},r.a.createElement(re.a,{className:l.accordionSummary,expandIcon:r.a.createElement(ce.a,null)},r.a.createElement(ie.a,{className:l.accordionTitle},o)),r.a.createElement(le.a,{className:l.accordionDetails},i))},ue=a(163),me=a(164),fe=a(166),he=a(167),pe=a(168),ge=a(169),be=a(165),ve=Object(d.a)((function(e){return{root:{zIndex:e.zIndex.mobileStepper,maxWidth:"100%",fontSize:"0.8rem",boxSizing:"border-box",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),padding:10,overflowWrap:"break-word",wordWrap:"break-word"},filename:{fontSize:"1em",color:e.palette.text.primary},progress_text:{fontSize:"0.7em",color:e.palette.text.secondary,alignSelf:"flex-end"},content:{display:"flex",flexDirection:"column",gap:"5px",justifyContent:"center"},progress_content:{display:"flex",flexDirection:"column",gap:"3px"},action:{},button:{textTransform:"none"},error_container:{maxWidth:"100%"},error_text:{fontSize:"0.9rem",padding:"10px 5px",whiteSpace:"pre-wrap"}}})),Ee=function(e){var t=e.file,a=e.progress,n=e.progressInfo,i=e.errors,l=void 0===i?[]:i,c=e.onRemoveFile,s=(Object(p.a)(e,["file","progress","progressInfo","errors","onRemoveFile"]),ve()),d=Object(o.useState)(!1),u=Object(h.a)(d,2),m=u[0],f=u[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:s.root},r.a.createElement("div",{className:s.content},r.a.createElement(ie.a,{className:s.filename},t.name),r.a.createElement("div",{className:s.progress_content},r.a.createElement(ue.a,{value:a,variant:0===a||100===a?"determinate":"indeterminate"}),r.a.createElement(ie.a,{className:s.progress_text},n))),r.a.createElement("div",{className:s.action},0!==l.length&&r.a.createElement(me.a,{className:s.button,size:"small",color:"secondary",startIcon:r.a.createElement(be.a,{color:"error"}),onClick:function(){console.log(l),f(!0)}},"see errors"),r.a.createElement(me.a,{className:s.button,onClick:c,size:"small",color:"primary"},"Remove"))),r.a.createElement(fe.a,{open:m,onClose:function(){f(!1)}},r.a.createElement(he.a,null,r.a.createElement(ie.a,{variant:"h6",color:"error"},"Errors"),r.a.createElement(ie.a,{variant:"subtitle1",color:"textSecondary"},t.name),r.a.createElement(pe.a,null)),r.a.createElement(ge.a,null,r.a.createElement(G.a,{overflow:"auto",padding:"5px 25px"},l.map((function(e,t){return r.a.createElement("div",{key:t,className:s.error_container},r.a.createElement(ie.a,{component:"p",className:s.error_text,key:"".concat(t,"~error")},e),r.a.createElement(pe.a,null))}))))))};!function(e){e.KWDEL="lp_kwdelCol",e.DATE="lp_dateCol",e.TIME="lp_timeCol",e.DATE_FORMAT="lp_dateFormat",e.TIME_FORMAT="lp_timeFormat"}(J||(J={}));var Ae={loadSettings:function(){return{kwdelCol:Number(localStorage.getItem(J.KWDEL)||"1"),dateCol:Number(localStorage.getItem(J.DATE)||"2"),timeCol:Number(localStorage.getItem(J.TIME)||"3"),dateFormat:localStorage.getItem(J.DATE_FORMAT)||"MM/dd/yyyy",timeFormat:localStorage.getItem(J.TIME_FORMAT)||"HH:mm"}},saveSettings:function(e){e.kwdelCol&&localStorage.setItem(J.KWDEL,String(e.kwdelCol)),e.timeCol&&localStorage.setItem(J.TIME,String(e.timeCol)),e.dateCol&&localStorage.setItem(J.DATE,String(e.dateCol)),e.dateFormat&&localStorage.setItem(J.DATE_FORMAT,String(e.dateFormat)),e.timeFormat&&localStorage.setItem(J.TIME_FORMAT,String(e.timeFormat))}},Pe=a(36),Oe=a.n(Pe),Ne=a(85),Ie=a(89),ye=a(90),Me=function(e){Object(Ne.a)(a,e);var t=Object(Ie.a)(a);function a(e){return Object(b.a)(this,a),t.call(this,e)}return a}(Object(ye.a)(Error));function Se(){return(Se=Object(ne.a)(ae.a.mark((function e(t){return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){console.log("FileUTils: Timeout wait for 10 secs....");var n=t.name.split(".")[1];console.log({method:"extractWorkbookFromFile()",parameteres:{file:t},fileTypeSplit:t.name.split("."),fileExtension:n}),"xlsx"!==n&&a(new Me("Invalid file: expected: .xlsx received: ".concat(n)));var o=new FileReader;o.onload=function(t){try{var n,o=new Uint8Array(null===(n=t.target)||void 0===n?void 0:n.result),r=Oe.a.read(o,{type:"array",cellDates:!0});e(r)}catch(i){a(new Error(i))}},o.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xe={extractWorkbookFromFile:function(e){return Se.apply(this,arguments)}};function Ce(e,t){return new Promise((function(a,n){setTimeout((function(){a(e/t*100)}),0)}))}function we(e,t,a,n){var o={c:n.kwdelCol,r:t},r={c:n.dateCol,r:t},i={c:n.timeCol,r:t},l=Oe.a.utils.encode_cell(o),c=Oe.a.utils.encode_cell(r),s=Oe.a.utils.encode_cell(i);return{kwdelCell:e[l],timeCell:e[s],dateCell:e[c],row:t,sheetName:a}}function Te(e,t,a){var n=null,o=function(e){var t=null,a=null;"n"===e.t||Number(e.v||e.w)?a=Number(e.v||e.r):t="KwdelCell expectations: number received: ".concat(e.v);return{error:t,value:a}}(e.kwdelCell),r=function(e,t){var a=null,n=null,o=null;"d"!==e.t?"s"===e.t&&(o=O()(e.v||e.w||e.r,t,!0)).isValid()?n=o.toDate():a="DateCell expectations: date received: ".concat(e.v):n=e.v;return{error:a,value:n}}(e.dateCell,t.dateFormat),i=function(e,t){var a=null,n=null,o=null;"d"!==e.t?"s"===e.t&&(o=O()(e.v||e.w||e.r,t)).isValid()?n=o.toDate():a="TimeCell expectations: date received: ".concat(e.v):n=e.v;return{error:a,value:n}}(e.timeCell,t.timeFormat);if(Boolean(o.error||r.error||i.error))throw n="Errors in row ".concat(e.row+1,":\n"),o.error&&(n=n.concat("\t".concat(o.error,"\n"))),r.error&&(n=n.concat("\t".concat(r.error,"\n"))),i.error&&(n=n.concat("\t".concat(i.error,"\n"))),new Error(n);var l,c,s,d,u,m=o.value,f=null===(l=r.value)||void 0===l?void 0:l.getDate(),h=null===(c=r.value)||void 0===c?void 0:c.getMonth(),p=null===(s=i.value)||void 0===s?void 0:s.getHours(),g=null===(d=i.value)||void 0===d?void 0:d.getMinutes(),b=null===(u=r.value)||void 0===u?void 0:u.getFullYear();return new I(m,f,h+1,b,p,g,e.sheetName,e.row,a)}var ke,je=function(e,t,a){return new Promise(function(){var n=Object(ne.a)(ae.a.mark((function n(o,r){var i,l,c,s,d,u,m,h,p,g,b,v,E,A;return ae.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t){n.next=3;break}return r(new Error("Invalid file")),n.abrupt("return");case 3:console.log("Parsing workbook..."),i=[],l=[],c=[],s=Object(f.a)(t.SheetNames),n.prev=8,s.s();case 10:if((d=s.n()).done){n.next=35;break}if(u=d.value,L.exists(u)){n.next=15;break}return l.push("Invalid sheetname: ".concat(u,", expected: MF3MPITZAMC01~7")),n.abrupt("continue",33);case 15:return c.push(u),a("Parsing ".concat(u),0),console.log("Parsing worksheet: "+u),m=t.Sheets[u],h=Oe.a.utils.decode_range(m["!ref"]),n.next=22,Promise.resolve(h.e.r-h.s.r);case 22:p=n.sent,g=0;case 24:if(!(g<=h.e.r)){n.next=33;break}return n.next=27,Ce(g,p);case 27:b=n.sent,a("Processing rows ".concat(g,"/").concat(p," ").concat(b.toFixed(0),"%"),b);try{v=Ae.loadSettings(),E=we(m,g,u,v),A=Te(E,v,e),i.push(A)}catch(P){l.push(P.message)}case 30:g++,n.next=24;break;case 33:n.next=10;break;case 35:n.next=40;break;case 37:n.prev=37,n.t0=n.catch(8),s.e(n.t0);case 40:return n.prev=40,s.f(),n.finish(40);case 43:console.log("finished"),a("Finished processing",100),o({value:i,errors:l,meteringPoints:c});case 46:case"end":return n.stop()}}),n,null,[[8,37,40,43]])})));return function(e,t){return n.apply(this,arguments)}}())},Le=function(e){var t=e.file,a=e.render,n=e.onFileParsed,i=e.onRemoveFile,l=(Object(p.a)(e,["file","render","onFileParsed","onRemoveFile"]),Object(o.useState)(0)),c=Object(h.a)(l,2),s=c[0],d=c[1],u=Object(o.useState)(""),m=Object(h.a)(u,2),f=m[0],b=m[1],v=Object(o.useState)([]),E=Object(h.a)(v,2),A=E[0],P=E[1],O=Object(o.useState)([]),N=Object(h.a)(O,2),I=N[0],y=N[1];function M(e,t){d(t),b(e)}return Object(o.useEffect)((function(){xe.extractWorkbookFromFile(t).then((function(e){return je(t.name,e,M)})).then((function(e){var t;P(e.errors),t=e.value,n(t),y((function(t){return[].concat(Object(g.a)(t),Object(g.a)(e.meteringPoints))}))})).catch((function(e){console.error(e),A.push(e.message)}))}),[]),r.a.createElement(r.a.Fragment,null,a({progress:s,progressInfo:f,fileFromParser:t,errors:A,onRemoveFile:function(){i(t,I)}}))},Re=a(3),_e=a(88),De=Object(d.a)((function(e){return{dropZone:{height:"100%",width:"100%",cursor:"pointer",minHeight:50},dropZone_focused:{border:"2px dashed ".concat(e.palette.text.secondary)},dropZone_content:{display:"flex",flexDirection:"column",maxWidth:"100%",gap:"10px",flexWrap:"wrap",margin:5},dropZoneText:{fontSize:"0.8rem",fontWeight:"bold",padding:"5px"}}})),Fe=function(e){var t=e.helperText,a=void 0===t?"":t,n=e.onFileDrop,i=e.onDragEnter,l=e.onDragLeave,c=(e.onDragOver,e.children),s=(Object(p.a)(e,["helperText","onFileDrop","onDragEnter","onDragLeave","onDragOver","children"]),Object(o.useState)(!1)),d=Object(h.a)(s,2),u=d[0],m=d[1],f=De();function g(){m(!0),i()}function b(){m(!1),l()}return r.a.createElement(G.a,{display:"flex",flexDirection:"column",width:"100%"},r.a.createElement(_e.a,{onDrop:n,onDragEnter:g,onDragLeave:b},(function(e){var t=e.getRootProps,n=e.getInputProps;return r.a.createElement("section",{onMouseEnter:g,onMouseLeave:b,className:Object(Re.a)(f.dropZone,Object(H.a)({},f.dropZone_focused,u))},r.a.createElement("div",t({className:"".concat(f.dropZone_content)}),r.a.createElement("input",n()),r.a.createElement(ie.a,{variant:"subtitle1",color:"textSecondary",className:f.dropZoneText},a)))})),r.a.createElement(G.a,{display:"flex",flexDirection:"column",maxWidth:"100%",gridGap:5,marginTop:1},c))},He=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=(Object(p.a)(e,["expandedPanel","onPanelChange"]),Object(o.useState)(new Map)),i=Object(h.a)(n,2),l=i[0],c=i[1],s=Object(o.useContext)(D);function d(){return(d=Object(ne.a)(ae.a.mark((function e(t){return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){c((function(t){if(t.has(e.name))return t;var a=new Map(t);return a.set(e.name,e),a}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){s.updateLoadProfiles(e)}function m(e,t){c((function(t){var a=new Map(t);return a.delete(e.name),a})),s.deleteLoadProfiles({fileName:e.name,meteringPoints:t})}return Object(o.useEffect)((function(){console.log("New File Added...")}),[l,c]),r.a.createElement(de,{onPanelChange:a,title:"Load Profile Files",panelName:"laodprofile_filespanel",expandedPanel:t},r.a.createElement(Fe,{onDragEnter:function(){},onDragLeave:function(){},onFileDrop:function(e){return d.apply(this,arguments)},helperText:"Drop files here"},Object(g.a)(l.values()).map((function(e){return r.a.createElement(Le,{onFileParsed:u,key:e.name,file:e,onRemoveFile:m,render:function(e){var t=e.progress,a=e.progressInfo,n=e.fileFromParser,o=e.onRemoveFile,i=e.errors;return r.a.createElement(Ee,{progress:t,progressInfo:a,file:n,errors:i,onRemoveFile:o})}})}))))},Ue=function(e){var t=e.open,a=(Object(p.a)(e,["open"]),ee()),n=Object(o.useState)("laodprofile_filespanel"),i=Object(h.a)(n,2),l=i[0],c=i[1];return r.a.createElement(X.a,{variant:"persistent",open:t,anchor:"left",className:a.drawer,classes:{paper:a.drawerPaper}},r.a.createElement(He,{onPanelChange:function(e){c(e)},expandedPanel:l}))},Ge=a(183),Ve=Object(d.a)((function(e){return{root:{background:e.palette.background.paper,padding:e.spacing(3),fontSize:"1rem",display:"flex",flexDirection:"column",zIndex:e.zIndex.mobileStepper,position:"absolute",top:0,left:0,height:"100%",width:"100%"},title_div:{borderBottom:"1px solid ".concat(e.palette.divider)},title:{marginTop:e.spacing(5),fontSize:"1.3em"},tabs:{display:"inline-block"},content:{marginTop:e.spacing(5),display:"flex",flexGrow:1},tab_panel:{flexGrow:1}}})),Ze=a(181),We=Object(d.a)((function(e){return{root:{fontSize:"1em",border:"1px solid ".concat(e.palette.divider),borderRadius:e.shape.borderRadius,backgroundColor:e.palette.background.paper,"&.Mui-focused":{backgroundColor:e.palette.background.default,border:"1px solid ".concat(e.palette.primary.main)},"&:hover":{backgroundColor:e.palette.background.default},focused:{}}}})),Be=function(e){var t=e.label,a=e.value,n=void 0===a?"":a,o=e.name,i=void 0===o?"":o,l=e.placeholder,c=void 0===l?"":l,s=e.helpertext,d=void 0===s?"":s,u=e.error,m=void 0!==u&&u,f=e.type,h=void 0===f?"text":f,p=e.onChange,g=void 0===p?function(e){}:p,b=(e.limitZero,We());return r.a.createElement(Ze.a,{variant:"filled",label:t,value:n,name:i,placeholder:c,error:m,helperText:d,type:h,InputProps:{disableUnderline:!0,classes:{root:b.root}},margin:"dense",onChange:function(e){"number"===h&&Number(e.target.value)<0||g(e)}})},Ye=Object(d.a)((function(e){return{root:{height:"100%",width:"100%",display:"flex",flexDirection:"column"},textFieldContainer:{display:"flex",flexDirection:"column",gap:"10px",width:"50%",minWidth:"300px",fontSize:"0.9rem"},actionContainer:{marginTop:10}}})),Ke=function(e){Object.assign({},e);var t=Ye(),a=Object(o.useState)(0),n=Object(h.a)(a,2),i=n[0],l=n[1],c=Object(o.useState)(0),s=Object(h.a)(c,2),d=s[0],u=s[1],m=Object(o.useState)(0),f=Object(h.a)(m,2),p=f[0],g=f[1],b=Object(o.useState)(""),v=Object(h.a)(b,2),E=v[0],A=v[1],P=Object(o.useState)(""),O=Object(h.a)(P,2),N=O[0],I=O[1];return Object(o.useEffect)((function(){var e=Ae.loadSettings();l(e.kwdelCol),A(e.dateFormat),u(e.dateCol),g(e.timeCol),I(e.timeFormat)}),[]),r.a.createElement("div",{className:t.root},r.a.createElement("form",{id:"settings-form",className:t.textFieldContainer,onSubmit:function(e){e.preventDefault(),Ae.saveSettings({kwdelCol:i,timeCol:p,dateCol:d,dateFormat:E,timeFormat:N})}},r.a.createElement(Be,{label:"Kwdel Column#",placeholder:"Kwdel Column#",value:i,type:"number",onChange:function(e){l(Number(e.target.value))}}),r.a.createElement(Be,{label:"Date Column#",placeholder:"Date Column#",value:d,type:"number",onChange:function(e){u(Number(e.target.value))}}),r.a.createElement(Be,{label:"Time Column#",placeholder:"Time Column#",value:p,type:"number",onChange:function(e){g(Number(e.target.value))}}),r.a.createElement(Be,{label:"Date Format",placeholder:"Date Format",value:E,onChange:function(e){A(e.target.value)}}),r.a.createElement(Be,{label:"Time Format",placeholder:"Time Format",value:N,onChange:function(e){I(e.target.value)}})),r.a.createElement("div",{className:t.actionContainer},r.a.createElement(me.a,{form:"settings-form",type:"submit",color:"primary"},"Save")))},ze=a(170),Je=Object(d.a)((function(e){return{tab:{textAlign:"start",textTransform:"none",fontWeight:"normal",fontSize:"0.9em",borderRight:"1px solid ".concat(e.palette.divider)},tab_selected:{backgroundColor:e.palette.background.default,color:e.palette.primary.main,fontWeight:"bold"},tab_wrapper:{justifyContent:"flex-start",alignItems:"flex-start"}}})),$e=function(e){var t=e.label,a=e.value,n=Object(p.a)(e,["label","value"]),o=Je();return r.a.createElement(ze.a,Object.assign({classes:{root:o.tab,wrapper:o.tab_wrapper,selected:o.tab_selected},value:a,label:t},n))},Xe=Object(d.a)((function(e){return{tab:{textAlign:"start",textTransform:"none",fontWeight:"normal",fontSize:"0.9em",borderBottom:"1px solid ".concat(e.palette.divider),padding:0,minWidth:"100px",lineHeight:0},tab_selected:{backgroundColor:e.palette.background.default,color:e.palette.primary.main,fontWeight:"bold"},tab_wrapper:{}}})),Qe=function(e){var t=e.label,a=e.value,n=Object(p.a)(e,["label","value"]),o=Xe();return r.a.createElement(ze.a,Object.assign({classes:{root:o.tab,wrapper:o.tab_wrapper,selected:o.tab_selected},value:a,label:t},n))};function qe(e){var t=e.children,a=e.value,n=e.index,o=Object(p.a)(e,["children","value","index"]),i=Ve();return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"scrollable-prevent-tabpanel-".concat(n),"aria-labelledby":"scrollable-prevent-tab-".concat(n),className:i.tab_panel},o),a===n&&r.a.createElement(G.a,{p:3},t))}!function(e){e.LoadProfileTab="lp_tab",e.FeederDemandTab="fd_tab"}(ke||(ke={}));var et=function(e){Object.assign({},e);var t=Object(o.useState)(ke.LoadProfileTab),a=Object(h.a)(t,2),n=a[0],i=a[1],l=Ve();return r.a.createElement("div",{className:l.root},r.a.createElement("div",{className:l.title_div},r.a.createElement(ie.a,{className:l.title},"Settings")),r.a.createElement("div",{className:l.content},r.a.createElement(Ge.a,{className:l.tabs,orientation:"vertical",value:n,centered:!1,indicatorColor:"primary",onChange:function(e,t){i(t)}},r.a.createElement($e,{label:"Load Profile Settings",value:ke.LoadProfileTab}),r.a.createElement($e,{value:ke.FeederDemandTab,label:"Feeder and Demand Settings"})),r.a.createElement(qe,{value:n,index:ke.LoadProfileTab},r.a.createElement(Ke,null)),r.a.createElement("div",null,n===ke.LoadProfileTab&&r.a.createElement(r.a.Fragment,null))))},tt=a(173),at=a(174),nt=a(175),ot=a(176),rt=a(172),it=a(171),lt=Object(d.a)((function(e){return Object(q.a)({root:{paddingLeft:e.spacing(3),color:e.palette.text.primary,"&:hover > $content":{backgroundColor:e.palette.action.hover},"&:focus > $content, &$selected > $content":{color:e.palette.primary.main},"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label":{backgroundColor:"transparent"}},content:{color:e.palette.text.primary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:0,"& $content":{paddingLeft:e.spacing(2)}},expanded:{},selected:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",gap:"".concat(e.spacing(2),"px"),padding:e.spacing(.5,1)},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"normal",flexGrow:0}})}));var ct,st=function(e){var t=lt(),a=e.labelText,n=e.labelIcon,o=e.labelInfo,i=e.color,l=e.bgColor,c=Object(p.a)(e,["labelText","labelIcon","labelInfo","color","bgColor"]);return r.a.createElement(it.a,Object.assign({label:r.a.createElement("div",{className:t.labelRoot},r.a.createElement(n,{color:"inherit",className:t.labelIcon}),r.a.createElement(ie.a,{variant:"body2",className:t.labelText},a),r.a.createElement(ie.a,{variant:"caption",color:"inherit"},o)),style:{"--tree-view-color":i,"--tree-view-bg-color":l},classes:{root:t.root,content:t.content,expanded:t.expanded,selected:t.selected,group:t.group,label:t.label}},c))},dt=Object(d.a)((function(e){return Object(q.a)({root:{display:"inline-block",fontSize:"1rem",padding:"".concat(e.spacing(3),"px ").concat(e.spacing(1),"px")}})})),ut=function(e){var t=e.monthlyLoadProfile,a=(Object(p.a)(e,["monthlyLoadProfile"]),dt());return r.a.createElement(rt.a,{className:a.root,defaultExpanded:["1"],defaultCollapseIcon:r.a.createElement(tt.a,null),defaultExpandIcon:r.a.createElement(at.a,null),defaultEndIcon:r.a.createElement("div",{style:{width:24}})},r.a.createElement(st,{nodeId:"2",labelText:"Coincident Peak",labelIcon:nt.a,labelInfo:t.coincidentPeak?"".concat(t.coincidentPeak.meteringPoint,": ").concat(t.coincidentPeak.date.getMonth()+1,"/").concat(t.coincidentPeak.date.getDate(),"/").concat(t.coincidentPeak.date.getFullYear()," ").concat(t.coincidentPeak.hour,":00 kwdel: ").concat(t.coincidentPeak.kwdel.toFixed(2)):""}),r.a.createElement(st,{nodeId:"3",labelText:"None Coincident Peak",labelIcon:ot.a,labelInfo:t.nonCoincidentPeak?" ".concat(t.nonCoincidentPeak.kwdel.toFixed(2)):""}),r.a.createElement(st,{nodeId:"4",labelText:"Diversity Factor:",labelIcon:ot.a,labelInfo:t.diversityFactor?" ".concat(t.diversityFactor.factor.toFixed(2)):""}),r.a.createElement(st,{nodeId:"5",labelText:"Max per metering point:",labelIcon:nt.a,labelInfo:""},t.loadProfilesMax.map((function(e){return r.a.createElement(st,{key:"LM:S".concat(e.meteringPoint),nodeId:"LM:S".concat(e.meteringPoint),labelIcon:nt.a,labelText:"".concat(e.meteringPoint),labelInfo:" ".concat(e.date.getMonth()+1,"/").concat(e.date.getDate(),"/").concat(e.date.getFullYear()," ").concat(e.hour,":00 kwdel: ").concat(e.kwdel.toFixed(2))})}))),r.a.createElement(st,{nodeId:"7",labelText:"Sum per metering point:",labelIcon:ot.a,labelInfo:""},t.loadProfilesSum.map((function(e){return r.a.createElement(st,{key:"LS:S".concat(e.meteringPoint),nodeId:"LS:S".concat(e.meteringPoint),labelIcon:ot.a,labelText:"".concat(e.meteringPoint),labelInfo:" ".concat(e.kwdel.toFixed(2))})}))))},mt=a(178);!function(e){e[e.JANUARY=0]="JANUARY",e[e.FEBRUARY=1]="FEBRUARY",e[e.MARCH=2]="MARCH",e[e.APRIL=3]="APRIL",e[e.MAY=4]="MAY",e[e.JUNE=5]="JUNE",e[e.JULY=6]="JULY",e[e.AUGUST=7]="AUGUST",e[e.SEPTEMBER=8]="SEPTEMBER",e[e.OCTOBER=9]="OCTOBER",e[e.NOVEMBER=10]="NOVEMBER",e[e.DECEMBER=11]="DECEMBER"}(ct||(ct={}));var ft=ct,ht=a(177),pt=Object(d.a)((function(e){return Object(q.a)({labelContent:{width:"120px",fontWeight:"normal",flexGrow:1}})}));var gt,bt=function(e){var t=lt(),a=pt(),n=e.color,i=e.bgColor,l=e.loadProfiles,c=e.dateString,s=void 0===c?"":c,d=e.hour,u=void 0===d?1:d,m=e.header,f=void 0!==m&&m,h=e.totalLoadProfile,g=Object(p.a)(e,["color","bgColor","loadProfiles","dateString","hour","header","totalLoadProfile"]);return Object(o.useEffect)((function(){console.log("HourTreeItemRendered: Hour: "+u)}),[]),r.a.createElement(it.a,Object.assign({label:r.a.createElement("div",{className:t.labelRoot},r.a.createElement(G.a,{minWidth:"35px"},f?r.a.createElement(ie.a,{variant:"body2",className:t.labelText},"Hour"):r.a.createElement(ie.a,{variant:"body2",className:t.labelText},u)),f?l.map((function(e){return r.a.createElement(ie.a,{key:"HTI: T: M:".concat(e.meteringPoint),variant:"body2",className:a.labelContent},e.meteringPoint)})):l.map((function(e){return r.a.createElement(ie.a,{key:"HTI: T: K:".concat(e.meteringPoint),variant:"body2",className:a.labelContent},e.getDailyLoadProfile(s).hourlyLoadProfiles[u-1].getTotalKwdel().toFixed(2))})),f?r.a.createElement(ie.a,{className:a.labelContent,variant:"caption",color:"inherit"},"Total "):r.a.createElement(ie.a,{className:a.labelContent,variant:"caption",color:"inherit"},h.getDailyLoadProfile(s).hourlyLoadProfiles[u-1].getRawTotal().toFixed(2))),style:{"--tree-view-color":n,"--tree-view-bg-color":i},classes:{root:t.root,content:t.content,expanded:t.expanded,selected:t.selected,group:t.group,label:t.label}},g))},vt=function(e){var t=e.loadProfiles,a=e.dateString,n=e.nodeId,i=e.totalLoadProfile,l=Object(o.useState)(new Date),c=Object(h.a)(l,2),s=c[0],d=c[1];return Object(o.useEffect)((function(){d(new Date(a))}),[a]),r.a.createElement(st,{nodeId:n,labelText:"".concat(ft[s.getMonth()]," ").concat(s.getDate()),labelIcon:ht.a},r.a.createElement(bt,{nodeId:"DTI:D:".concat(a,"H"),dateString:a,header:!0,loadProfiles:t,totalLoadProfile:i}),Object(g.a)(Array(24).keys()).map((function(e){return r.a.createElement(bt,{nodeId:"HTI: H:".concat(e),key:"HTI: H:".concat(e),hour:e+1,dateString:a,loadProfiles:t,totalLoadProfile:i})})))},Et=Object(d.a)((function(e){return Object(q.a)({root:{flexShrink:0,display:"inline-block",fontSize:"1rem",padding:"".concat(e.spacing(3),"px ").concat(e.spacing(1),"px")},title:{fontSize:"1.5em"},dayTree:{flexGrow:1,maxWidth:400}})})),At=function(e){var t=e.monthlyLoadProfile,a=Et();return r.a.createElement(rt.a,{className:a.root,defaultExpanded:["1"],defaultCollapseIcon:r.a.createElement(tt.a,null),defaultExpandIcon:r.a.createElement(at.a,null),defaultEndIcon:r.a.createElement("div",{style:{width:24}})},r.a.createElement(st,{nodeId:"1",labelText:"".concat(ft[t.billingPeriod.month-1]," ").concat(t.billingPeriod.year),labelIcon:mt.a},Object(g.a)(t.dateStrings.values()).map((function(e){var a=Object(g.a)(Array.from(t.loadProfiles.values())),n="DTI:D:".concat(e);return r.a.createElement(vt,{totalLoadProfile:t.totalLoadpRofile,key:n,nodeId:n,loadProfiles:a,dateString:e})}))))},Pt=Object(d.a)((function(e){return Object(q.a)({root:{display:"flex",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),boxSizing:"border-box"}})})),Ot=function(e){var t=e.monthlyLoadProfile,a=Pt();return r.a.createElement("div",{className:a.root},r.a.createElement(At,{monthlyLoadProfile:t}),r.a.createElement(ut,{monthlyLoadProfile:t}))},Nt=Object(d.a)((function(e){return{dateCotnent_root:{flex:1,overflow:"auto",padding:e.spacing(4)},dateCotnent_content:{display:"flex",flexDirection:"column",justifyContent:"stretch",padding:e.spacing(5),gap:"".concat(e.spacing(3),"px"),boxSizing:"border-box"}}})),It=function(e){Object.assign({},e);var t=Object(o.useContext)(D),a=Nt();return r.a.createElement("div",{className:a.dateCotnent_root},r.a.createElement("div",{className:a.dateCotnent_content},Array.from(t.monthlyLoadProfiles.values()).map((function(e){return r.a.createElement(Ot,{key:"MCM:".concat(e.billingPeriod.month,"Y:").concat(e.billingPeriod.year),monthlyLoadProfile:e})}))))};!function(e){e.DATA="data",e.GRAPH="graph",e.NONE=""}(gt||(gt={}));var yt,Mt=Object(d.a)((function(e){return{loadProfileContent_root:{flex:1,display:"flex",flexDirection:"column",minWidth:0,minHeight:0},loadProfileContent_Header:{display:"flex",alignItems:"flex-end"},loadProfileContent_Title:{marginRight:e.spacing(1),paddingRight:e.spacing(3),textAlign:"center"},loadProfileContent_Content:{flexGrow:1,display:"flex",minHeight:"0px",minWidth:"0px"}}})),St=function(e){Object.assign({},e);var t=Mt(),a=Object(o.useState)(gt.DATA),n=Object(h.a)(a,2),i=n[0],l=n[1];Object(o.useContext)(D);return r.a.createElement("div",{className:t.loadProfileContent_root},r.a.createElement("div",{className:t.loadProfileContent_Header},r.a.createElement(ie.a,{className:t.loadProfileContent_Title,variant:"h5"},"Load Profile"),r.a.createElement(Ge.a,{onChange:function(e,t){l(t)},indicatorColor:"primary",value:i},r.a.createElement(Qe,{label:"Data",value:gt.DATA}),r.a.createElement(Qe,{label:"Graph",value:gt.GRAPH}))),r.a.createElement("div",{className:t.loadProfileContent_Content},i===gt.DATA&&r.a.createElement(It,null)))};!function(e){e.LOAD_PROFILE="loadprofile",e.SUBSTATION_REPORT="substationreport"}(yt||(yt={}));var xt=Object(d.a)((function(e){return{maincontent_root:{height:"100%",width:"100%",display:"flex"},tabs_container:{marginTop:e.spacing(10),maxWidth:"300px",flexGrow:0},tabs:{display:"inline-block"}}})),Ct=function(e){Object.assign({},e);var t=xt(),a=Object(o.useState)(yt.LOAD_PROFILE),n=Object(h.a)(a,2),i=n[0],l=n[1];return r.a.createElement("div",{className:t.maincontent_root},r.a.createElement("div",{className:t.tabs_container},r.a.createElement(Ge.a,{className:t.tabs,orientation:"vertical",value:i,centered:!1,indicatorColor:"primary",onChange:function(e,t){l(t)}},r.a.createElement($e,{label:"Load Profile",value:yt.LOAD_PROFILE}),r.a.createElement($e,{label:"Substation Report",value:yt.SUBSTATION_REPORT}))),i===yt.LOAD_PROFILE&&r.a.createElement(St,null))},wt=Object(d.a)((function(e){return{dashboard_root:{display:"flex",height:"100%",width:"100%"},dashboard_content:{flex:1,position:"relative"}}})),Tt=function(e){var t=wt(),a=ee(),n=Object(o.useState)(!0),i=Object(h.a)(n,2),l=i[0],c=i[1],s=Object(o.useState)(!1),d=Object(h.a)(s,2),u=d[0],m=d[1];return r.a.createElement("div",{className:t.dashboard_root},r.a.createElement($,{onSettingsToggled:function(){m(!0)},onSettingsUntoggled:function(){m(!1)},onFilesToggled:function(){c(!0)},onFilesUntoggled:function(){c(!1)}}),r.a.createElement(Ue,{open:l}),r.a.createElement("div",{className:Object(Re.a)(t.dashboard_content,a.content,Object(H.a)({},a.contentShift,l))},u&&r.a.createElement(et,null),r.a.createElement(Ct,null)))},kt=Object(d.a)((function(e){return{root:{height:"100vh",width:"100vw",backgroundColor:e.palette.background.default}}})),jt=function(e){var t=kt();return r.a.createElement(c.a,{theme:m},r.a.createElement(s.a,null,r.a.createElement(F,null,r.a.createElement("div",{className:Object(Re.a)(t.root)},r.a.createElement(Tt,null)))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(jt,null))),document.getElementById("root"))},84:function(e,t){}},[[107,1,2]]]);
//# sourceMappingURL=main.b049241d.chunk.js.map