(this["webpackJsonpexcel-parser"]=this["webpackJsonpexcel-parser"]||[]).push([[0],{102:function(e,t){},130:function(e,t,a){e.exports=a(151)},135:function(e,t,a){},146:function(e,t){},147:function(e,t){},151:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),i=a(19),l=a.n(i),c=(a(135),a(220)),s=a(221),d=a(186),u=a(107),m=Object(u.a)({palette:{primary:{main:"#45aaf2",dark:"#2d98da",contrastText:"white"},secondary:{main:"#fc5c65",dark:"#eb3b5a",contrastText:"white"},text:{primary:"#778ca3",secondary:"#B4BEC8"},background:{default:"#F5F7F9"}}}),f=a(10),h=a(9),b=a(8),g=a(11),p=a(14),v=a(18),E=function(){function e(t){Object(p.a)(this,e),this.hour=void 0,this.kwdelSet=void 0,this.hour=t,this.kwdelSet=[]}return Object(v.a)(e,[{key:"addKwdel",value:function(e,t,a){this.kwdelSet.push({fileName:a,kwdel:e,kwhdel:t})}},{key:"removeKwdel",value:function(e){this.kwdelSet=this.kwdelSet.filter((function(t){return t.fileName!==e}))}},{key:"getTotalKwhdel",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwhdel}}catch(n){a.e(n)}finally{a.f()}return t/this.kwdelSet.length}},{key:"getRawTotalKwhdel",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwhdel}}catch(n){a.e(n)}finally{a.f()}return t}},{key:"getTotalKwdel",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwdel}}catch(n){a.e(n)}finally{a.f()}return t/this.kwdelSet.length}},{key:"getRawTotal",value:function(){if(this.kwdelSet.length<=0)return 0;var e,t=0,a=Object(f.a)(this.kwdelSet);try{for(a.s();!(e=a.n()).done;){t+=e.value.kwdel}}catch(n){a.e(n)}finally{a.f()}return t}}]),e}(),y=function(){function e(t){Object(p.a)(this,e),this.date=void 0,this.hourlyLoadProfiles=void 0,this.max=void 0,this.sum=void 0,this.date=t,this.hourlyLoadProfiles=this.buildHourlyLoadProfiles(),this.max={kwdel:0,hour:0},this.sum={kwdel:0,kwhdel:0}}return Object(v.a)(e,[{key:"buildHourlyLoadProfiles",value:function(){return Object(h.a)(Array(24).keys()).map((function(e){return new E(e)}))}},{key:"addLoadProfileData",value:function(e){this.hourlyLoadProfiles[e.hour].addKwdel(e.kwdel,e.kwhdel,e.fileName)}},{key:"removeLoadProfileData",value:function(e){this.hourlyLoadProfiles.forEach((function(t){t.removeKwdel(e)}))}},{key:"genMaxAndSum",value:function(){var e,t=0,a=1,n=0,r=0,o=Object(f.a)(this.hourlyLoadProfiles);try{for(o.s();!(e=o.n()).done;){var i=e.value,l=i.getTotalKwdel();n+=l,r+=i.getRawTotalKwhdel(),l>t&&(a=i.hour,t=l)}}catch(c){o.e(c)}finally{o.f()}return this.max={kwdel:t,hour:a},this.sum={kwdel:n,kwhdel:r},{max:this.max,sum:this.sum}}}]),e}(),w=a(65),x=a.n(w);!function(e){e[e.JANUARY=0]="JANUARY",e[e.FEBRUARY=1]="FEBRUARY",e[e.MARCH=2]="MARCH",e[e.APRIL=3]="APRIL",e[e.MAY=4]="MAY",e[e.JUNE=5]="JUNE",e[e.JULY=6]="JULY",e[e.AUGUST=7]="AUGUST",e[e.SEPTEMBER=8]="SEPTEMBER",e[e.OCTOBER=9]="OCTOBER",e[e.NOVEMBER=10]="NOVEMBER",e[e.DECEMBER=11]="DECEMBER"}(n||(n={}));var O,A=n,P=function(){function e(t,a){Object(p.a)(this,e),this.month=void 0,this.year=void 0,this.startDate=void 0,this.enddDate=void 0,this.month=t,this.year=a,this.startDate=this.getStartDate(),this.enddDate=this.getEndDate()}return Object(v.a)(e,[{key:"getTotalDays",value:function(){return Math.round((this.enddDate.getTime()-this.startDate.getTime())/864e5)}},{key:"getStartDate",value:function(){var e=1===this.month?12:this.month-1,t=1===this.month?this.year-1:this.year;return x()("".concat(e,"/26/").concat(t),"MM/DD/YYYY").toDate()}},{key:"getEndDate",value:function(){return x()("".concat(this.month,"/25/").concat(this.year),"MM/DD/YYYY").toDate()}},{key:"equalsTo",value:function(e){return null!==this.month&&null!=e&&null!==e.month&&(this.month===e.month&&this.year===e.year)}},{key:"toString",value:function(){return"".concat(A[this.month-1]," ").concat(this.year)}}],[{key:"getBillingMonth",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=e;return t>=26&&(0===n&&0===a&&26===t||0===(r=++r%12)&&(r=12)),r}}]),e}();!function(e){e.TETUAN="Tetuan",e.MERCEDES="Mercedes",e.NORTHSIDE="Northside",e.ZAMPEN="Zampen",e.GUIWAN="Guiwan",e.TUMAGA="Tumaga",e.ARENA_BLANCO="Arena Blanco",e.PRESA="Presa",e.SAN_JOSE="San Jose",e.CALARIAN="Calarian",e.BALIWASAN="Baliwasan",e.DEDICATED_LINE="Dedicated Line",e.INTERCO="Interco (1-3MVA)",e.CULIANAN="Culianan",e.CURUAN="Curuan",e.FISHING_PORT="Fishing Port",e.TALISAYAN="Talisayan",e.LABUAN="Labuan",e.RECODO="Recodo",e.SINUNUC="Sinunuc",e.PERMEX="PERMEX (2-2MVA)",e.BIG_FISH="Big Fish (1-2MVA)",e.TIN_CAN_ORIENTAL="Tin Can Oriental (1-2MVA)",e.MEGA_FISHIN_CORP="Mega Fishing Corp. (1-4MVA)",e.MEGA_FISHIN_CORP2="Mega Fishing Corp. (1-3MVA)",e.PASONANCA="Pasonanca",e.SAN_ROQUE="San Roque",e.ACLEM="Aclem",e.GOVERNOR_ALVAREZ="Governor Alvarez",e.VETERANS_AVENUE="Veterans Avenue",e.NUNEZ="Nu\u0148ez",e.STA_CATALINA="Sta Catalina",e.RIO_HONDO="Rio Hondo",e.GUARDIA_NACIONAL="Guardia Nacional",e.CAMPANER="Campaner",e.KCC_MALL="KCC Mall (1-10MVA)"}(O||(O={}));var S=O,C=function(){function e(t,a,n,r,o){Object(p.a)(this,e),this.key=void 0,this.text=void 0,this.serialNumber=void 0,this.power=void 0,this.brand=void 0,this.key=t,this.text=a,this.serialNumber=n,this.power=r,this.brand=o}return Object(v.a)(e,[{key:"toString",value:function(){return this.key}}]),e}();C.HYOSUNG_20MVA=new C("HYOSUNG_20MVA","HYOSUNG PTX - 20MVA","TP99-8513",20,"HYOSUNG"),C.SHIHLIN_20MVA=new C("SHIHLIN_20MVA","SHIHLIN PTX - 20MVA","810014",20,"SHIHLIN"),C.SHIHLIN_10MVVA=new C("SHIHLIN_10MVVA ","SHIHLIN PTX - 10MVA","T990113",10,"SHIHLIN"),C.SHIHLIN_5MVA=new C("SHIHLIN_5MVA","SHIHLIN PTX - 5MVA","",5,"SHIHLIN"),C.NANJING_20MVA=new C("NANJING_20MVA","NANJING PTX - 20MVA","610205",20,"NANJING"),C.PRIME_MEIDEN_10MVA=new C("PRIME_MEIDEN_10MVA","PRIME MEIDEN PTX - 10MVA","",10,"PRIME MAIDEN"),C.NEW_KOREA_10MVA=new C("NEW_KOREA_10MVA","NEW KOREA PTX - 10MVA","W910009",10,"NEW KOREA"),C.NEW_KOREA_5MVA=new C("NEW_KOREA_5MVA","NEW KOREA PTX - 5MVA","920194",5,"NEW KOREA"),C.CHANGZHOU_10MVA=new C("CHANGZHOU_10MVA","CHANGZHOU PTX - 10MVA","91-61-146",10,"CHANGZHOU"),C.SHENDA_25MVA=new C("SHENDA_25MVA","SHENDA PTX - 25MVA","",25,"SHENDA");var I=C,N=function(){function e(t,a,n){Object(p.a)(this,e),this.transformer=void 0,this.feeders=void 0,this.substationKey=void 0,this.transformer=t,this.feeders=a,this.substationKey=n}return Object(v.a)(e,[{key:"toString",value:function(){return this.transformer.key}},{key:"isFeederExist",value:function(e){return this.feeders.has(e)}}]),e}(),M=function(){function e(t,a,n){Object(p.a)(this,e),this.key=void 0,this.text=void 0,this.substationItems=void 0,this.key=t,this.text=a,this.substationItems=n}return Object(v.a)(e,[{key:"toStrting",value:function(){return this.key}}]),e}();M.PUTIK=new M("PUTIK","PUTIK S/S",[new N(I.SHIHLIN_20MVA,new Set([S.GUIWAN,S.TUMAGA,S.ARENA_BLANCO,S.PRESA]),"PUTIK"),new N(I.HYOSUNG_20MVA,new Set([S.TETUAN,S.MERCEDES,S.NORTHSIDE,S.ZAMPEN]),"PUTIK")]),M.SANJOSE_GUSU=new M("SAN JOSE GUSU","SAN JOSE GUSU S/S",[new N(I.NANJING_20MVA,new Set([S.SAN_JOSE,S.CALARIAN,S.BALIWASAN,S.DEDICATED_LINE]),"SAN JOSE GUSU"),new N(I.NEW_KOREA_10MVA,new Set,"SAN JOSE GUSU")]),M.SANGALI=new M("SANGALI","SANGALI S/S",[new N(I.PRIME_MEIDEN_10MVA,new Set([S.CULIANAN,S.CURUAN,S.FISHING_PORT]),"SANGALI")]),M.AYALA=new M("AYALA","AYALA S/S",[new N(I.SHIHLIN_10MVVA,new Set([S.TALISAYAN,S.LABUAN]),"AYALA")]),M.RECODO=new M("RECODO","RECODO S/S",[new N(I.NEW_KOREA_10MVA,new Set([S.RECODO]),"RECODO"),new N(I.NEW_KOREA_5MVA,new Set([S.SINUNUC]),"RECODO"),new N(I.SHIHLIN_5MVA,new Set([]),"RECODO")]),M.CABATANGAN=new M("CABATANGAN","CABATANGAN S/S",[new N(I.CHANGZHOU_10MVA,new Set([S.PASONANCA]),"CABATANGAN"),new N(I.PRIME_MEIDEN_10MVA,new Set([S.SAN_ROQUE]),"CABATANGAN")]),M.CAMANCHILI=new M("CAMANCHILI","CAMANCHILI S/S",[new N(I.SHIHLIN_20MVA,new Set([S.ACLEM,S.GOVERNOR_ALVAREZ,S.VETERANS_AVENUE,S.NUNEZ]),"CAMANCHILI"),new N(I.SHENDA_25MVA,new Set([S.STA_CATALINA,S.RIO_HONDO,S.GUARDIA_NACIONAL,S.CAMPANER]),"CAMANCHILI")]),M.ALL=[M.PUTIK,M.RECODO,M.SANGALI,M.SANJOSE_GUSU,M.AYALA,M.CABATANGAN,M.CAMANCHILI];var D=M,j=function(){function e(t,a){Object(p.a)(this,e),this.key=void 0,this.substations=void 0,this.key=t,this.substations=a}return Object(v.a)(e,[{key:"toString",value:function(){return this.key}},{key:"getFeeders",value:function(){var e,t=[],a=Object(f.a)(this.substations);try{for(a.s();!(e=a.n()).done;){var n,r=e.value,o=Object(f.a)(r.substationItems);try{for(o.s();!(n=o.n()).done;){var i=n.value;t=[].concat(Object(h.a)(t),Object(h.a)(i.feeders))}}catch(l){o.e(l)}finally{o.f()}}}catch(l){a.e(l)}finally{a.f()}return t}}],[{key:"getMeteringPoint",value:function(e){switch(e.toUpperCase()){case this.MF3MPITZAMC01.key:return this.MF3MPITZAMC01;case this.MF3MPITZAMC02.key:return this.MF3MPITZAMC02;case this.MF3MPITZAMC03.key:return this.MF3MPITZAMC03;case this.MF3MPITZAMC04.key:return this.MF3MPITZAMC04;case this.MF3MPITZAMC05.key:return this.MF3MPITZAMC05;case this.MF3MPITZAMC06.key:return this.MF3MPITZAMC06;case this.MF3MPITZAMC07.key:return this.MF3MPITZAMC07;default:return null}}},{key:"exists",value:function(e){switch(e){case this.MF3MPITZAMC01.key:case this.MF3MPITZAMC02.key:case this.MF3MPITZAMC03.key:case this.MF3MPITZAMC04.key:case this.MF3MPITZAMC05.key:case this.MF3MPITZAMC06.key:case this.MF3MPITZAMC07.key:return!0;default:return!1}}}]),e}();j.MF3MPITZAMC01=new j("MF3MPITZAMC01",[D.PUTIK]),j.MF3MPITZAMC02=new j("MF3MPITZAMC02",[D.SANJOSE_GUSU]),j.MF3MPITZAMC03=new j("MF3MPITZAMC03",[D.SANGALI]),j.MF3MPITZAMC04=new j("MF3MPITZAMC04",[D.RECODO,D.AYALA]),j.MF3MPITZAMC05=new j("MF3MPITZAMC05",[D.CABATANGAN]),j.MF3MPITZAMC06=new j("MF3MPITZAMC06",[]),j.MF3MPITZAMC07=new j("MF3MPITZAMC07",[D.CAMANCHILI]);var k=j;function F(e,t){var a,n=Object(f.a)(t);try{for(n.s();!(a=n.n()).done;){var r=a.value;if(e.toUpperCase().trim()===r.toUpperCase().trim())return!0}}catch(o){n.e(o)}finally{n.f()}return!1}var T,L=Object.freeze({findSubstationOfFeeder:function(e){var t,a=Object(f.a)(D.ALL);try{for(a.s();!(t=a.n()).done;){var n,r=t.value,o=Object(f.a)(r.substationItems.values());try{for(o.s();!(n=o.n()).done;){var i=n.value;if(F(e,Object(h.a)(i.feeders.values())))return r}}catch(l){o.e(l)}finally{o.f()}}}catch(l){a.e(l)}finally{a.f()}return null},getYears:function(){for(var e=[],t=(new Date).getFullYear(),a=2012;a<=t;a++)e.push(a);return e},getMonths:function(){for(var e=[],t=1,a=0,n=Object.values(A);a<n.length;a++){var r=n[a];isNaN(Number(r))&&(e.push({month:String(r),monthNum:t}),t++)}return e},findFeeder:function(e){e=e.toUpperCase().trim();for(var t=0,a=Object.values(S);t<a.length;t++){var n=a[t];if(n.toUpperCase().trim()===e)return n.toUpperCase().trim()}return null},findSubstationItemOfFeeder:function(e,t){var a,n=Object(f.a)(t.substationItems.values());try{for(n.s();!(a=n.n()).done;){var r=a.value;if(F(e,Object(h.a)(r.feeders.values())))return r}}catch(o){n.e(o)}finally{n.f()}return null}}),R=function e(t,a,n,r,o,i,l,c,s){var d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";if(Object(p.a)(this,e),this.kwdel=void 0,this.kwhdel=void 0,this.hour=void 0,this.day=void 0,this.month=void 0,this.year=void 0,this.minute=void 0,this.meteringPoint=void 0,this.row=void 0,this.billingPeriod=void 0,this.fileName=void 0,this.kwdel=t,this.kwhdel=a,this.day=n,this.hour=i,this.month=r,this.year=o,this.minute=l,this.meteringPoint=c,this.row=s,this.fileName=d,0===this.hour&&0===this.minute)if(this.hour=23,this.minute=59,this.day-1<=0){var u=new Date("".concat(this.year,"/").concat(this.month,"/").concat(this.day));u.setDate(u.getDate()-1),this.day=u.getDate(),this.month=u.getMonth()+1,this.year=u.getFullYear()}else this.day--;var m=P.getBillingMonth(this.month,this.day,this.hour,this.minute);this.billingPeriod=new P(m,this.year),0===this.minute&&(this.hour--,this.hour<0&&(this.hour=23))},_=function(){function e(t){Object(p.a)(this,e),this.meteringPoint=void 0,this.dailyLoadProfiles=void 0,this.max=void 0,this.sum=void 0,this.meteringPoint=t,this.dailyLoadProfiles=new Map,this.max={kwdel:0,hour:1,meteringPoint:"",date:new Date},this.sum={kwdel:0,kwhdel:0,meteringPoint:this.meteringPoint}}return Object(v.a)(e,[{key:"addLoadProfileData",value:function(e,t){var a;this.dailyLoadProfiles.has(t)||this.dailyLoadProfiles.set(t,new y(new Date(t))),null===(a=this.dailyLoadProfiles.get(t))||void 0===a||a.addLoadProfileData(e)}},{key:"removeLoadPRofileData",value:function(e){this.dailyLoadProfiles.forEach((function(t){t.removeLoadProfileData(e)}))}},{key:"getDailyLoadProfile",value:function(e){return this.dailyLoadProfiles.has(e)?this.dailyLoadProfiles.get(e):new y(new Date(e))}},{key:"genMaxAndSum",value:function(){var e,t=0,a=0,n=0,r=1,o=new Date,i=Object(f.a)(this.dailyLoadProfiles.values());try{for(i.s();!(e=i.n()).done;){var l=e.value,c=l.max,s=l.sum.kwdel,d=l.sum.kwhdel;console.log("Sum for day ".concat(l.date.toLocaleDateString()," is: ").concat(d)),a+=d,n+=s,c.kwdel>t&&(t=c.kwdel,r=c.hour,o=l.date)}}catch(u){i.e(u)}finally{i.f()}return console.log("Sum for ".concat(this.meteringPoint," is: ").concat(a)),this.max={kwdel:t,hour:r,date:o,meteringPoint:this.meteringPoint},this.sum={kwdel:n,kwhdel:a,meteringPoint:this.meteringPoint},{max:this.max,sum:this.sum}}}]),e}(),H=function e(){Object(p.a)(this,e),this.meteringPoint=void 0,this.kwdel=void 0,this.hour=void 0,this.date=void 0,this.meteringPoint="",this.kwdel=0,this.hour=0,this.date=new Date},W=function(){function e(t){Object(p.a)(this,e),this.loadProfiles=void 0,this.billingPeriod=void 0,this.dateStrings=void 0,this.coincidentPeak=void 0,this.nonCoincidentPeak=void 0,this.diversityFactor=void 0,this.loadProfilesMax=void 0,this.loadProfilesSum=void 0,this.totalLoadpRofile=void 0,this.chartData=void 0,this.billingPeriod=t,this.loadProfiles=new Map,this.dateStrings=new Set,this.totalLoadpRofile=new _("Total"),this.coincidentPeak=new H,this.nonCoincidentPeak=0,this.diversityFactor=0,this.loadProfilesMax=[],this.loadProfilesSum=[],this.chartData=new Map}return Object(v.a)(e,[{key:"addData",value:function(e){var t,a=e.meteringPoint,n="".concat(e.month,"/").concat(e.day,"/").concat(e.year);this.dateStrings.has(n)||this.dateStrings.add(n),this.loadProfiles.has(a)||this.loadProfiles.set(a,new _(a)),null===(t=this.loadProfiles.get(a))||void 0===t||t.addLoadProfileData(e,n)}},{key:"removeData",value:function(e,t){var a=this;t.forEach((function(t){if(a.loadProfiles.has(t)){var n=a.loadProfiles.get(t);null===n||void 0===n||n.removeLoadPRofileData(e)}}))}},{key:"resetData",value:function(){this.nonCoincidentPeak=0,this.loadProfilesMax=[],this.loadProfilesSum=[],this.totalLoadpRofile=new _("Total"),this.chartData=new Map}},{key:"extractDataThenAddToTotal",value:function(e,t){var a=new R(e.getTotalKwdel(),e.getTotalKwhdel(),t.date.getDate(),t.date.getMonth()+1,t.date.getFullYear(),e.hour,3,"Total",0),n="".concat(a.month,"/").concat(a.day,"/").concat(a.year);this.totalLoadpRofile.addLoadProfileData(a,n)}},{key:"extractDailyLoadProfileTotalKwdelThenAddToData",value:function(e,t){var a="".concat(e.date.getMonth()+1,"/").concat(e.date.getDate());if(this.chartData.has(a)){this.chartData.get(a)["".concat(t.meteringPoint)]=e.sum.kwdel}else{var n={date:a};n["".concat(t.meteringPoint)]=e.sum.kwdel,this.chartData.set(a,n)}}},{key:"initOtherDetails",value:function(){this.resetData();var e,t=Object(f.a)(this.loadProfiles.values());try{for(t.s();!(e=t.n()).done;){for(var a=e.value,n=0,r=Object(h.a)(a.dailyLoadProfiles.values());n<r.length;n++){var o=r[n];o.genMaxAndSum();var i,l=Object(f.a)(o.hourlyLoadProfiles);try{for(l.s();!(i=l.n()).done;){var c=i.value;this.extractDataThenAddToTotal(c,o)}}catch(y){l.e(y)}finally{l.f()}this.extractDailyLoadProfileTotalKwdelThenAddToData(o,a)}var s=a.genMaxAndSum(),d=s.max,u=s.sum;0===u.kwdel?this.loadProfiles.delete(a.meteringPoint):(this.loadProfilesMax.push(d),this.loadProfilesSum.push(u),this.nonCoincidentPeak+=d.kwdel)}}catch(y){t.e(y)}finally{t.f()}var m,b=Object(f.a)(this.totalLoadpRofile.dailyLoadProfiles.values());try{for(b.s();!(m=b.n()).done;){var g,p=m.value,v=Object(f.a)(p.hourlyLoadProfiles);try{for(v.s();!(g=v.n()).done;){var E=g.value;E.getRawTotal()>this.coincidentPeak.kwdel&&(this.coincidentPeak.kwdel=E.getRawTotal(),this.coincidentPeak.date=p.date,this.coincidentPeak.hour=E.hour,this.coincidentPeak.meteringPoint="Total")}}catch(y){v.e(y)}finally{v.f()}}}catch(y){b.e(y)}finally{b.f()}this.diversityFactor=this.nonCoincidentPeak/this.coincidentPeak.kwdel,console.log({info:"max and sum",max:this.loadProfilesMax,sum:this.loadProfilesSum,coincidental:this.coincidentPeak,nonCoincidental:this.nonCoincidentPeak,diversityFactor:this.diversityFactor,totalLoadProfile:this.totalLoadpRofile,chartData:this.chartData,hourlyLoadpRofiles:[]})}}]),e}(),G=Object(r.createContext)({updateLoadProfiles:function(e){},monthlyLoadProfiles:new Map,working:!1,deleteLoadProfiles:function(e){}}),U=function(e){var t=e.children,a=(Object(g.a)(e,["children"]),Object(r.useState)(new Map)),n=Object(b.a)(a,2),i=n[0],l=n[1],c=Object(r.useState)([]),s=Object(b.a)(c,2),d=s[0],u=s[1],m=Object(r.useState)(!1),p=Object(b.a)(m,2),v=p[0],E=p[1];return Object(r.useEffect)((function(){}),[i]),Object(r.useEffect)((function(){if(!v)if(d.length<=0)E(!1);else{var e,t,a,n=Object(h.a)(d),r=n.pop();r&&(E(!0),Array.isArray(r)?(console.log("Data instance of ARRRRAAAAY...."),(a=r,new Promise((function(e,t){console.log("Processing rawDatas");var n,r=new Map(i),o=Object(f.a)(a);try{for(o.s();!(n=o.n()).done;){var l,c=n.value,s="".concat(c.billingPeriod.month,"-").concat(c.year);r.has(s)||r.set(s,new W(c.billingPeriod)),null===(l=r.get(s))||void 0===l||l.addData(c)}}catch(d){o.e(d)}finally{o.f()}r.forEach((function(e){return e.initOtherDetails()})),e(r)}))).then((function(e){l(e),E(!1),u(n)}))):(console.log("Data instance of ARRRRAAAAY...."),(e=r.fileName,t=r.meteringPoints,new Promise((function(a,n){console.log("DELETING LAODP ROFILESS");var r,o=new Map(i),l=Object(f.a)(o.keys());try{for(l.s();!(r=l.n()).done;){var c=r.value,s=o.get(c);null===s||void 0===s||s.removeData(e,t)}}catch(d){l.e(d)}finally{l.f()}o.forEach((function(e){if(e.initOtherDetails(),0===e.nonCoincidentPeak){var t="".concat(e.billingPeriod.month,"-").concat(e.billingPeriod.year);o.delete(t)}})),a(o)}))).then((function(e){l(e),E(!1),u(n)}))))}}),[d]),o.a.createElement(G.Provider,{value:{updateLoadProfiles:function(e){u((function(t){return[].concat(Object(h.a)(t),[e])}))},monthlyLoadProfiles:i,deleteLoadProfiles:function(e){u((function(t){return[].concat(Object(h.a)(t),[e])}))},working:v}},t)},V=a(42),K=a(187),B=a(222),Y=a(188),Z=a(189),z=a(233),J=a(183),$=Object(d.a)((function(e){return{root:{border:"none",borderRadius:0,"&.Mui-selected":{backgroundColor:e.palette.background.default,color:e.palette.primary.main},"&:hover, &.Mui-selected:hover":{color:e.palette.primary.main,backgroundColor:e.palette.background.default},selected:{}}}})),X=function(e){var t=e.value,a=e.children,n=Object(g.a)(e,["value","children"]),r=$();return o.a.createElement(J.a,Object.assign({classes:{root:r.root},value:t},n),a)},q=Object(d.a)((function(e){return{root:{width:50,height:"100%",zIndex:e.zIndex.drawer+10},container:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",height:"100%",width:"100%"},toggleButtonsContainer:{},otherButtonsContainer:{display:"flex",flexDirection:"column"}}}));!function(e){e.FILES="files",e.SETTINGS="settings",e.NONE=""}(T||(T={}));var Q,ee=function(e){var t=e.onFilesToggled,a=e.onSettingsToggled,n=e.onSettingsUntoggled,i=e.onFilesUntoggled,l=(Object(g.a)(e,["onFilesToggled","onSettingsToggled","onSettingsUntoggled","onFilesUntoggled"]),Object(r.useState)(T.FILES)),c=Object(b.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(T.NONE),m=Object(b.a)(u,2),f=m[0],h=m[1];var p=q();return o.a.createElement(K.a,{elevation:4,className:p.root,position:"static",color:"inherit"},o.a.createElement(B.a,{className:p.container},o.a.createElement(B.a,{className:p.toggleButtonsContainer},o.a.createElement(z.a,{onChange:function(e,a){console.log({method:"handleToggleChange()",params:{newToggle:a}});var n=s;d(a),a===T.FILES?t():n===T.FILES&&i()},value:s,exclusive:!0},o.a.createElement(X,{value:T.FILES},o.a.createElement(Y.a,null)))),o.a.createElement(B.a,{className:p.otherButtonsContainer},o.a.createElement(z.a,{onChange:function(e,t){console.log({method:"handleOtherToggleChange()",params:{newToggle:t}});var r=f;h(t),t===T.SETTINGS?a():r===T.SETTINGS&&n()},value:f,exclusive:!0},o.a.createElement(X,{value:T.SETTINGS},o.a.createElement(Z.a,null))))))},te=a(230),ae=a(93),ne=a(225),re=Object(d.a)((function(e){return Object(ne.a)({drawer:{width:300,flexShrink:0},drawerPaper:{width:300,position:"static",borderLeft:"1px solid ".concat(e.palette.divider),borderRight:"1px solid ".concat(e.palette.divider)},drawerHeader:Object(ae.a)(Object(ae.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-300},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}})})),oe=a(13),ie=a.n(oe),le=a(25),ce=a(226),se=a(227),de=a(95),ue=a(191),me=a(190),fe=Object(d.a)((function(e){return Object(ne.a)({accordion:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"},expanded:{}},accordionSummary:{borderBottom:"1px solid rgba(0, 0, 0, .125)",marginBottom:-1,minHeight:30,"&$expanded":{minHeight:30,backgroundColor:"black"},expanded:{}},content:{margin:2},accordionTitle:{fontSize:"0.8rem",asdf:{}},expanded:{},accordionDetails:{backgroundColor:e.palette.background.default,padding:"5px",position:"relative"}})})),he=function(e){e.expandedPanel;var t=e.onPanelChange,a=e.panelName,n=e.title,r=(e.render,e.children),i=(Object(g.a)(e,["expandedPanel","onPanelChange","panelName","title","render","children"]),fe());return o.a.createElement(ce.a,{className:i.accordion,square:!0,onChange:function(e,n){t(n?a:"")}},o.a.createElement(se.a,{className:i.accordionSummary,classes:{content:i.content},expandIcon:o.a.createElement(me.a,null)},o.a.createElement(de.a,{className:i.accordionTitle},n)),o.a.createElement(ue.a,{className:i.accordionDetails},r))},be=a(192),ge=a(193),pe=a(195),ve=a(197),Ee=a(198),ye=a(199),we=a(194),xe=Object(d.a)((function(e){return{root:{zIndex:e.zIndex.mobileStepper,maxWidth:"100%",fontSize:"0.8rem",boxSizing:"border-box",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),padding:10,overflowWrap:"break-word",wordWrap:"break-word"},filename:{fontSize:"1em",color:e.palette.text.primary},progress_text:{fontSize:"0.7em",color:e.palette.text.secondary,alignSelf:"flex-end"},content:{display:"flex",flexDirection:"column",gap:"5px",justifyContent:"center"},progress_content:{display:"flex",flexDirection:"column",gap:"3px"},action:{},button:{textTransform:"none"},error_container:{maxWidth:"100%",width:"550px"},error_text:{fontSize:"0.9rem",padding:"10px 5px",whiteSpace:"pre-wrap"}}})),Oe=function(e){var t=e.file,a=e.progress,n=e.progressInfo,i=e.errors,l=void 0===i?[]:i,c=e.onRemoveFile,s=(Object(g.a)(e,["file","progress","progressInfo","errors","onRemoveFile"]),xe()),d=Object(r.useState)(!1),u=Object(b.a)(d,2),m=u[0],f=u[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:s.root},o.a.createElement("div",{className:s.content},o.a.createElement(de.a,{className:s.filename},t.name),o.a.createElement("div",{className:s.progress_content},o.a.createElement(be.a,{value:a,variant:0===a||100===a?"determinate":"indeterminate"}),o.a.createElement(de.a,{className:s.progress_text},n))),o.a.createElement("div",{className:s.action},0!==l.length&&o.a.createElement(ge.a,{className:s.button,size:"small",color:"secondary",startIcon:o.a.createElement(we.a,{color:"error"}),onClick:function(){f(!0)}},"see errors"),o.a.createElement(ge.a,{className:s.button,onClick:c,size:"small",color:"primary"},"Remove"))),o.a.createElement(pe.a,{open:m,onClose:function(){f(!1)}},o.a.createElement(ve.a,null,o.a.createElement(de.a,{variant:"h6",color:"error"},"Errors"),o.a.createElement(de.a,{variant:"subtitle1",color:"textSecondary"},t.name),o.a.createElement(Ee.a,null)),o.a.createElement(ye.a,null,o.a.createElement(B.a,{overflow:"auto",padding:"5px 25px"},l.map((function(e,t){return o.a.createElement("div",{key:t,className:s.error_container},o.a.createElement(de.a,{component:"p",className:s.error_text,key:"".concat(t,"~error")},e),o.a.createElement(Ee.a,null))}))))))};!function(e){e.KWDEL="lp_kwdelCol",e.KWHDEL="lp_kwhdelCol",e.DATE="lp_dateCol",e.TIME="lp_timeCol",e.DATE_FORMAT="lp_dateFormat",e.TIME_FORMAT="lp_timeFormat"}(Q||(Q={}));var Ae={loadSettings:function(){return{kwdelCol:Number(localStorage.getItem(Q.KWDEL)||"1"),dateCol:Number(localStorage.getItem(Q.DATE)||"2"),timeCol:Number(localStorage.getItem(Q.TIME)||"3"),dateFormat:localStorage.getItem(Q.DATE_FORMAT)||"MM/DD/YYYY",timeFormat:localStorage.getItem(Q.TIME_FORMAT)||"HH:mm",kwhdelCol:Number(localStorage.getItem(Q.KWHDEL)||"4")}},saveSettings:function(e){localStorage.setItem(Q.KWDEL,String(e.kwdelCol)),localStorage.setItem(Q.TIME,String(e.timeCol)),localStorage.setItem(Q.DATE,String(e.dateCol)),localStorage.setItem(Q.DATE_FORMAT,String(e.dateFormat)),localStorage.setItem(Q.TIME_FORMAT,String(e.timeFormat)),localStorage.setItem(Q.KWHDEL,e.kwhdelCol.toString())}},Pe=a(20),Se=a.n(Pe),Ce=a(103),Ie=a(109),Ne=a(110),Me=function(e){Object(Ce.a)(a,e);var t=Object(Ie.a)(a);function a(e){return Object(p.a)(this,a),t.call(this,e)}return a}(Object(Ne.a)(Error));function De(){return(De=Object(le.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){console.log("FileUTils: Timeout wait for 10 secs....");var n=t.name.split(".")[1];console.log({method:"extractWorkbookFromFile()",parameteres:{file:t},fileTypeSplit:t.name.split("."),fileExtension:n}),"xlsx"!==n&&a(new Me("Invalid file: expected: .xlsx received: ".concat(n)));var r=new FileReader;r.onload=function(t){try{var n,r=new Uint8Array(null===(n=t.target)||void 0===n?void 0:n.result),o=Se.a.read(r,{type:"array",cellDates:!0});e(o)}catch(i){a(new Error(i))}},r.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=Object.freeze({extractWorkbookFromFile:function(e){return De.apply(this,arguments)}}),ke=function(){function e(){Object(p.a)(this,e)}return Object(v.a)(e,null,[{key:"extractDate",value:function(e,t){var a=null,n=null,r=null;return e?"d"!==e.t?"s"===e.t?(r=x()(e.v||e.w||e.r,t)).isValid()?a=r.toDate():n=" ".concat(e.v," does not match the date format in setstings ").concat(t):n="Invalid Cell Value: Expected Date, received: ".concat(e.v):a=e.v:n="Cell is empty",{date:a,error:n}}},{key:"extractNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=null,n=null;return e?"n"===e.t||Number(e.v||e.w)?a=Number(e.r||e.v):n="Invalid Cell Value: Expected number, received: ".concat(e.v):t?n="Cell is empty":a=0,{number:a,error:n}}},{key:"extractText",value:function(e){var t=null,a=null;return e?"s"!==e.t?t="Invalid Cell Value: Expected Text, received: ".concat(e.v):a=e.v:t="Cell is empty",{text:a,error:t}}},{key:"calculatePercent",value:function(e,t){return new Promise((function(a,n){setTimeout((function(){a(e/t*100)}),0)}))}}]),e}();function Fe(e,t){return new Promise((function(a,n){setTimeout((function(){a(e/t*100)}),0)}))}function Te(e,t,a,n){var r={c:n.kwdelCol,r:t},o={c:n.dateCol,r:t},i={c:n.timeCol,r:t},l={c:n.kwhdelCol,r:t},c=Se.a.utils.encode_cell(r),s=Se.a.utils.encode_cell(o),d=Se.a.utils.encode_cell(i),u=Se.a.utils.encode_cell(l);return{kwdelCell:e[c],timeCell:e[d],dateCell:e[s],kwhdelCell:e[u],sheetName:a,row:t}}function Le(e,t,a){var n=null,r=ke.extractNumber(e.kwdelCell),o=ke.extractNumber(e.kwhdelCell),i=ke.extractDate(e.dateCell,t.dateFormat),l=ke.extractDate(e.timeCell,t.timeFormat);if(Boolean(r.error||i.error||l.error||o.error))throw n="Errors in row ".concat(e.row+1,":\n"),r.error&&(n=n.concat("\tKwdel Cell: ".concat(r.error,"\n"))),i.error&&(n=n.concat("\tDate Cell: ".concat(i.error,"\n"))),l.error&&(n=n.concat("\tTime Cell: ".concat(l.error,"\n"))),o.error&&(n=n.concat("\tKwhdel Cell: ".concat(l.error,"\n"))),new Error(n);var c,s,d,u,m,f=o.number,h=r.number,b=null===(c=i.date)||void 0===c?void 0:c.getDate(),g=null===(s=i.date)||void 0===s?void 0:s.getMonth(),p=null===(d=l.date)||void 0===d?void 0:d.getHours(),v=null===(u=l.date)||void 0===u?void 0:u.getMinutes(),E=null===(m=i.date)||void 0===m?void 0:m.getFullYear();return new R(h,f,b,g+1,E,p,v,e.sheetName,e.row,a)}var Re,_e=function(e,t,a){return new Promise(function(){var n=Object(le.a)(ie.a.mark((function n(r,o){var i,l,c,s,d,u,m,h,b,g,p,v,E,y;return ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t){n.next=4;break}return o(new Error("Invalid file")),a("tsk, wrong file",100),n.abrupt("return");case 4:console.log("Parsing workbook..."),i=[],l=[],c=[],s=Object(f.a)(t.SheetNames),n.prev=9,s.s();case 11:if((d=s.n()).done){n.next=38;break}if(u=d.value,k.exists(u)){n.next=16;break}return l.push("Invalid sheetname: ".concat(u,", expected: MF3MPITZAMC01~7")),n.abrupt("continue",36);case 16:if(c.push(u),a("Parsing ".concat(u),0),console.log("Parsing worksheet: "+u),(m=t.Sheets[u])["!ref"]){n.next=22;break}return n.abrupt("continue",36);case 22:return h=Se.a.utils.decode_range(m["!ref"]),n.next=25,Promise.resolve(h.e.r-h.s.r);case 25:b=n.sent,g=0;case 27:if(!(g<=h.e.r)){n.next=36;break}return n.next=30,Fe(g,b);case 30:p=n.sent,a("Processing rows ".concat(g,"/").concat(b," ").concat(p.toFixed(0),"%"),p);try{v=Ae.loadSettings(),E=Te(m,g,u,v),y=Le(E,v,e),i.push(y)}catch(w){l.push(w.message)}case 33:g++,n.next=27;break;case 36:n.next=11;break;case 38:n.next=43;break;case 40:n.prev=40,n.t0=n.catch(9),s.e(n.t0);case 43:return n.prev=43,s.f(),n.finish(43);case 46:console.log("finished"),r({value:i,errors:l,meteringPoints:c});case 48:case"end":return n.stop()}}),n,null,[[9,40,43,46]])})));return function(e,t){return n.apply(this,arguments)}}())},He=function(e){var t=e.file,a=e.render,n=e.onFileParsed,i=e.onRemoveFile,l=(Object(g.a)(e,["file","render","onFileParsed","onRemoveFile"]),Object(r.useState)(0)),c=Object(b.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(""),m=Object(b.a)(u,2),f=m[0],p=m[1],v=Object(r.useState)([]),E=Object(b.a)(v,2),y=E[0],w=E[1],x=Object(r.useState)([]),O=Object(b.a)(x,2),A=O[0],P=O[1];function S(e,t){d(t),p(e)}return Object(r.useEffect)((function(){je.extractWorkbookFromFile(t).then((function(e){return _e(t.name,e,S)})).then((function(e){var t;w(e.errors),t=e.value,n(t),P((function(t){return[].concat(Object(h.a)(t),Object(h.a)(e.meteringPoints))}))})).catch((function(e){console.error(e),y.push(e.message)}))}),[]),o.a.createElement(o.a.Fragment,null,a({progress:s,progressInfo:f,file:t,errors:y,onRemoveFile:function(){i(t,A)}}))},We=a(3),Ge=a(108),Ue=Object(d.a)((function(e){return{dropZone:{height:"100%",width:"100%",cursor:"pointer",minHeight:50},dropZone_focused:{border:"2px dashed ".concat(e.palette.text.secondary)},dropZone_content:{display:"flex",flexDirection:"column",maxWidth:"100%",gap:"10px",flexWrap:"wrap",margin:5},dropZoneText:{fontSize:"0.8rem",fontWeight:"bold",padding:"5px"}}})),Ve=function(e){var t=e.helperText,a=void 0===t?"":t,n=e.onFileDrop,i=e.onDragEnter,l=e.onDragLeave,c=(e.onDragOver,e.children),s=(Object(g.a)(e,["helperText","onFileDrop","onDragEnter","onDragLeave","onDragOver","children"]),Object(r.useState)(!1)),d=Object(b.a)(s,2),u=d[0],m=d[1],f=Ue();function h(){m(!0),i()}function p(){m(!1),l()}return o.a.createElement(B.a,{display:"flex",flexDirection:"column",width:"100%"},o.a.createElement(Ge.a,{onDrop:n,onDragEnter:h,onDragLeave:p},(function(e){var t=e.getRootProps,n=e.getInputProps;return o.a.createElement("section",{onMouseEnter:h,onMouseLeave:p,className:Object(We.a)(f.dropZone,Object(V.a)({},f.dropZone_focused,u))},o.a.createElement("div",t({className:"".concat(f.dropZone_content)}),o.a.createElement("input",n()),o.a.createElement(de.a,{variant:"subtitle1",color:"textSecondary",className:f.dropZoneText},a)))})),o.a.createElement(B.a,{display:"flex",flexDirection:"column",maxWidth:"100%",gridGap:5,marginTop:1},c))},Ke=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=(Object(g.a)(e,["expandedPanel","onPanelChange"]),Object(r.useState)(new Map)),i=Object(b.a)(n,2),l=i[0],c=i[1],s=Object(r.useContext)(G);function d(){return(d=Object(le.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){c((function(t){if(t.has(e.name))return t;var a=new Map(t);return a.set(e.name,e),a}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){s.updateLoadProfiles(e)}function m(e,t){c((function(t){var a=new Map(t);return a.delete(e.name),a})),s.deleteLoadProfiles({fileName:e.name,meteringPoints:t})}return o.a.createElement(he,{onPanelChange:a,title:"Load Profile Files",panelName:"laodprofile_filespanel",expandedPanel:t},o.a.createElement(Ve,{onDragEnter:function(){},onDragLeave:function(){},onFileDrop:function(e){return d.apply(this,arguments)},helperText:"Drop files here"},Object(h.a)(l.values()).map((function(e){return o.a.createElement(He,{onFileParsed:u,key:e.name,file:e,onRemoveFile:m,render:function(e){return o.a.createElement(Oe,{progress:e.progress,progressInfo:e.progressInfo,file:e.file,errors:e.errors,onRemoveFile:e.onRemoveFile})}})}))))};!function(e){e.DATE="mis_date",e.DURATION="mis_duration",e.DATE_FORMAT="mis_dateformat",e.FEEDER="mis_feeder"}(Re||(Re={}));var Be=Object.freeze({createRawDataObject:function(e,t,a,n){var r=P.getBillingMonth(a.getMonth()+1,a.getDay()),o=new P(r,a.getFullYear());return{duration:e,feeder:t,date:a,billingPeriod:o,fileName:n}},saveSettings:function(e){localStorage.setItem(Re.DATE,e.dateCol.toString()),localStorage.setItem(Re.DURATION,e.durationCol.toString()),localStorage.setItem(Re.DATE_FORMAT,e.dateFormat),localStorage.setItem(Re.FEEDER,e.feederCol.toString())},loadSettings:function(){return{dateCol:Number(localStorage.getItem(Re.DATE))||0,durationCol:Number(localStorage.getItem(Re.DURATION))||1,dateFormat:localStorage.getItem(Re.DATE_FORMAT)||"MM/DD/YYYY",feederCol:Number(localStorage.getItem(Re.FEEDER))||2}}});function Ye(e,t,a){var n=null,r=null,o=ke.extractDate(e.date,t.dateFormat),i=ke.extractText(e.feeder),l=ke.extractNumber(e.duration),c=null;if(i.text&&((c=L.findFeeder(i.text))||(i.error="Feeder value ".concat(i.text," does not match any of the registered feeders"))),Boolean(o.error||l.error||i.error))throw n="Errors in row ".concat(e.row+1,":\n"),l.error&&(n=n.concat("\tDuration Cell: ".concat(l.error,"\n"))),o.error&&(n=n.concat("\tDate Cell: ".concat(o.error,"\n"))),i.error&&(n=n.concat("\tFeeder Cell: ".concat(i.error,"\n"))),new Error(n);var s=l.number,d=o.date;return r=Be.createRawDataObject(s,c,d,a),console.log({rawData:r}),r}function Ze(e,t,a){var n={c:a.dateCol,r:t},r={c:a.feederCol,r:t},o={c:a.durationCol,r:t},i=Se.a.utils.encode_cell(n),l=Se.a.utils.encode_cell(r),c=Se.a.utils.encode_cell(o);return{feeder:e[l],date:e[i],duration:e[c],row:t}}var ze=Object.freeze({extractRawDatasFromWorkbook:function(e,t,a){return new Promise(function(){var n=Object(le.a)(ie.a.mark((function n(r,o){var i,l,c,s,d,u,m,h,b,g,p,v,E;return ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=[],l=[],console.log("MonthllyInterruption Workbook: "),console.log(t),c=Object(f.a)(t.SheetNames),n.prev=5,c.s();case 7:if((s=c.n()).done){n.next=30;break}if(d=s.value,u=t.Sheets[d],a("Parsing ".concat(d),0),console.log("Parsing worksheet: "+d),u["!ref"]){n.next=14;break}return n.abrupt("continue",28);case 14:return m=Se.a.utils.decode_range(u["!ref"]),n.next=17,Promise.resolve(m.e.r-m.s.r);case 17:h=n.sent,b=0;case 19:if(!(b<=m.e.r)){n.next=28;break}return n.next=22,ke.calculatePercent(b,h);case 22:g=n.sent,a("Processing rows ".concat(b,"/").concat(h," ").concat(g.toFixed(0),"%"),g);try{p=Be.loadSettings(),v=Ze(u,b,p),E=Ye(v,p,e),l.push(E)}catch(o){i.push(o.message)}case 25:b++,n.next=19;break;case 28:n.next=7;break;case 30:n.next=35;break;case 32:n.prev=32,n.t0=n.catch(5),c.e(n.t0);case 35:return n.prev=35,c.f(),n.finish(35);case 38:r({value:l,errors:i});case 39:case"end":return n.stop()}}),n,null,[[5,32,35,38]])})));return function(e,t){return n.apply(this,arguments)}}())}}),Je=function(e){var t=e.file,a=e.render,n=e.onFileParsed,i=e.onRemoveFile,l=(Object(g.a)(e,["file","render","onFileParsed","onRemoveFile"]),Object(r.useState)(0)),c=Object(b.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(""),m=Object(b.a)(u,2),f=m[0],h=m[1],p=Object(r.useState)([]),v=Object(b.a)(p,2),E=v[0],y=v[1];function w(e,t){d(t),h(e)}return Object(r.useEffect)((function(){je.extractWorkbookFromFile(t).then((function(e){return ze.extractRawDatasFromWorkbook(t.name,e,w)})).then((function(e){var t;y(e.errors),t=e.value,n(t)})).catch((function(e){console.error(e),E.push(e.message)}))}),[]),o.a.createElement(o.a.Fragment,null,a({progress:s,progressInfo:f,file:t,errors:E,onRemoveFile:function(){i(t)}}))};function $e(){return($e=Object(le.a)(ie.a.mark((function e(t,a){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",et(t,a));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(){return(Xe=Object(le.a)(ie.a.mark((function e(t,a){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",tt(t,a));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(){return(qe=Object(le.a)(ie.a.mark((function e(t,a){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",at(t,a));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){return(Qe=Object(le.a)(ie.a.mark((function e(t,a){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nt(t,a));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(e,t){return e.forEach((function(e){t.addFeederAndDemandIfNotExists(e.billingPeriod).addItemIfNotExistElseGet(e.feeder).setPowerSubstationData(e)})),t}function tt(e,t){return console.log({message:"Processing raw datas"}),e.forEach((function(e){var a=t.addFeederAndDemandIfNotExists(e.billingPeriod).addItemIfNotExistElseGet(e.feeder);console.log({message:"Adding rawData to item feeder: ",itemFeeder:a.feeder}),a.addRawMonthlyInterruptionData(e)})),t}function at(e,t){return Object(h.a)(t.feederAndDemands.values()).forEach((function(t){Object(h.a)(t.items.values()).forEach((function(t){t.removePowerSubstationData(e)}))})),t}function nt(e,t){return Object(h.a)(t.feederAndDemands.values()).forEach((function(t){Object(h.a)(t.items.values()).forEach((function(t){t.removeMonthlyInterruptionData(e)}))})),t}var rt,ot=Object.freeze({removePowerSubstationFile:at,removeMonthlyInterruptionFile:nt,addPowerSubstationRawData:et,addMonthlyInterruptionRawData:tt,addPowerSubstationRawDataAsync:function(e,t){return $e.apply(this,arguments)},addMonthlyInterruptionRawDataAsync:function(e,t){return Xe.apply(this,arguments)},removePowerSubstationFileAsync:function(e,t){return qe.apply(this,arguments)},removeMonthlyInterruptionFileAsync:function(e,t){return Qe.apply(this,arguments)},generateExcelFile:function(e){var t=Se.a.utils.book_new(),a="".concat(e.billingPeriod.toString()),n=function(e){var t=[],a=["","","","".concat(e.billingPeriod.startDate.toLocaleDateString()," ~ ").concat(e.billingPeriod.enddDate.toLocaleDateString())];t.push(["","","","Power Outages"],a,["Feeders","Feeder Input","Deamnd","Minutes","Hours","Operating Hours","Power Factor","Load Factor"]);var n,r=Object(f.a)(e.items.values());try{for(r.s();!(n=r.n()).done;){var o=n.value;t.push([o.feeder,o.feederInput.toFixed(2),o.demand.toFixed(2),o.totalMinutes.toString(),o.totalHours.toFixed(2),o.operatingHours.toFixed(2),o.powerFactor.toFixed(2),o.loadFactor.toFixed(2)])}}catch(i){r.e(i)}finally{r.f()}return console.log(t),t}(e),r=Se.a.utils.aoa_to_sheet(n);Se.a.utils.book_append_sheet(t,r,a),Se.a.writeFile(t,"Monthly Feeder And Demand Report of ".concat(e.billingPeriod.toString(),".xlsx"))},calculateOperatingHours:function(e,t){return 24*(t.getTotalDays()+1)-e}}),it=function(){function e(t,a){Object(p.a)(this,e),this.feeder=void 0,this.feederInput=void 0,this.demand=void 0,this.minutes=void 0,this.hours=void 0,this.operatingHours=void 0,this.powerFactor=void 0,this.loadFactor=void 0,this.kvarhrEnergy=void 0,this.totalOperatingHours=void 0,this.powerSubstaionFileName=void 0,this.totalMinutes=void 0,this.totalHours=void 0,this.feeder=t,this.feederInput=0,this.demand=0,this.minutes=[],this.hours=0,this.operatingHours=0,this.powerFactor=0,this.loadFactor=0,this.kvarhrEnergy=0,this.totalOperatingHours=a,this.powerSubstaionFileName="",this.totalMinutes=0,this.totalHours=0}return Object(v.a)(e,[{key:"getTotalMinutes",value:function(){var e,t=0,a=Object(f.a)(this.minutes);try{for(a.s();!(e=a.n()).done;){t+=e.value.value}}catch(n){a.e(n)}finally{a.f()}return t}},{key:"removeMonthlyInterruptionData",value:function(e){this.minutes=this.minutes.filter((function(t){return t.fileName!==e}))}},{key:"removePowerSubstationData",value:function(e){this.powerSubstaionFileName===e&&(this.powerSubstaionFileName="",this.demand=0,this.feederInput=0,this.kvarhrEnergy=0)}},{key:"addRawMonthlyInterruptionData",value:function(e){this.minutes.push({fileName:e.fileName,value:e.duration})}},{key:"setPowerSubstationData",value:function(e){this.demand=e.demandKwhr,this.feederInput=e.kwhrEnergy,this.kvarhrEnergy=e.kvarhrEnergy,this.powerSubstaionFileName=e.fileName}},{key:"recalculateData",value:function(){this.totalMinutes=this.getTotalMinutes(),this.totalHours=this.totalMinutes/60,this.operatingHours=this.totalOperatingHours-this.totalHours,this.powerFactor=this.getPowerFactor(),this.loadFactor=this.getLoadFactor()}},{key:"getPowerFactor",value:function(){var e=100*Math.cos(Math.atan(this.kvarhrEnergy/this.feederInput));return e||0}},{key:"getLoadFactor",value:function(){var e=this.feederInput/this.operatingHours/this.demand;return e||0}}]),e}(),lt=function(){function e(t){Object(p.a)(this,e),this.billingPeriod=void 0,this.items=void 0,this.totalOperatingHours=void 0,this.billingPeriod=t,this.items=new Map,this.totalOperatingHours=24*(t.getTotalDays()+1),console.log("FeederAndDemand Created")}return Object(v.a)(e,[{key:"addItemIfNotExistElseGet",value:function(e){return this.items.has(e)||this.items.set(e,new it(e,this.totalOperatingHours)),this.items.get(e)}}]),e}(),ct=function(){function e(t){Object(p.a)(this,e),this.feederAndDemands=void 0,this.feederAndDemands=t?new Map(t.feederAndDemands):new Map,console.log("Monthly feeder and demand created")}return Object(v.a)(e,[{key:"addFeederAndDemandIfNotExists",value:function(e){var t=e.toString();return this.feederAndDemands.has(t)||this.feederAndDemands.set(t,new lt(e)),this.feederAndDemands.get(t)}},{key:"initValues",value:function(){var e,t=Object(f.a)(this.feederAndDemands.values());try{for(t.s();!(e=t.n()).done;){var a,n=e.value,r=Object(f.a)(n.items.values());try{for(r.s();!(a=r.n()).done;){a.value.recalculateData()}}catch(o){r.e(o)}finally{r.f()}}}catch(o){t.e(o)}finally{t.f()}}}]),e}(),st=new ct;!function(e){e[e.MonthlyInterruptionData=0]="MonthlyInterruptionData",e[e.PowerSubstationData=1]="PowerSubstationData"}(rt||(rt={}));var dt,ut=Object(r.createContext)({monthlyFeederAndDemand:new ct,onMonthlyInterruptionOrPowerSubstationFileParsed:function(e){},onPowerSubstationDataFileRemoved:function(e){},onMonthlyInterruptionFileRemoved:function(e){}}),mt=function(e){var t=Object(r.useState)([]),a=Object(b.a)(t,2),n=a[0],i=a[1],l=Object(r.useState)(st),c=Object(b.a)(l,2),s=c[0],d=c[1];function u(){return(u=Object(le.a)(ie.a.mark((function e(){var t,a,r;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(h.a)(n),!(a=t.pop())){e.next=30;break}if(r=new ct(s),!a.data){e.next=17;break}if((a=a).data!=rt.MonthlyInterruptionData){e.next=12;break}return e.next=9,ot.removeMonthlyInterruptionFileAsync(a.fileName,r);case 9:r=e.sent,e.next=15;break;case 12:return e.next=14,ot.removePowerSubstationFileAsync(a.fileName,r);case 14:r=e.sent;case 15:e.next=28;break;case 17:if(!Array.isArray(a)){e.next=28;break}if(!(a.length>0)){e.next=28;break}if(!a[0].kvarhrEnergy){e.next=25;break}return e.next=22,ot.addPowerSubstationRawDataAsync(a,r);case 22:r=e.sent,e.next=28;break;case 25:return e.next=27,ot.addMonthlyInterruptionRawDataAsync(a,r);case 27:r=e.sent;case 28:d(r),i(Object(h.a)(t));case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){d(new ct)}),[]),Object(r.useEffect)((function(){console.log(s)}),[s]),Object(r.useEffect)((function(){if(n.length>0)!function(){u.apply(this,arguments)}();else{var e=new ct(s);e.initValues(),d(e)}}),[n]),o.a.createElement(ut.Provider,{value:{monthlyFeederAndDemand:s,onMonthlyInterruptionOrPowerSubstationFileParsed:function(e){i((function(t){return[].concat(Object(h.a)(t),[e])}))},onMonthlyInterruptionFileRemoved:function(e){i((function(t){return[].concat(Object(h.a)(t),[{data:rt.MonthlyInterruptionData,fileName:e}])}))},onPowerSubstationDataFileRemoved:function(e){i((function(t){return[].concat(Object(h.a)(t),[{data:rt.PowerSubstationData,fileName:e}])}))}}},e.children)},ft=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=(Object(g.a)(e,["expandedPanel","onPanelChange"]),Object(r.useState)(new Map)),i=Object(b.a)(n,2),l=i[0],c=i[1],s=Object(r.useContext)(ut);function d(){return(d=Object(le.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){c((function(t){if(t.has(e.name))return t;var a=new Map(t);return a.set(e.name,e),a}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){s.onMonthlyInterruptionOrPowerSubstationFileParsed(e)}function m(e){c((function(t){var a=new Map(t);return a.delete(e.name),a})),s.onMonthlyInterruptionFileRemoved(e.name)}return o.a.createElement(he,{onPanelChange:a,title:"Monthly Interruption Files",panelName:"mi_panel",expandedPanel:t},o.a.createElement(Ve,{onDragEnter:function(){},onDragLeave:function(){},onFileDrop:function(e){return d.apply(this,arguments)},helperText:"Drop files here"},Object(h.a)(l.values()).map((function(e){return o.a.createElement(Je,{onFileParsed:u,onRemoveFile:m,key:e.name,file:e,render:function(e){return o.a.createElement(Oe,{progress:e.progress,progressInfo:e.progressInfo,file:e.file,errors:e.errors,onRemoveFile:e.onRemoveFile})}})}))))},ht=a(205),bt=a(206);!function(e){e.FEEDER="ps_feeder",e.DEMAND="ps_demand",e.KWHRENERGY="ps_kwhrenergy",e.KVARHRENERGY="ps_kvarhrenergy"}(dt||(dt={}));var gt=Object.freeze({saveSettings:function(e){localStorage.setItem(dt.DEMAND,e.demandKwhrCol.toString()),localStorage.setItem(dt.FEEDER,e.feederCol.toString()),localStorage.setItem(dt.KWHRENERGY,e.kwhrEnergyCol.toString()),localStorage.setItem(dt.KVARHRENERGY,e.kvarhrEnergyCol.toString())},loadSettings:function(){return{kvarhrEnergyCol:Number(localStorage.getItem(dt.KVARHRENERGY))||0,kwhrEnergyCol:Number(localStorage.getItem(dt.KWHRENERGY))||1,demandKwhrCol:Number(localStorage.getItem(dt.DEMAND))||2,feederCol:Number(localStorage.getItem(dt.FEEDER))||3}},createRawData:function(e,t,a,n,r,o){return{kwhrEnergy:t,kvarhrEnergy:a,demandKwhr:n,billingPeriod:r,feeder:e,fileName:o}}});function pt(e,t,a){var n=null,r=null,o=ke.extractText(e.feeder),i=ke.extractNumber(e.kwhrEnergy,!1),l=ke.extractNumber(e.demandKwhr,!1),c=ke.extractNumber(e.kvarhrEnergy,!1);if(o.text&&(L.findFeeder(o.text)||(o.error="Feeder value ".concat(o.text," does not match any of the registered feeders"))),Boolean(i.error||l.error||c.error||o.error))throw n="Errors in row ".concat(e.row+1,":\n"),i.error&&(n=n.concat("\tKwhrEnergy Cell: ".concat(i.error,"\n"))),l.error&&(n=n.concat("\tDemand KwhrEnergy Cell: ".concat(l.error,"\n"))),c.error&&(n=n.concat("\tKvarhrEnergy Cell: ".concat(c.error,"\n"))),o.error&&(n=n.concat("\tFeeder Cell: ".concat(o.error,"\n"))),new Error(n);var s=i.number,d=c.number,u=l.number,m=o.text;return r=gt.createRawData(m,s,d,u,t,a),console.log({rawData:r}),r}function vt(e,t,a){var n={c:a.kwhrEnergyCol,r:t},r={c:a.demandKwhrCol,r:t},o={c:a.kvarhrEnergyCol,r:t},i={c:a.feederCol,r:t},l=Se.a.utils.encode_cell(i),c=Se.a.utils.encode_cell(n),s=Se.a.utils.encode_cell(o),d=Se.a.utils.encode_cell(r);return{feeder:e[l],kwhrEnergy:e[c],demandKwhr:e[d],kvarhrEnergy:e[s],row:t}}var Et=Object.freeze({extractRawDatasFromWorkbook:function(e,t,a,n){return new Promise(function(){var r=Object(le.a)(ie.a.mark((function r(o,i){var l,c,s,d,u,m,h,b,g,p,v,E,y;return ie.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:l=[],c=[],console.log("MonthllyInterruption Workbook: "),console.log(t),s=Object(f.a)(t.SheetNames),r.prev=5,s.s();case 7:if((d=s.n()).done){r.next=30;break}if(u=d.value,m=t.Sheets[u],n("Parsing ".concat(u),0),console.log("Parsing worksheet: "+u),m["!ref"]){r.next=14;break}return r.abrupt("continue",28);case 14:return h=Se.a.utils.decode_range(m["!ref"]),r.next=17,Promise.resolve(h.e.r-h.s.r);case 17:b=r.sent,g=0;case 19:if(!(g<=h.e.r)){r.next=28;break}return r.next=22,ke.calculatePercent(g,b);case 22:p=r.sent,n("Processing rows ".concat(g,"/").concat(b," ").concat(p.toFixed(0),"%"),p);try{v=gt.loadSettings(),E=vt(m,g,v),y=pt(E,a,e),c.push(y)}catch(i){l.push(i.message)}case 25:g++,r.next=19;break;case 28:r.next=7;break;case 30:r.next=35;break;case 32:r.prev=32,r.t0=r.catch(5),s.e(r.t0);case 35:return r.prev=35,s.f(),r.finish(35);case 38:o({value:c,errors:l});case 39:case"end":return r.stop()}}),r,null,[[5,32,35,38]])})));return function(e,t){return r.apply(this,arguments)}}())}}),yt=a(7),wt=a(114),xt=a(200),Ot=a(228),At=a(223),Pt=a(204),St=Object(yt.a)((function(e){return Object(ne.a)({root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:e.shape.borderRadius,position:"relative",backgroundColor:e.palette.background.paper,border:e.palette.divider,fontSize:"1rem",padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color"]),fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:focus, &:hover":{borderColor:e.palette.primary.main}}})}))(wt.a),Ct=function(e){var t=e.value,a=e.onChange,n=e.items,r=e.label,i=e.className,l=Object(g.a)(e,["value","onChange","items","label","className"]);return o.a.createElement(xt.a,Object.assign({className:i},l),o.a.createElement(Ot.a,{id:e.label},e.label),o.a.createElement(At.a,{labelId:r,value:t,onChange:a,input:o.a.createElement(St,null)},n.map((function(e){return o.a.createElement(Pt.a,{value:e.value},e.text)}))))},It=Object(d.a)((function(e){return Object(ne.a)({form:{display:"flex",padding:e.spacing(3),maxWidth:"300px"},billingYear:{flex:1}})})),Nt=function(e){var t=e.file,a=e.render,n=e.onFileParsed,i=e.onRemoveFile,l=(Object(g.a)(e,["file","render","onFileParsed","onRemoveFile"]),Object(r.useState)(0)),c=Object(b.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(""),m=Object(b.a)(u,2),f=m[0],h=m[1],p=Object(r.useState)([]),v=Object(b.a)(p,2),E=v[0],y=v[1],w=Object(r.useState)(!0),x=Object(b.a)(w,2),O=x[0],A=x[1],S=Object(r.useState)((new Date).getFullYear()),C=Object(b.a)(S,2),I=C[0],N=C[1],M=Object(r.useState)((new Date).getMonth()+1),D=Object(b.a)(M,2),j=D[0],k=D[1],F=Object(r.useState)(null),T=Object(b.a)(F,2),R=T[0],_=T[1];function H(e,t){d(t),h(e)}Object(r.useEffect)((function(){R&&je.extractWorkbookFromFile(t).then((function(e){var a=R;return Et.extractRawDatasFromWorkbook(t.name,e,a,H)})).then((function(e){var t;y(e.errors),t=e.value,n(t)})).catch((function(e){console.error(e),E.push(e.message)}))}),[R]);var W=It();return o.a.createElement(o.a.Fragment,null,a({progress:s,progressInfo:f,file:t,errors:E,onRemoveFile:function(){i(t)}}),o.a.createElement(pe.a,{open:O},o.a.createElement(ve.a,null,"Input Billing Period for ".concat(t.name)),o.a.createElement(ye.a,null,o.a.createElement(ht.a,null,"Enter the billing month (in numbers) and the billing year (number) e.g. 5 2020 = ( April 26 ~ May 25 2020)"),o.a.createElement("form",{id:"billing-period-form",className:W.form,onSubmit:function(e){e.preventDefault(),_(new P(j,I)),A(!1)}},o.a.createElement(Ct,{className:W.billingYear,value:I.toString(),label:"Year",onChange:function(e){N(Number(e.target.value))},items:L.getYears().map((function(e){return{value:e.toString(),text:e.toString()}}))}),o.a.createElement(Ct,{value:j.toString(),label:"Month",onChange:function(e){k(Number(e.target.value))},items:L.getMonths().map((function(e){return{value:e.monthNum.toString(),text:e.month.toString()}}))})),o.a.createElement(bt.a,null,o.a.createElement(ge.a,{form:"billing-period-form",type:"submit"},"OK")))))},Mt=function(){function e(t,a,n){Object(p.a)(this,e),this.substationItem=void 0,this.energMwhr=void 0,this.demandMW=void 0,this.powerFactor=void 0,this.loadMVA=void 0,this.percentLoading=void 0,this.operationHours=void 0,this.averageLoad=void 0,this.loadFactor=void 0,this.lossFactor=void 0,this.coreLoss=void 0,this.windingLoss=void 0,this.auxiliaryLoss=void 0,this.totalLosses=void 0,this.rawDemand=void 0,this.rawEnergyMwh=void 0,this.rawKvarhrEnergy=void 0,n?(this.substationItem=n.substationItem,this.operationHours=n.operationHours,this.energMwhr=n.energMwhr,this.demandMW=n.demandMW,this.powerFactor=n.powerFactor,this.loadMVA=n.loadMVA,this.percentLoading=n.percentLoading,this.averageLoad=n.averageLoad,this.loadFactor=n.loadFactor,this.lossFactor=n.lossFactor,this.coreLoss=n.coreLoss,this.windingLoss=n.windingLoss,this.auxiliaryLoss=n.auxiliaryLoss,this.totalLosses=n.totalLosses,this.rawDemand=n.rawDemand,this.rawEnergyMwh=n.rawEnergyMwh,this.rawKvarhrEnergy=n.rawKvarhrEnergy):(this.substationItem=t,this.operationHours=a,this.energMwhr=0,this.demandMW=0,this.powerFactor=0,this.loadMVA=0,this.percentLoading=0,this.averageLoad=0,this.loadFactor=0,this.lossFactor=0,this.coreLoss=0,this.windingLoss=0,this.auxiliaryLoss=0,this.totalLosses=0,this.rawDemand=[],this.rawEnergyMwh=[],this.rawKvarhrEnergy=[]),console.log("PowerTransformerLossItem Created: "+t.toString())}return Object(v.a)(e,[{key:"addPowerSubstatoinData",value:function(e){console.log("Adding power substation data"),console.log({data:e}),this.rawEnergyMwh.push({fileName:e.fileName,value:e.kwhrEnergy}),this.rawDemand.push({fileName:e.fileName,value:e.demandKwhr}),this.rawKvarhrEnergy.push({fileName:e.fileName,value:e.kvarhrEnergy})}},{key:"refreshData",value:function(){this.rawDemand=[],this.rawEnergyMwh=[],this.rawKvarhrEnergy=[]}},{key:"initValues",value:function(){this.energMwhr=this.getTotal(this.rawEnergyMwh)/1e3;var e=this.getTotal(this.rawKvarhrEnergy)/1e3;this.powerFactor=this.getPowerFactor(e,this.energMwhr),this.loadMVA=this.getLoadMva(this.demandMW,this.powerFactor),this.percentLoading=this.getPercentLoading(this.loadMVA,this.substationItem.transformer.power),this.loadFactor=this.getLoadFactor(this.energMwhr,this.demandMW,this.operationHours),this.averageLoad=this.getAverageLoad(this.demandMW,this.loadFactor),this.lossFactor=this.getLossFactor(this.loadFactor),this.coreLoss=this.getCoreLoss(this.substationItem.transformer.power,this.operationHours),this.windingLoss=this.getWindingLoss(this.percentLoading,this.lossFactor,this.operationHours),this.auxiliaryLoss=this.getAuxiliaryLoss(this.operationHours),this.totalLosses=this.getTotalLosses(this.coreLoss,this.auxiliaryLoss,this.windingLoss)}},{key:"getTotal",value:function(e){var t,a=0,n=Object(f.a)(e);try{for(n.s();!(t=n.n()).done;){a+=t.value.value}}catch(r){n.e(r)}finally{n.f()}return a||0}},{key:"getPowerFactor",value:function(e,t){var a=100*Math.cos(Math.atan(e/t));return a||0}},{key:"getLoadMva",value:function(e,t){var a=100*e/t;return a||0}},{key:"getPercentLoading",value:function(e,t){var a=100*e/t;return a||0}},{key:"getLoadFactor",value:function(e,t,a){var n=e/(t*a);return n||0}},{key:"getAverageLoad",value:function(e,t){var a=e*t;return a||0}},{key:"getLossFactor",value:function(e){var t=.2*e+e*e*.8;return t||0}},{key:"getCoreLoss",value:function(e,t){var a=e*t;return a||0}},{key:"getWindingLoss",value:function(e,t,a){var n=e/100*77*(e/100)*t*a;return n||0}},{key:"getAuxiliaryLoss",value:function(e){var t=e/24*6;return t||0}},{key:"getTotalLosses",value:function(e,t,a){return e+t+a}}]),e}(),Dt=function(){function e(t,a){Object(p.a)(this,e),this.substation=void 0,this.substationItems=void 0,this.operatingHours=void 0,this.substation=t,this.substationItems=new Map,this.operatingHours=a}return Object(v.a)(e,[{key:"replacePowerTransformerLossItem",value:function(e){this.substationItems.set(this.generateKey(e.substationItem),e)}},{key:"addIfNotExistsOrElseGet",value:function(e){var t=this.generateKey(e);return this.substationItems.has(t)||this.substationItems.set(t,new Mt(e,this.operatingHours)),this.substationItems.get(t)}},{key:"generateKey",value:function(e){return this.substation.key+e.transformer.key}}]),e}(),jt=function(){function e(t,a){Object(p.a)(this,e),this.billingPeriod=void 0,this.items=void 0,this.operatingHours=void 0,this.fileName=void 0,this.billingPeriod=t,this.operatingHours=24*(t.getTotalDays()+1),this.items=new Map,this.fileName=a}return Object(v.a)(e,[{key:"addIfNotExistsOrElseGet",value:function(e){var t=e.key;return this.items.has(t)||(console.log("Adding new PowerTransformerSubstationItem, subtation: "+e.key),this.items.set(t,new Dt(e,this.operatingHours))),this.items.get(t)}}]),e}(),kt=function(){function e(t){Object(p.a)(this,e),this.powerTransformerLosses=void 0,this.powerTransformerLosses=t?new Map(t.powerTransformerLosses):new Map,console.log("MonthlyPowerTransformerLoss created..")}return Object(v.a)(e,[{key:"initValues",value:function(){Object(h.a)(this.powerTransformerLosses.values()).forEach((function(e){Object(h.a)(e.items.values()).forEach((function(e){Object(h.a)(e.substationItems.values()).forEach((function(e){e.initValues()}))}))}))}},{key:"addIfNotExistOrElseGet",value:function(e,t){var a=e.toString();return this.powerTransformerLosses.has(a)||this.powerTransformerLosses.set(a,new jt(e,t)),this.powerTransformerLosses.get(a)}}]),e}();function Ft(){return(Ft=Object(le.a)(ie.a.mark((function e(t,a){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tt(t,a));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(e,t){return e.forEach((function(e){var a=L.findSubstationOfFeeder(e.feeder);if(a){var n=L.findSubstationItemOfFeeder(e.feeder,a);n&&t.addIfNotExistOrElseGet(e.billingPeriod,e.fileName).addIfNotExistsOrElseGet(a).addIfNotExistsOrElseGet(n).addPowerSubstatoinData(e)}})),t}function Lt(){return(Lt=Object(le.a)(ie.a.mark((function e(t,a){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rt(t,a));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rt(e,t){return Object(h.a)(t.powerTransformerLosses.keys()).forEach((function(a){var n;(null===(n=t.powerTransformerLosses.get(a))||void 0===n?void 0:n.fileName)===e&&t.powerTransformerLosses.delete(a)})),t}function _t(){return(_t=Object(le.a)(ie.a.mark((function e(t,a,n){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ht(t,a,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ht(e,t,a){var n,r;return null===(n=a.powerTransformerLosses.get(t.toString()))||void 0===n||null===(r=n.items.get(e.substationItem.substationKey))||void 0===r||r.replacePowerTransformerLossItem(e),a}var Wt=Object.freeze({generateExcelFile:function(e){var t=Se.a.utils.book_new(),a="".concat(e.billingPeriod.toString()),n=function(e){var t=[];t.push(["Substation","Power Transformer","Brand","Energy (MWHR)","Demand (MW)","Power Factor","Load (MVA)","Percent Loading","Operation Hours","Ave. Load (MW)","Load Factor","Loss Factor","Core Loss","Winding Loss","Auxiliary Loss","Total Losses"]);var a,n=Object(f.a)(e.items.values());try{for(n.s();!(a=n.n()).done;){var r,o=a.value,i=Object(f.a)(o.substationItems.values());try{for(i.s();!(r=i.n()).done;){var l=r.value;t.push([o.substation.text,"".concat(l.substationItem.transformer.power," mVA"),l.substationItem.transformer.brand,l.energMwhr.toFixed(2),l.demandMW.toFixed(2),l.powerFactor.toFixed(2),l.loadMVA.toFixed(2),l.percentLoading.toFixed(2),l.operationHours.toFixed(2),l.averageLoad.toFixed(2),l.loadFactor.toFixed(2),l.coreLoss.toFixed(2),l.windingLoss.toFixed(2),l.auxiliaryLoss.toFixed(2),l.totalLosses.toFixed(2)])}}catch(c){i.e(c)}finally{i.f()}}}catch(c){n.e(c)}finally{n.f()}return console.log(t),t}(e),r=Se.a.utils.aoa_to_sheet(n);Se.a.utils.book_append_sheet(t,r,a),Se.a.writeFile(t,"Monthly Power Transformer Loss Report of ".concat(e.billingPeriod.toString(),".xlsx"))},addPowerSubstatoinRawDatas:Tt,addPowerSubstatoinRawDatasAsync:function(e,t){return Ft.apply(this,arguments)},removePowerSubstationFileAsync:function(e,t){return Lt.apply(this,arguments)},removePowerSubstationFile:Rt,replacePowerTransformerLossItem:Ht,replacePowerTransformerLossItemAsync:function(e,t,a){return _t.apply(this,arguments)}}),Gt=new kt,Ut=Object(r.createContext)({monthlyPowerTransformerLoss:Gt,onPowerTransformerLossItemChanged:function(e,t){},onPowerSubstationFileParsed:function(e){},onPowerSubstationFileRemoved:function(e){}}),Vt=function(e){var t=Object(r.useState)(Gt),a=Object(b.a)(t,2),n=a[0],i=a[1],l=Object(r.useState)([]),c=Object(b.a)(l,2),s=c[0],d=c[1];return Object(r.useEffect)((function(){if(console.log({method:"useEffect()",message:"Buffer  length is: "+s.length}),s.length>0){var e=Object(h.a)(s),t=e.pop();if(t.item){var a=t;Wt.replacePowerTransformerLossItemAsync(a.item,a.billingPeriod,n).then((function(t){i(new kt(t)),d(e)}))}else Array.isArray(t)?Wt.addPowerSubstatoinRawDatasAsync(t,n).then((function(t){i(new kt(t)),d(e)})):Wt.removePowerSubstationFileAsync(t,n).then((function(t){i(new kt(t)),d(e)}))}else new Promise((function(e,t){var a=new kt(n);a.initValues(),e(a)})).then((function(e){i(e)}))}),[s]),Object(r.useEffect)((function(){console.log({monthlyPowerTransformerLoss:n})}),[n]),o.a.createElement(Ut.Provider,{value:{monthlyPowerTransformerLoss:n,onPowerTransformerLossItemChanged:function(e,t){d((function(a){return[].concat(Object(h.a)(a),[{item:e,billingPeriod:t}])}))},onPowerSubstationFileParsed:function(e){d((function(t){return[].concat(Object(h.a)(t),[e])}))},onPowerSubstationFileRemoved:function(e){d((function(t){return[].concat(Object(h.a)(t),[e])}))}}},e.children)},Kt=function(e){var t=e.expandedPanel,a=e.onPanelChange,n=(Object(g.a)(e,["expandedPanel","onPanelChange"]),Object(r.useState)(new Map)),i=Object(b.a)(n,2),l=i[0],c=i[1],s=Object(r.useContext)(Ut),d=Object(r.useContext)(ut);function u(){return(u=Object(le.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){c((function(t){if(t.has(e.name))return t;var a=new Map(t);return a.set(e.name,e),a}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){s.onPowerSubstationFileParsed(e),d.onMonthlyInterruptionOrPowerSubstationFileParsed(e)}function f(e){c((function(t){var a=new Map(t);return a.delete(e.name),a})),d.onPowerSubstationDataFileRemoved(e.name),s.onPowerSubstationFileRemoved(e.name)}return o.a.createElement(he,{onPanelChange:a,title:"Power Substation Files",panelName:"ps_panel",expandedPanel:t},o.a.createElement(Ve,{onDragEnter:function(){},onDragLeave:function(){},onFileDrop:function(e){return u.apply(this,arguments)},helperText:"Drop files here"},Object(h.a)(l.values()).map((function(e){return o.a.createElement(Nt,{onFileParsed:m,onRemoveFile:f,key:e.name,file:e,render:function(e){return o.a.createElement(Oe,{progress:e.progress,progressInfo:e.progressInfo,file:e.file,errors:e.errors,onRemoveFile:e.onRemoveFile})}})}))))},Bt=function(e){var t=e.open,a=(Object(g.a)(e,["open"]),re()),n=Object(r.useState)("laodprofile_filespanel"),i=Object(b.a)(n,2),l=i[0],c=i[1];function s(e){c(e)}return o.a.createElement(te.a,{variant:"persistent",open:t,anchor:"left",className:a.drawer,classes:{paper:a.drawerPaper}},o.a.createElement(Ke,{onPanelChange:s,expandedPanel:l}),o.a.createElement(ft,{onPanelChange:s,expandedPanel:l}),o.a.createElement(Kt,{onPanelChange:s,expandedPanel:l}))},Yt=a(224),Zt=Object(d.a)((function(e){return{root:{background:e.palette.background.paper,padding:e.spacing(3),fontSize:"1rem",display:"flex",flexDirection:"column",zIndex:e.zIndex.mobileStepper,position:"absolute",top:0,left:0,height:"100%",width:"100%",minHeight:0},title_div:{borderBottom:"1px solid ".concat(e.palette.divider)},title:{marginTop:e.spacing(5),fontSize:"1.3em"},tabs:{display:"inline-block"},content:{marginTop:e.spacing(5),display:"flex",flexGrow:1,overflow:"auto"},tab_panel:{flexGrow:1}}})),zt=Object(d.a)((function(e){return Object(ne.a)({root:{height:"100%",display:"flex",flexDirection:"column"},textFieldContainer:{display:"flex",flexDirection:"column",gap:"10px",width:"300px",fontSize:"0.9rem"},actionContainer:{marginTop:10}})})),Jt=function(e){var t=e.onSubmit,a=e.children,n=(Object(g.a)(e,["onSubmit","children"]),zt());return o.a.createElement("div",{className:n.root},o.a.createElement("form",{id:"settings-form",className:n.textFieldContainer,onSubmit:function(e){e.preventDefault(),t(e)}},a),o.a.createElement("div",{className:n.actionContainer},o.a.createElement(ge.a,{form:"settings-form",type:"submit",color:"primary"},"Save")))},$t=a(231),Xt=Object(d.a)((function(e){return{root:{fontSize:"1em",border:"1px solid ".concat(e.palette.divider),borderRadius:e.shape.borderRadius,backgroundColor:e.palette.background.paper,"&.Mui-focused":{backgroundColor:e.palette.background.default,border:"1px solid ".concat(e.palette.primary.main)},"&:hover":{backgroundColor:e.palette.background.default},focused:{}}}})),qt=function(e){var t=e.label,a=e.value,n=void 0===a?"":a,r=e.name,i=void 0===r?"":r,l=e.placeholder,c=void 0===l?"":l,s=e.helpertext,d=void 0===s?"":s,u=e.error,m=void 0!==u&&u,f=e.type,h=void 0===f?"text":f,b=e.onChange,g=void 0===b?function(e){}:b,p=(e.limitZero,Xt());return o.a.createElement($t.a,{variant:"filled",label:t,value:n,name:i,placeholder:c,error:m,helperText:d,type:h,InputProps:{disableUnderline:!0,classes:{root:p.root}},margin:"dense",onChange:function(e){"number"===h&&Number(e.target.value)<0||g(e)}})},Qt=a(207),ea=Object(d.a)((function(e){return{tab:{textAlign:"start",textTransform:"none",fontWeight:"normal",fontSize:"0.9em",borderBottom:"1px solid ".concat(e.palette.divider),padding:0,minWidth:"100px",lineHeight:0},tab_selected:{backgroundColor:e.palette.background.default,color:e.palette.primary.main,fontWeight:"bold"},tab_wrapper:{}}})),ta=function(e){var t=e.label,a=e.value,n=Object(g.a)(e,["label","value"]),r=ea();return o.a.createElement(Qt.a,Object.assign({classes:{root:r.tab,wrapper:r.tab_wrapper,selected:r.tab_selected},value:a,label:t},n))},aa=a(208);var na,ra=Object(d.a)((function(e){return Object(ne.a)({root:{paddingLeft:e.spacing(3),color:e.palette.text.primary,"&:hover > $content":{backgroundColor:e.palette.action.hover},"&:focus > $content, &$selected > $content":{color:e.palette.primary.main},"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label":{backgroundColor:"transparent"}},content:{color:e.palette.text.primary,borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:0,"& $content":{paddingLeft:e.spacing(2)}},expanded:{},selected:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",gap:"".concat(e.spacing(2),"px"),padding:e.spacing(.5,1),fontWeight:"normal"},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"inherit",flexGrow:0},bold:{fontWeight:"bold"}})})),oa=function(e){var t=ra(),a=e.labelText,n=void 0===a?"":a,r=e.labelIcon,i=e.labelInfo,l=void 0===i?"":i,c=e.color,s=e.content,d=e.bgColor,u=e.bold,m=Object(g.a)(e,["labelText","labelIcon","labelInfo","color","content","bgColor","bold"]);return o.a.createElement(aa.a,Object.assign({label:o.a.createElement("div",{className:Object(We.a)(t.labelRoot,t.bold&&u)},s?o.a.createElement(o.a.Fragment,null,r?o.a.createElement(r,{color:"inherit",className:t.labelIcon}):o.a.createElement(o.a.Fragment,null),s):o.a.createElement(o.a.Fragment,null,r?o.a.createElement(r,{color:"inherit",className:t.labelIcon}):o.a.createElement(o.a.Fragment,null),o.a.createElement(de.a,{variant:"body2",className:t.labelText},n),o.a.createElement(de.a,{variant:"caption",color:"inherit"},l))),style:{"--tree-view-color":c,"--tree-view-bg-color":d},classes:{root:t.root,content:t.content,expanded:t.expanded,selected:t.selected,group:t.group,label:t.label}},m))},ia=Object(d.a)((function(e){return{tab:{textAlign:"start",textTransform:"none",fontWeight:"normal",fontSize:"0.9em",borderRight:"1px solid ".concat(e.palette.divider)},tab_selected:{backgroundColor:e.palette.background.default,color:e.palette.primary.main,fontWeight:"bold"},tab_wrapper:{justifyContent:"flex-start",alignItems:"flex-start"}}})),la=function(e){var t=e.label,a=e.value,n=Object(g.a)(e,["label","value"]),r=ia();return o.a.createElement(Qt.a,Object.assign({classes:{root:r.tab,wrapper:r.tab_wrapper,selected:r.tab_selected},value:a,label:t},n))},ca=function(e){Object.assign({},e);var t=Object(r.useState)(0),a=Object(b.a)(t,2),n=a[0],i=a[1],l=Object(r.useState)(0),c=Object(b.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(0),m=Object(b.a)(u,2),f=m[0],h=m[1],g=Object(r.useState)(0),p=Object(b.a)(g,2),v=p[0],E=p[1],y=Object(r.useState)(""),w=Object(b.a)(y,2),x=w[0],O=w[1],A=Object(r.useState)(""),P=Object(b.a)(A,2),S=P[0],C=P[1];return Object(r.useEffect)((function(){var e=Ae.loadSettings();i(e.kwdelCol),d(e.kwhdelCol),O(e.dateFormat),h(e.dateCol),E(e.timeCol),C(e.timeFormat)}),[]),o.a.createElement(Jt,{onSubmit:function(e){Ae.saveSettings({kwdelCol:n,timeCol:v,dateCol:f,dateFormat:x,timeFormat:S,kwhdelCol:s}),alert("Load profile settings saved")}},o.a.createElement(qt,{label:"Kwdel Column#",placeholder:"Kwdel Column#",value:n,type:"number",onChange:function(e){i(Number(e.target.value))},helpertext:"the column# of the kwdel value, note: column starts at 0"}),o.a.createElement(qt,{label:"Kwhdel Column#",placeholder:"Kwhdel Column#",value:s,type:"number",onChange:function(e){d(Number(e.target.value))},helpertext:"the column# of the kwhdel value, note: column starts at 0"}),o.a.createElement(qt,{label:"Date Column#",placeholder:"Date Column#",value:f,type:"number",onChange:function(e){h(Number(e.target.value))},helpertext:"the column# of the date value, note: column starts at 0"}),o.a.createElement(qt,{label:"Time Column#",placeholder:"Time Column#",value:v,type:"number",onChange:function(e){E(Number(e.target.value))},helpertext:"the column# of the time value, note: column starts at 0"}),o.a.createElement(qt,{label:"Date Format",placeholder:"Date Format",value:x,onChange:function(e){O(e.target.value)},helpertext:"(MM/DD/YYYY) = '09/22/2020', (MMMM/DD/YYYY) = 'September/22/2020'  "}),o.a.createElement(qt,{label:"Time Format",placeholder:"Time Format",value:S,onChange:function(e){C(e.target.value)},helpertext:"(HH:mm) = '22:15', (hh:mm a) = '10:15 pm', (HH:mm:ss) = '22:15:13' "}))},sa=function(e){Object.assign({},e);var t=Object(r.useState)(0),a=Object(b.a)(t,2),n=a[0],i=a[1],l=Object(r.useState)(0),c=Object(b.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(0),m=Object(b.a)(u,2),f=m[0],h=m[1],g=Object(r.useState)(""),p=Object(b.a)(g,2),v=p[0],E=p[1];return Object(r.useEffect)((function(){var e=Be.loadSettings();i(e.durationCol),d(e.dateCol),h(e.feederCol),E(e.dateFormat)}),[]),o.a.createElement(Jt,{onSubmit:function(e){Be.saveSettings({dateCol:s,durationCol:n,feederCol:f,dateFormat:v}),alert("Monthly Interruption Settings Saved")}},o.a.createElement(qt,{label:"Feeder Column#",placeholder:"Feeder Column#",value:f,type:"number",onChange:function(e){h(Number(e.target.value))},helpertext:"the column# of the feeder value, note: column starts at 0"}),o.a.createElement(qt,{label:"Duration Column#",placeholder:"Duration Column#",value:n,type:"number",onChange:function(e){i(Number(e.target.value))},helpertext:"the column# of the duration value, note: column starts at 0"}),o.a.createElement(qt,{label:"Date Column#",placeholder:"Date Column#",value:s,type:"number",onChange:function(e){d(Number(e.target.value))},helpertext:"the column# of the date value, note: column starts at 0"}),o.a.createElement(qt,{label:"Date Format",placeholder:"Date Format",value:v,onChange:function(e){E(e.target.value)},helpertext:"(MM/DD/YYYY) = '09/22/2020', (MMMM/DD/YYYY) = 'September/22/2020'  "}))},da=function(e){Object.assign({},e);var t=Object(r.useState)(0),a=Object(b.a)(t,2),n=a[0],i=a[1],l=Object(r.useState)(0),c=Object(b.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(0),m=Object(b.a)(u,2),f=m[0],h=m[1],g=Object(r.useState)(0),p=Object(b.a)(g,2),v=p[0],E=p[1];return Object(r.useEffect)((function(){var e=gt.loadSettings();i(e.demandKwhrCol),d(e.kwhrEnergyCol),h(e.feederCol),E(e.kvarhrEnergyCol)}),[]),o.a.createElement(Jt,{onSubmit:function(e){gt.saveSettings({kwhrEnergyCol:s,demandKwhrCol:n,feederCol:f,kvarhrEnergyCol:v}),alert("Power Substation Settings Saved")}},o.a.createElement(qt,{label:"Kwhr Energy Column#",placeholder:"Kwhr Energy Column#",value:s,type:"number",onChange:function(e){d(Number(e.target.value))},helpertext:"the column# of the kwhr energy value, note: column starts at 0"}),o.a.createElement(qt,{label:"Demand Column#",placeholder:"Demand Column#",value:n,type:"number",onChange:function(e){i(Number(e.target.value))},helpertext:"the column# of the demand value, note: column starts at 0"}),o.a.createElement(qt,{label:"Kvarhr Energy Column#",placeholder:"Kvarhr Energy Column#",value:v,type:"number",onChange:function(e){E(Number(e.target.value))},helpertext:"the column# of the kvarhr value, note: column starts at 0"}),o.a.createElement(qt,{label:"Feeder Column#",placeholder:"Feeder Column#",value:f,onChange:function(e){h(Number(e.target.value))},type:"number",helpertext:"the column# of the feeder value, note: column starts at 0 "}))};function ua(e){var t=e.children,a=e.value,n=e.index,r=Object(g.a)(e,["children","value","index"]),i=Zt();return o.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"scrollable-prevent-tabpanel-".concat(n),"aria-labelledby":"scrollable-prevent-tab-".concat(n),className:i.tab_panel},r),a===n&&o.a.createElement(B.a,{p:3},t))}!function(e){e.LOADPROFILE_TAB="lp_tab",e.MONTHLYINTERRUPTION_TAB="mi_tab",e.POWERSUBSTATION_TAB="ps_tab"}(na||(na={}));var ma=function(e){Object.assign({},e);var t=Object(r.useState)(na.LOADPROFILE_TAB),a=Object(b.a)(t,2),n=a[0],i=a[1],l=Zt();return o.a.createElement("div",{className:l.root},o.a.createElement("div",{className:l.title_div},o.a.createElement(de.a,{className:l.title},"Settings")),o.a.createElement("div",{className:l.content},o.a.createElement(Yt.a,{className:l.tabs,orientation:"vertical",value:n,centered:!1,indicatorColor:"primary",onChange:function(e,t){i(t)}},o.a.createElement(la,{label:"Load Profile Settings",value:na.LOADPROFILE_TAB}),o.a.createElement(la,{value:na.MONTHLYINTERRUPTION_TAB,label:"Monthly Interruption Settings"}),o.a.createElement(la,{value:na.POWERSUBSTATION_TAB,label:"Power Substation Settings"})),o.a.createElement(ua,{value:n,index:na.LOADPROFILE_TAB},o.a.createElement(ca,null)),o.a.createElement(ua,{value:n,index:na.MONTHLYINTERRUPTION_TAB},o.a.createElement(sa,null)),o.a.createElement(ua,{value:n,index:na.POWERSUBSTATION_TAB},o.a.createElement(da,null))))},fa=a(216),ha=a(210),ba=a(211),ga=a(212),pa=a(213),va=a(209),Ea=Object(d.a)((function(e){return Object(ne.a)({root:{flexShrink:0,fontSize:"1rem",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}})})),ya=function(e){var t=e.monthlyLoadProfile,a=(Object(g.a)(e,["monthlyLoadProfile"]),Ea());return o.a.createElement(va.a,{className:a.root,defaultExpanded:["1"],defaultCollapseIcon:o.a.createElement(ha.a,null),defaultExpandIcon:o.a.createElement(ba.a,null),defaultEndIcon:o.a.createElement("div",{style:{width:24}})},o.a.createElement(oa,{nodeId:"2",labelText:"Coincident Peak",labelIcon:ga.a,labelInfo:t.coincidentPeak?"".concat(t.coincidentPeak.meteringPoint,": ").concat(t.coincidentPeak.date.getMonth()+1,"/").concat(t.coincidentPeak.date.getDate(),"/").concat(t.coincidentPeak.date.getFullYear()," ").concat(t.coincidentPeak.hour,":00 kwdel: ").concat(t.coincidentPeak.kwdel.toFixed(2)):""}),o.a.createElement(oa,{nodeId:"3",labelText:"None Coincident Peak",labelIcon:pa.a,labelInfo:t.nonCoincidentPeak?" ".concat(t.nonCoincidentPeak.toFixed(2)):""}),o.a.createElement(oa,{nodeId:"4",labelText:"Diversity Factor:",labelIcon:pa.a,labelInfo:t.diversityFactor?" ".concat(t.diversityFactor.toFixed(2)):""}),o.a.createElement(oa,{nodeId:"5",labelText:"Max per metering point:",labelIcon:ga.a,labelInfo:""},t.loadProfilesMax.map((function(e){return o.a.createElement(oa,{key:"LM:S".concat(e.meteringPoint),nodeId:"LM:S".concat(e.meteringPoint),labelIcon:ga.a,labelText:"".concat(e.meteringPoint),labelInfo:" ".concat(e.date.getMonth()+1,"/").concat(e.date.getDate(),"/").concat(e.date.getFullYear()," ").concat(e.hour,":00 kwdel: ").concat(e.kwdel.toFixed(2))})}))),o.a.createElement(oa,{nodeId:"7",labelText:"Sum per metering point:",labelIcon:pa.a,labelInfo:""},t.loadProfilesSum.map((function(e){return o.a.createElement(oa,{key:"LS:S".concat(e.meteringPoint),nodeId:"LS:S".concat(e.meteringPoint),labelIcon:pa.a,labelText:"".concat(e.meteringPoint),labelInfo:" ".concat(e.kwhdel.toFixed(2))})}))))},wa=a(215),xa=a(214),Oa=Object(d.a)((function(e){return Object(ne.a)({labelContent:{width:"120px",fontWeight:"normal",flexGrow:1},labelSmall:{width:"35px"},labelHeader:{fontWeight:"bold"}})}));var Aa=function(e){var t=Oa(),a=(e.color,e.bgColor,e.loadProfiles),n=e.dateString,r=void 0===n?"":n,i=e.hour,l=void 0===i?1:i,c=e.header,s=void 0!==c&&c,d=e.totalLoadProfile;return Object(g.a)(e,["color","bgColor","loadProfiles","dateString","hour","header","totalLoadProfile"]),o.a.createElement(oa,{nodeId:"".concat(r,"-").concat(l),content:s?o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{variant:"body2",className:Object(We.a)(t.labelHeader,t.labelSmall)},"Hour"),a.map((function(e){return o.a.createElement(de.a,{key:"HTI: T: M:".concat(e.meteringPoint),variant:"body2",className:t.labelContent},e.meteringPoint)})),o.a.createElement(de.a,{className:t.labelContent,variant:"caption",color:"inherit"},"Total"),":"):o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{variant:"body2",className:t.labelSmall},l),a.map((function(e){return o.a.createElement(de.a,{key:"HTI: T: K:".concat(e.meteringPoint),variant:"body2",className:t.labelContent},e.getDailyLoadProfile(r).hourlyLoadProfiles[l-1].getTotalKwdel().toFixed(2))})),o.a.createElement(de.a,{className:t.labelContent,variant:"caption",color:"inherit"},d.getDailyLoadProfile(r).hourlyLoadProfiles[l-1].getRawTotal().toFixed(2)))})},Pa=function(e){var t=e.loadProfiles,a=e.dateString,n=e.nodeId,i=e.totalLoadProfile,l=Object(r.useState)(new Date),c=Object(b.a)(l,2),s=c[0],d=c[1];return Object(r.useEffect)((function(){d(new Date(a))}),[a]),o.a.createElement(oa,{nodeId:n,labelText:"".concat(A[s.getMonth()]," ").concat(s.getDate()),labelIcon:xa.a},o.a.createElement(Aa,{nodeId:"DTI:D:".concat(a,"H"),dateString:a,header:!0,loadProfiles:t,totalLoadProfile:i}),Object(h.a)(Array(24).keys()).map((function(e){return o.a.createElement(Aa,{nodeId:"HTI: H:".concat(e),key:"HTI: H:".concat(e),hour:e+1,dateString:a,loadProfiles:t,totalLoadProfile:i})})))},Sa=Object(d.a)((function(e){return Object(ne.a)({root:{flexShrink:0,fontSize:"1rem",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},title:{fontSize:"1.5em"},dayTree:{flexGrow:1,maxWidth:400}})})),Ca=function(e){var t=e.monthlyLoadProfile,a=Sa();return o.a.createElement(va.a,{className:a.root,defaultExpanded:["1"],defaultCollapseIcon:o.a.createElement(ha.a,null),defaultExpandIcon:o.a.createElement(ba.a,null),defaultEndIcon:o.a.createElement("div",{style:{width:24}})},o.a.createElement(oa,{nodeId:"1",labelText:"".concat(A[t.billingPeriod.month-1]," ").concat(t.billingPeriod.year),labelIcon:wa.a},Object(h.a)(t.dateStrings.values()).map((function(e){var a=Object(h.a)(Array.from(t.loadProfiles.values())),n="DTI:D:".concat(e);return o.a.createElement(Pa,{totalLoadProfile:t.totalLoadpRofile,key:n,nodeId:n,loadProfiles:a,dateString:e})}))))};var Ia,Na=function(e){var t=Se.a.utils.book_new(),a="".concat(e.billingPeriod.toString()),n=function(e){var t=[],a=e.billingPeriod.startDate,n=e.billingPeriod.enddDate;console.log("start date: ".concat(a.toLocaleDateString()," endDate: ").concat(n.toLocaleDateString()));var r,o=["Date","Hour"],i=Object(f.a)(e.loadProfiles.values());try{for(i.s();!(r=i.n()).done;){var l=r.value;o.push(l.meteringPoint)}}catch(g){i.e(g)}finally{i.f()}o.push("Total"),t.push(o);for(;a<=n;){for(var c="".concat(a.getMonth()+1,"/").concat(a.getDate(),"/").concat(a.getFullYear()),s=0;s<24;s++){var d=[];d.push(c),d.push(s.toString());var u,m=Object(f.a)(e.loadProfiles.values());try{for(m.s();!(u=m.n()).done;){var h=u.value.dailyLoadProfiles.get(c)||new y(new Date(c));d.push(h.hourlyLoadProfiles[s].getTotalKwdel().toFixed(2))}}catch(g){m.e(g)}finally{m.f()}var b=e.totalLoadpRofile.dailyLoadProfiles.get(c)||new y(new Date(c));d.push(b.hourlyLoadProfiles[s].getRawTotal().toFixed(2)),console.log(d),t.push(d)}a.setDate(a.getDate()+1)}return console.log(t),t}(e),r=Se.a.utils.aoa_to_sheet(n);Se.a.utils.book_append_sheet(t,r,a),Se.a.writeFile(t,"Monthly LoadProfile Report of ".concat(e.billingPeriod.toString(),".xlsx"))},Ma=Object(d.a)((function(e){return Object(ne.a)({monthlyCard_root:{display:"inline-flex",boxSizing:"border-box",flexWrap:"nowrap"},monthlyCard_paper:{flexGrow:0,flexShrink:0,display:"flex",flexDirection:"column",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),boxSizing:"border-box",padding:e.spacing(2)},monthlyCard_paperAction:{display:"flex",alignItems:"center",justifyContent:"flex-end"},monthlyCard_paperContent:{display:"flex",flexShrink:0},downloadBtn:{fontSize:"14px",textTransform:"none",fontWeight:"lighter"}})})),Da=function(e){var t=e.monthlyLoadProfile,a=Ma();return o.a.createElement("div",{className:a.monthlyCard_root},o.a.createElement("div",{className:a.monthlyCard_paper},o.a.createElement("div",{className:a.monthlyCard_paperAction},o.a.createElement(ge.a,{onClick:function(){Na(t)},className:a.downloadBtn,size:"small",startIcon:o.a.createElement(fa.a,null)},"download")),o.a.createElement("div",{className:a.monthlyCard_paperContent},o.a.createElement(Ca,{monthlyLoadProfile:t}),o.a.createElement(ya,{monthlyLoadProfile:t}))))},ja=a(21),ka=a(2),Fa=a(51),Ta=a(112),La=Object(d.a)((function(e){return Object(ne.a)({graphContent:{padding:e.spacing(3)}})})),Ra=function(e){var t=e.monthlyLoadProfile,a=(Object(g.a)(e,["monthlyLoadProfile"]),La());return o.a.createElement(Ta.a,{className:a.graphContent},o.a.createElement(Fa.b,{data:Object(h.a)(t.chartData.values())},o.a.createElement(ja.b,{factory:ka.zb}),o.a.createElement(Fa.a,{showGrid:!0}),o.a.createElement(Fa.f,{showGrid:!0}),Object(h.a)(t.loadProfiles.values()).map((function(e){return o.a.createElement(Fa.d,{valueField:e.meteringPoint,argumentField:"date",name:e.meteringPoint})})),o.a.createElement(ja.i,null),o.a.createElement(Fa.c,null),o.a.createElement(Fa.e,{text:"Billing Period: ".concat(t.billingPeriod.toString())})))};function _a(e){e.monthlyLoadpRofile;var t=e.value,a=e.index,n=e.children,r=Wa();return t===a?o.a.createElement("div",{className:r.loadProfileContent_tabPanel},n):o.a.createElement(o.a.Fragment,null)}!function(e){e.DATA="data",e.GRAPH="graph",e.NONE=""}(Ia||(Ia={}));var Ha,Wa=Object(d.a)((function(e){return Object(ne.a)({loadProfileContent_root:{height:"100%",display:"flex",flexDirection:"column"},loadProfileContent_tabPanel:{flex:1,padding:e.spacing(3)}})})),Ga=function(e){var t=e.monthlyLoadProfile,a=e.index,n=e.value,i=Object(r.useState)(Ia.DATA),l=Object(b.a)(i,2),c=l[0],s=l[1],d=Wa();return a===n?o.a.createElement("div",{className:d.loadProfileContent_root},o.a.createElement("div",null,o.a.createElement(Yt.a,{onChange:function(e,t){s(t)},indicatorColor:"primary",value:c},o.a.createElement(ta,{label:"Data",value:Ia.DATA}),o.a.createElement(ta,{label:"Graph",value:Ia.GRAPH}))),o.a.createElement(_a,{index:Ia.DATA,value:c,monthlyLoadpRofile:t},o.a.createElement(Da,{monthlyLoadProfile:t})),o.a.createElement(_a,{index:Ia.GRAPH,value:c,monthlyLoadpRofile:t},o.a.createElement(Ra,{monthlyLoadProfile:t}))):o.a.createElement(o.a.Fragment,null)},Ua=Object(d.a)((function(e){return{loadProfileContent_root:{height:"100%",display:"flex",flexDirection:"column",minHeight:"0px",minWidth:"0px"},loadProfileContent_Header:{display:"flex",alignItems:"flex-end"},loadProfileContent_Title:{marginRight:e.spacing(1),paddingRight:e.spacing(3),textAlign:"center"},loadProfileContent_contentWrapper:{flex:1,overflow:"auto",display:"flex",flexWrap:"nowrap"},loadProfileContent_content:{flex:1}}})),Va=function(e){Object.assign({},e);var t=Ua(),a=Object(r.useState)(""),n=Object(b.a)(a,2),i=n[0],l=n[1],c=Object(r.useContext)(G);return o.a.createElement("div",{className:t.loadProfileContent_root},o.a.createElement("div",{className:t.loadProfileContent_Header},o.a.createElement(de.a,{className:t.loadProfileContent_Title,variant:"h5"},"Load Profile"),o.a.createElement(Yt.a,{onChange:function(e,t){l(t)},indicatorColor:"primary",value:i},Object(h.a)(c.monthlyLoadProfiles.values()).map((function(e){return o.a.createElement(ta,{label:e.billingPeriod.toString(),value:e.billingPeriod.toString(),key:"T: ".concat(e.billingPeriod.toString())})})))),o.a.createElement("div",{className:t.loadProfileContent_contentWrapper},o.a.createElement("div",{className:t.loadProfileContent_content},Object(h.a)(c.monthlyLoadProfiles.values()).map((function(e){return o.a.createElement(Ga,{key:"C: ".concat(e.billingPeriod.toString()),monthlyLoadProfile:e,value:i,index:e.billingPeriod.toString()})})))))},Ka=Object(d.a)((function(e){return Object(ne.a)({labelContent:{width:"120px",fontWeight:"normal",flexGrow:1},feeder:{width:"200px"},numbers:{width:"130px",maxWidth:"130px"},percent:{width:"90px",maxWidth:"90px"}})})),Ba=function(e){var t=Ka(),a=(e.color,e.bgColor,e.header),n=void 0!==a&&a,r=e.feederAndDemandItem,i=e.nodeId;Object(g.a)(e,["color","bgColor","header","feederAndDemandItem","nodeId"]);return o.a.createElement(oa,{nodeId:i,content:n?o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{classes:{root:t.feeder},variant:"body2"},"Feeder"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},"Feeder Input Energy (KWHR)"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},"Demand (KW)"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2",className:t.labelContent},"Minutes"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},"Hours"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},"Operating Hours"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2",className:t.labelContent},"Power Factor"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2",className:t.labelContent},"Load Factor")):o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{classes:{root:t.feeder},variant:"body2"},r.feeder),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},r.feederInput.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},r.demand.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2",className:t.labelContent},r.totalMinutes),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},r.totalHours.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2",className:t.labelContent},r.operatingHours.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2",className:t.labelContent},r.powerFactor.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2",className:t.labelContent},r.loadFactor.toFixed(2)))})},Ya=Object(d.a)((function(e){return Object(ne.a)({root:{flexShrink:0,fontSize:"1rem",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},title:{fontSize:"1.5em"},dayTree:{flexGrow:1,maxWidth:400}})})),Za=function(e){var t=e.feederAndDemand,a=Ya();return o.a.createElement(va.a,{className:a.root,defaultCollapseIcon:o.a.createElement(ha.a,null),defaultExpandIcon:o.a.createElement(ba.a,null),defaultEndIcon:o.a.createElement("div",{style:{width:24}})},o.a.createElement(Ba,{feederAndDemandItem:new it(S.ACLEM,0),nodeId:"header",header:!0}),Object(h.a)(t.items.values()).map((function(e){var t="FTI:F:".concat(e.feeder);return o.a.createElement(Ba,{feederAndDemandItem:e,key:t,nodeId:t})})))},za=Object(d.a)((function(e){return Object(ne.a)({monthlyCard_root:{display:"inline-flex",boxSizing:"border-box",flexWrap:"nowrap"},monthlyCard_paper:{flexGrow:0,flexShrink:0,display:"flex",flexDirection:"column",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),boxSizing:"border-box",padding:e.spacing(2)},monthlyCard_paperAction:{display:"flex",alignItems:"center",justifyContent:"flex-end"},monthlyCard_paperContent:{display:"flex",flexShrink:0},downloadBtn:{fontSize:"14px",textTransform:"none",fontWeight:"lighter"}})})),Ja=function(e){var t=e.feederAndDemand,a=za();return o.a.createElement("div",{className:a.monthlyCard_root},o.a.createElement("div",{className:a.monthlyCard_paper},o.a.createElement("div",{className:a.monthlyCard_paperAction},o.a.createElement(ge.a,{className:a.downloadBtn,size:"small",startIcon:o.a.createElement(fa.a,null),onClick:function(){ot.generateExcelFile(t)}},"download")),o.a.createElement("div",{className:a.monthlyCard_paperContent},o.a.createElement(Za,{feederAndDemand:t}))))};function $a(e){var t=e.value,a=e.index,n=e.children,r=qa();return t===a?o.a.createElement("div",{className:r.loadProfileContent_tabPanel},n):o.a.createElement(o.a.Fragment,null)}!function(e){e.DATA="data",e.GRAPH="graph",e.NONE=""}(Ha||(Ha={}));var Xa,qa=Object(d.a)((function(e){return Object(ne.a)({loadProfileContent_root:{height:"100%",display:"flex",flexDirection:"column"},loadProfileContent_tabPanel:{flex:1,padding:e.spacing(3)}})})),Qa=function(e){var t=e.feederAndDemand,a=e.index,n=e.value,i=Object(r.useState)(Ha.DATA),l=Object(b.a)(i,2),c=l[0],s=l[1],d=qa();return a===n?o.a.createElement("div",{className:d.loadProfileContent_root},o.a.createElement("div",null,o.a.createElement(Yt.a,{onChange:function(e,t){s(t)},indicatorColor:"primary",value:c},o.a.createElement(ta,{label:"Data",value:Ha.DATA}),o.a.createElement(ta,{label:"Graph",value:Ha.GRAPH}))),o.a.createElement($a,{index:Ha.DATA,value:c},o.a.createElement(Ja,{feederAndDemand:t}))):o.a.createElement(o.a.Fragment,null)},en=Object(d.a)((function(e){return{feederAndDemandContent_root:{height:"100%",display:"flex",flexDirection:"column",minHeight:"0px",minWidth:"0px"},feederAndDemand_header:{display:"flex",alignItems:"flex-end"},feederAndDemand_title:{marginRight:e.spacing(1),paddingRight:e.spacing(3),textAlign:"center"},feederAndDemand_contentContainer:{flex:1,overflow:"auto",display:"flex",flexWrap:"nowrap"},feederAndDemandContent:{flex:1}}})),tn=function(e){Object.assign({},e);var t=en(),a=Object(r.useState)(""),n=Object(b.a)(a,2),i=n[0],l=n[1],c=Object(r.useContext)(ut);return o.a.createElement("div",{className:t.feederAndDemandContent_root},o.a.createElement("div",{className:t.feederAndDemand_header},o.a.createElement(de.a,{className:t.feederAndDemand_title,variant:"h5"},"Feeder Demand and Outages :D"),o.a.createElement(Yt.a,{onChange:function(e,t){l(t)},indicatorColor:"primary",value:i},Object(h.a)(c.monthlyFeederAndDemand.feederAndDemands.values()).map((function(e){return o.a.createElement(ta,{label:e.billingPeriod.toString(),value:e.billingPeriod.toString(),key:"T: ".concat(e.billingPeriod.toString())})})))),o.a.createElement("div",{className:t.feederAndDemand_contentContainer},o.a.createElement("div",{className:t.feederAndDemandContent},Object(h.a)(c.monthlyFeederAndDemand.feederAndDemands.values()).map((function(e){return o.a.createElement(Qa,{key:"FDC:BP:".concat(e.billingPeriod.toString()),feederAndDemand:e,value:i,index:e.billingPeriod.toString()})})))))},an=a(217),nn=a(218),rn=a(219),on=a(106),ln=a.n(on),cn=Object(d.a)((function(e){return Object(ne.a)({feeder:{width:"200px",fontWeight:"inherit"},numbers:{width:"130px",maxWidth:"130px",fontWeight:"inherit"},percent:{width:"90px",maxWidth:"90px",fontWeight:"inherit"},inputField:{width:"100%",border:"1px solid ".concat(e.palette.divider),borderRadius:e.shape.borderRadius,outline:"none",color:e.palette.text.primary,transition:e.transitions.create("borderColor",{duration:e.transitions.duration.standard,easing:ln.a.easing.easeInOut}),"&:focus, &:hover":{borderColor:e.palette.primary.main}},errorField:{borderColor:e.palette.error.main,"&:focus, &:hover":{borderColor:e.palette.error.main},color:e.palette.error.main}})})),sn=function(e){var t=cn(),a=(e.color,e.bgColor,e.powerTransformerLossItem),n=e.substation,i=(e.labelIcon,e.billingPeriod),l=e.nodeId,c=(Object(g.a)(e,["color","bgColor","powerTransformerLossItem","substation","labelIcon","billingPeriod","nodeId"]),Object(r.useContext)(Ut)),s=Object(r.useState)("0"),d=Object(b.a)(s,2),u=d[0],m=d[1],f=Object(r.useState)(!1),h=Object(b.a)(f,2),p=h[0],v=h[1];return Object(r.useEffect)((function(){a&&m(a.demandMW.toString())}),[]),o.a.createElement(oa,{nodeId:l,bold:!a,content:a?o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{classes:{root:t.feeder},variant:"body2"},n.text),o.a.createElement(de.a,{classes:{root:t.feeder},variant:"body2"},a.substationItem.transformer.text),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},a.energMwhr.toFixed(2)),o.a.createElement("form",{className:t.percent,onSubmit:function(e){if(e.preventDefault(),!p&&a){var t=new Mt(a.substationItem,0,a);t.demandMW=Number(u),console.log({newItem:t}),c.onPowerTransformerLossItemChanged(t,i)}}},o.a.createElement("input",{value:u,className:Object(We.a)(t.inputField,Object(V.a)({},t.errorField,p)),onChange:function(e){Number(e.target.value)?v(!1):v(!0),m(e.target.value)}})),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},a.powerFactor.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},a.loadMVA.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},a.percentLoading.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},a.operationHours),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},a.averageLoad.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},a.loadFactor.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},a.lossFactor.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},a.coreLoss.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},a.windingLoss.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},a.auxiliaryLoss.toFixed(2)),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},a.totalLosses.toFixed(2))):o.a.createElement(o.a.Fragment,null,o.a.createElement(de.a,{classes:{root:t.feeder},variant:"body2"},"Substation"),o.a.createElement(de.a,{classes:{root:t.feeder},variant:"body2"},"Transformer"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},"Energy (MWHR)"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Demand (MW)"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Power Factor"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Load (MVA)"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Percent Loading"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Operation Hours"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Ave. Load (MW)"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Load Factor"),o.a.createElement(de.a,{classes:{root:t.percent},variant:"body2"},"Loss Factor"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},"Core Loss"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},"Winding Loss"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},"Auxiliary Loss"),o.a.createElement(de.a,{classes:{root:t.numbers},variant:"body2"},"Total Losses"))})},dn=Object(d.a)((function(e){return Object(ne.a)({root:{flexShrink:0,fontSize:"1rem",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},title:{fontSize:"1.5em"},dayTree:{flexGrow:1,maxWidth:400}})})),un=function(e){var t=e.powerTransformerLossSubstation,a=e.billingPeriod,n=dn();return o.a.createElement(va.a,{className:n.root,defaultCollapseIcon:o.a.createElement(ha.a,null),defaultExpandIcon:o.a.createElement(ba.a,null),defaultEndIcon:o.a.createElement("div",{style:{width:24}})},o.a.createElement(oa,{nodeId:t.substation.key,labelText:t.substation.text,labelIcon:an.a},o.a.createElement(sn,{labelIcon:nn.a,substation:t.substation,nodeId:"header",billingPeriod:a}),Object(h.a)(t.substationItems.values()).map((function(e){var n="PFTS:H:".concat(e.substationItem.toString());return o.a.createElement(sn,{labelIcon:rn.a,powerTransformerLossItem:e,substation:t.substation,key:n,nodeId:n,billingPeriod:a})}))))},mn=Object(d.a)((function(e){return Object(ne.a)({root:{flexShrink:0,fontSize:"1rem",padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},title:{fontSize:"1.5em"},dayTree:{flexGrow:1,maxWidth:400}})})),fn=function(e){var t=e.powerTransformerLoss,a=mn();return o.a.createElement(va.a,{className:a.root,defaultCollapseIcon:o.a.createElement(ha.a,null),defaultExpandIcon:o.a.createElement(ba.a,null),defaultEndIcon:o.a.createElement("div",{style:{width:24}})},Object(h.a)(t.items.values()).map((function(e){var a="PFT:F:".concat(e.substation.key);return o.a.createElement(un,{powerTransformerLossSubstation:e,billingPeriod:t.billingPeriod,key:a})})))},hn=Object(d.a)((function(e){return Object(ne.a)({monthlyCard_root:{display:"inline-flex",boxSizing:"border-box",flexWrap:"nowrap"},monthlyCard_paper:{flexGrow:0,flexShrink:0,display:"flex",flexDirection:"column",backgroundColor:e.palette.background.paper,borderRadius:e.shape.borderRadius,border:"1px solid ".concat(e.palette.divider),boxSizing:"border-box",padding:e.spacing(2)},monthlyCard_paperAction:{display:"flex",alignItems:"center",justifyContent:"flex-end"},monthlyCard_paperContent:{display:"flex",flexShrink:0},downloadBtn:{fontSize:"14px",textTransform:"none",fontWeight:"lighter"}})})),bn=function(e){var t=e.powerTransformerLoss,a=hn();return o.a.createElement("div",{className:a.monthlyCard_root},o.a.createElement("div",{className:a.monthlyCard_paper},o.a.createElement("div",{className:a.monthlyCard_paperAction},o.a.createElement(ge.a,{className:a.downloadBtn,size:"small",startIcon:o.a.createElement(fa.a,null),onClick:function(){Wt.generateExcelFile(t)}},"download")),o.a.createElement("div",{className:a.monthlyCard_paperContent},o.a.createElement(fn,{powerTransformerLoss:t}))))};function gn(e){var t=e.value,a=e.index,n=e.children,r=vn();return t===a?o.a.createElement("div",{className:r.loadProfileContent_tabPanel},n):o.a.createElement(o.a.Fragment,null)}!function(e){e.DATA="data",e.GRAPH="graph",e.NONE=""}(Xa||(Xa={}));var pn,vn=Object(d.a)((function(e){return Object(ne.a)({loadProfileContent_root:{height:"100%",display:"flex",flexDirection:"column"},loadProfileContent_tabPanel:{flex:1,padding:e.spacing(3)}})})),En=function(e){var t=e.powerTransformerLoss,a=e.index,n=e.value,i=Object(r.useState)(Xa.DATA),l=Object(b.a)(i,2),c=l[0],s=l[1],d=vn();return a===n?o.a.createElement("div",{className:d.loadProfileContent_root},o.a.createElement("div",null,o.a.createElement(Yt.a,{onChange:function(e,t){s(t)},indicatorColor:"primary",value:c},o.a.createElement(ta,{label:"Data",value:Xa.DATA}),o.a.createElement(ta,{label:"Graph",value:Xa.GRAPH}))),o.a.createElement(gn,{index:Xa.DATA,value:c},o.a.createElement(bn,{powerTransformerLoss:t}))):o.a.createElement(o.a.Fragment,null)},yn=Object(d.a)((function(e){return{feederAndDemandContent_root:{height:"100%",display:"flex",flexDirection:"column",minHeight:"0px",minWidth:"0px"},feederAndDemand_header:{display:"flex",alignItems:"flex-end"},feederAndDemand_title:{marginRight:e.spacing(1),paddingRight:e.spacing(3),textAlign:"center"},feederAndDemand_contentContainer:{flex:1,overflow:"auto",display:"flex",flexWrap:"nowrap"},feederAndDemandContent:{flex:1}}})),wn=function(e){Object.assign({},e);var t=yn(),a=Object(r.useState)(""),n=Object(b.a)(a,2),i=n[0],l=n[1],c=Object(r.useContext)(Ut);return o.a.createElement("div",{className:t.feederAndDemandContent_root},o.a.createElement("div",{className:t.feederAndDemand_header},o.a.createElement(de.a,{className:t.feederAndDemand_title,variant:"h5"},"Power Transformer Loss"),o.a.createElement(Yt.a,{onChange:function(e,t){l(t)},indicatorColor:"primary",value:i},Object(h.a)(c.monthlyPowerTransformerLoss.powerTransformerLosses.values()).map((function(e){return o.a.createElement(ta,{label:e.billingPeriod.toString(),value:e.billingPeriod.toString(),key:"T: ".concat(e.billingPeriod.toString())})})))),o.a.createElement("div",{className:t.feederAndDemand_contentContainer},o.a.createElement("div",{className:t.feederAndDemandContent},Object(h.a)(c.monthlyPowerTransformerLoss.powerTransformerLosses.values()).map((function(e){return o.a.createElement(En,{key:"FDC:BP:".concat(e.billingPeriod.toString()),powerTransformerLoss:e,value:i,index:e.billingPeriod.toString()})})))))};!function(e){e.LOAD_PROFILE="lp",e.SUBSTATION_LOSS="ssl",e.FEEDERDEMAND_OUTAGED="fdo",e.POWER_BILL="pbl",e.POWER_TRANSFORMER_LOSS="pts"}(pn||(pn={}));var xn=function(e){var t=e.value,a=e.index,n=(Object(g.a)(e,["value","index"]),On());return t===a?o.a.createElement("div",{className:n.mainContent_content},e.children):o.a.createElement(o.a.Fragment,null)},On=Object(d.a)((function(e){return{maincontent_root:{height:"100%",display:"flex"},tabs_container:{marginTop:e.spacing(12),maxWidth:"300px",flexGrow:0},tabs:{display:"inline-block"},mainContent_content:{flex:1,width:0}}})),An=function(e){Object.assign({},e);var t=On(),a=Object(r.useState)(pn.LOAD_PROFILE),n=Object(b.a)(a,2),i=n[0],l=n[1];return o.a.createElement("div",{className:t.maincontent_root},o.a.createElement("div",{className:t.tabs_container},o.a.createElement(Yt.a,{className:t.tabs,orientation:"vertical",value:i,centered:!1,indicatorColor:"primary",onChange:function(e,t){l(t)}},o.a.createElement(la,{label:"Load Profile",value:pn.LOAD_PROFILE}),o.a.createElement(la,{label:"Power Bill",value:pn.POWER_BILL}),o.a.createElement(la,{label:"Feeder Demand and Outages",value:pn.FEEDERDEMAND_OUTAGED}),o.a.createElement(la,{label:"Substation Loss",value:pn.SUBSTATION_LOSS}),o.a.createElement(la,{label:"Power Transformer Loss",value:pn.POWER_TRANSFORMER_LOSS}))),o.a.createElement(xn,{value:i,index:pn.LOAD_PROFILE},o.a.createElement(Va,null)),o.a.createElement(xn,{value:i,index:pn.FEEDERDEMAND_OUTAGED},o.a.createElement(tn,null)),o.a.createElement(xn,{value:i,index:pn.POWER_TRANSFORMER_LOSS},o.a.createElement(wn,null)))},Pn=Object(d.a)((function(e){return{dashboard_root:{display:"flex",height:"100%"},dashboard_content:{flex:1,position:"relative",minHeight:"0px",width:0}}})),Sn=function(e){var t=Pn(),a=re(),n=Object(r.useState)(!0),i=Object(b.a)(n,2),l=i[0],c=i[1],s=Object(r.useState)(!1),d=Object(b.a)(s,2),u=d[0],m=d[1];return o.a.createElement("div",{className:t.dashboard_root},o.a.createElement(ee,{onSettingsToggled:function(){m(!0)},onSettingsUntoggled:function(){m(!1)},onFilesToggled:function(){c(!0)},onFilesUntoggled:function(){c(!1)}}),o.a.createElement(Bt,{open:l}),o.a.createElement("div",{className:Object(We.a)(t.dashboard_content,a.content,Object(V.a)({},a.contentShift,l))},u&&o.a.createElement(ma,null),o.a.createElement(An,null)))},Cn=Object(d.a)((function(e){return{root:{height:"100vh",backgroundColor:e.palette.background.default}}})),In=function(e){var t=Cn();return o.a.createElement(c.a,{theme:m},o.a.createElement(s.a,null,o.a.createElement(U,null,o.a.createElement(mt,null,o.a.createElement(Vt,null,o.a.createElement("div",{className:Object(We.a)(t.root)},o.a.createElement(Sn,null)))))))};l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(o.a.Fragment,null,o.a.createElement(In,null))),document.getElementById("root"))}},[[130,1,2]]]);
//# sourceMappingURL=main.2cb56dbb.chunk.js.map